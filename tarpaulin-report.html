<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <style>html, body {
  margin: 0;
  padding: 0;
}

.app {
  margin: 10px;
  padding: 0;
}

.files-list {
  margin: 10px 0 0;
  width: 100%;
  border-collapse: collapse;
}
.files-list__head {
  border: 1px solid #999;
}
.files-list__head > tr > th {
  padding: 10px;
  border: 1px solid #999;
  text-align: left;
  font-weight: normal;
  background: #ddd;
}
.files-list__body {
}
.files-list__file {
  cursor: pointer;
}
.files-list__file:hover {
  background: #ccf;
}
.files-list__file > td {
  padding: 10px;
  border: 1px solid #999;
}
.files-list__file > td:first-child::before {
  content: '\01F4C4';
  margin-right: 1em;
}
.files-list__file_low {
  background: #fcc;
}
.files-list__file_medium {
  background: #ffc;
}
.files-list__file_high {
  background: #cfc;
}
.files-list__file_folder > td:first-child::before {
  content: '\01F4C1';
  margin-right: 1em;
}

.file-header {
  border: 1px solid #999;
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: sticky;
  top: 0;
  background: white;
}

.file-header__back {
  margin: 10px;
  cursor: pointer;
  flex-shrink: 0;
  flex-grow: 0;
  text-decoration: underline;
  color: #338;
}

.file-header__name {
  margin: 10px;
  flex-shrink: 2;
  flex-grow: 2;
}

.file-header__stat {
  margin: 10px;
  flex-shrink: 0;
  flex-grow: 0;
}

.file-content {
  margin: 10px 0 0;
  border: 1px solid #999;
  padding: 10px;
  counter-reset: line;
  display: flex;
  flex-direction: column;
}

.code-line::before {
    content: counter(line);
    margin-right: 10px;
}
.code-line {
  margin: 0;
  padding: 0.3em;
  height: 1em;
  counter-increment: line;
}
.code-line_covered {
  background: #cfc;
}
.code-line_uncovered {
  background: #fcc;
}
</style>
</head>
<body>
    <div id="root"></div>
    <script>
        var data = {"files":[{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","auth","controller","auth.rs"],"content":"use rocket::{get, post, State};\r\nuse rocket::form::{Form, FromForm};\r\nuse rocket::http::{Status, Cookie, CookieJar};\r\nuse sqlx::{Any, Pool};\r\nuse uuid::Uuid;\r\n\r\nuse crate::auth::model::user::User;\r\nuse crate::auth::service::auth::AuthService;\r\n\r\n#[derive(FromForm)]\r\npub struct AuthForm {\r\n    pub username: String,\r\n    pub password: String,\r\n}\r\n\r\n#[post(\"/login\", data = \"\u003cform\u003e\")]\r\npub async fn login(form: Form\u003cAuthForm\u003e, cookies: \u0026CookieJar\u003c'_\u003e, db: \u0026State\u003cPool\u003cAny\u003e\u003e) -\u003e Status {\r\n    let username = form.username.clone();\r\n    let password = form.password.clone();\r\n\r\n    let result = AuthService::login_user(db.inner().clone(), username, password).await;\r\n    match result {\r\n        Ok(session) =\u003e {\r\n            cookies.add_private(Cookie::new(\"session_key\", session.session_key));\r\n            Status::Ok\r\n        },\r\n        Err(_) =\u003e Status::Unauthorized,\r\n    }\r\n}\r\n\r\n#[post(\"/register\", data = \"\u003cform\u003e\")]\r\npub async fn register(form: Form\u003cAuthForm\u003e, db: \u0026State\u003cPool\u003cAny\u003e\u003e) -\u003e Status {\r\n    let username = form.username.clone();\r\n    let password = form.password.clone();\r\n    let is_admin = false; // Default to false for regular users\r\n\r\n    let user = User::new(username, password, is_admin);\r\n    let result = AuthService::register_user(db.inner().clone(), user).await;\r\n    match result {\r\n        Ok(_) =\u003e Status::Ok,\r\n        Err(_) =\u003e Status::BadRequest\r\n    }\r\n}\r\n\r\n#[get(\"/logout\")]\r\npub async fn logout(db: \u0026State\u003cPool\u003cAny\u003e\u003e, cookies: \u0026CookieJar\u003c'_\u003e) -\u003e Status {\r\n    let session_key = cookies.get_private(\"session_key\").map(|c| c.value().to_string()).unwrap_or_default();\r\n    if session_key.is_empty() {\r\n        return Status::BadRequest;\r\n    }\r\n    AuthService::logout_user(db.inner().clone(), Uuid::try_parse(\u0026session_key).unwrap()).await.unwrap();\r\n    cookies.remove_private(Cookie::build(\"session_key\"));\r\n    Status::Ok\r\n}\r\n\r\n#[cfg(test)]\r\nmod test {\r\n    use super::*;\r\n    use rocket::local::asynchronous::Client;\r\n    use rocket::http::Status;\r\n    use rocket::{routes, uri, Rocket, async_test};\r\n    use sqlx::any::install_default_drivers;\r\n\r\n    async fn setup() -\u003e Rocket\u003crocket::Build\u003e {\r\n        install_default_drivers();\r\n        let db = sqlx::any::AnyPoolOptions::new()\r\n            .max_connections(1)\r\n            .connect(\"sqlite::memory:\")\r\n            .await\r\n            .unwrap();\r\n\r\n        sqlx::migrate!(\"migrations/test\")\r\n            .run(\u0026db)\r\n            .await\r\n            .unwrap();\r\n\r\n        let rocket = rocket::build()\r\n            .manage(reqwest::Client::builder().build().unwrap())\r\n            .manage(db.clone())\r\n            .mount(\"/\", routes![login, register, logout]);\r\n\r\n        rocket\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_register() {\r\n        let rocket = setup().await;\r\n        let client = Client::tracked(rocket).await.expect(\"Must provice a valid Rocket instance\");\r\n        let response = client.post(uri!(super::register))\r\n            .header(rocket::http::ContentType::Form)\r\n            .body(\"username=testuser\u0026password=testpass\")\r\n            .dispatch()\r\n            .await;\r\n        assert_eq!(response.status(), Status::Ok);\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_register_existing_user() {\r\n        let rocket = setup().await;\r\n        let client = Client::tracked(rocket).await.expect(\"Must provice a valid Rocket instance\");\r\n        client.post(uri!(super::register))\r\n            .header(rocket::http::ContentType::Form)\r\n            .body(\"username=testuser\u0026password=testpass\")\r\n            .dispatch()\r\n            .await;\r\n        let response = client.post(uri!(super::register))\r\n            .header(rocket::http::ContentType::Form)\r\n            .body(\"username=testuser\u0026password=testpass\")\r\n            .dispatch()\r\n            .await;\r\n        assert_eq!(response.status(), Status::BadRequest);\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_login_valid_credentials() {\r\n        let rocket = setup().await;\r\n        let client = Client::tracked(rocket).await.expect(\"Must provice a valid Rocket instance\");\r\n        client.post(uri!(super::register))\r\n            .header(rocket::http::ContentType::Form)\r\n            .body(\"username=testuser\u0026password=testpass\")\r\n            .dispatch()\r\n            .await;\r\n        let response = client.post(uri!(super::login))\r\n            .header(rocket::http::ContentType::Form)\r\n            .body(\"username=testuser\u0026password=testpass\")\r\n            .dispatch()\r\n            .await;\r\n        assert_eq!(response.status(), Status::Ok);\r\n        let cookies = response.cookies();\r\n        assert!(cookies.get(\"session_key\").is_some(), \"Session cookie should be set\");\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_login_invalid_credentials() {\r\n        let rocket = setup().await;\r\n        let client = Client::tracked(rocket).await.expect(\"Must provice a valid Rocket instance\");\r\n        client.post(uri!(super::register))\r\n            .header(rocket::http::ContentType::Form)\r\n            .body(\"username=testuser\u0026password=testpass\")\r\n            .dispatch()\r\n            .await;\r\n        let response = client.post(uri!(super::login))\r\n            .header(rocket::http::ContentType::Form)\r\n            .body(\"username=invaliduser\u0026password=invalidpass\")\r\n            .dispatch()\r\n            .await;\r\n        assert_eq!(response.status(), Status::Unauthorized);\r\n        let cookies = response.cookies();\r\n        assert!(cookies.get(\"session_key\").is_none(), \"Session cookie should not be set\");\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_logout() {\r\n        let rocket = setup().await;\r\n        let client = Client::tracked(rocket).await.expect(\"Must provice a valid Rocket instance\");\r\n        client.post(uri!(super::register))\r\n            .header(rocket::http::ContentType::Form)\r\n            .body(\"username=testuser\u0026password=testpass\")\r\n            .dispatch()\r\n            .await;\r\n        client.post(uri!(super::login))\r\n            .header(rocket::http::ContentType::Form)\r\n            .body(\"username=testuser\u0026password=testpass\")\r\n            .dispatch()\r\n            .await;\r\n        let response = client.get(uri!(super::logout))\r\n            .dispatch()\r\n            .await;\r\n        assert_eq!(response.status(), Status::Ok);\r\n        let cookies = response.cookies();\r\n        let session_key = cookies.get(\"session_key\").map(|c| c.value()).unwrap_or_default();\r\n        assert!(session_key.is_empty(), \"Session cookie should be cleared\");\r\n    }\r\n}","traces":[{"line":17,"address":[],"length":0,"stats":{"Line":864691128455135232}},{"line":18,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":19,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":21,"address":[],"length":0,"stats":{"Line":864691128455135232}},{"line":22,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":23,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":24,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":25,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":27,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":32,"address":[],"length":0,"stats":{"Line":1729382256910270464}},{"line":33,"address":[],"length":0,"stats":{"Line":864691128455135232}},{"line":34,"address":[],"length":0,"stats":{"Line":864691128455135232}},{"line":35,"address":[],"length":0,"stats":{"Line":864691128455135232}},{"line":37,"address":[],"length":0,"stats":{"Line":864691128455135232}},{"line":38,"address":[],"length":0,"stats":{"Line":1729382256910270464}},{"line":39,"address":[],"length":0,"stats":{"Line":864691128455135232}},{"line":40,"address":[],"length":0,"stats":{"Line":720575940379279360}},{"line":41,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":46,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":47,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":48,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":49,"address":[],"length":0,"stats":{"Line":0}},{"line":51,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":52,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":53,"address":[],"length":0,"stats":{"Line":144115188075855872}}],"covered":24,"coverable":25},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","auth","controller","mod.rs"],"content":"use rocket::{fairing::AdHoc, routes};\r\n\r\npub mod auth;\r\n\r\npub fn route_stage() -\u003e AdHoc {\r\n    return AdHoc::on_ignite(\"Initializing /api/auth controller routes...\", |rocket| async {\r\n        rocket\r\n            .mount(\"/api/auth\", routes![auth::login, auth::register, auth::logout])\r\n    });\r\n}\r\n","traces":[{"line":5,"address":[],"length":0,"stats":{"Line":0}},{"line":6,"address":[],"length":0,"stats":{"Line":0}},{"line":7,"address":[],"length":0,"stats":{"Line":0}},{"line":8,"address":[],"length":0,"stats":{"Line":0}}],"covered":0,"coverable":4},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","auth","guards","auth.rs"],"content":"use rocket::http::Status;\r\nuse rocket::request::{FromRequest, Outcome, Request};\r\nuse rocket::State;\r\nuse sqlx::{Any, Pool};\r\nuse uuid::Uuid;\r\n\r\nuse crate::auth::repository::session::SessionRepository;\r\nuse crate::auth::repository::user::UserRepository;\r\n\r\npub struct AuthenticatedUser {\r\n    pub user_id: i64,\r\n    pub username: String,\r\n    pub is_admin: bool,\r\n}\r\n\r\n#[rocket::async_trait]\r\nimpl\u003c'r\u003e FromRequest\u003c'r\u003e for AuthenticatedUser {\r\n    type Error = ();\r\n\r\n    async fn from_request(request: \u0026'r Request\u003c'_\u003e) -\u003e Outcome\u003cSelf, Self::Error\u003e {\r\n        let cookies = request.cookies();\r\n        let db = request.guard::\u003c\u0026State\u003cPool\u003cAny\u003e\u003e\u003e().await.unwrap();\r\n        let session_key = cookies.get_private(\"session_key\").map(|c| c.value().to_string());\r\n        if session_key.is_none() {\r\n            return Outcome::Error((Status::Unauthorized, ()));\r\n        }\r\n        let session_key = session_key.unwrap();\r\n        let session = SessionRepository::get_session_by_key(db.acquire().await.unwrap(), Uuid::try_parse(\u0026session_key).unwrap()).await;\r\n        match session {\r\n            Ok(session) =\u003e \r\n            {\r\n                if !session.is_valid() {\r\n                    return Outcome::Error((Status::Unauthorized, ()));\r\n                }\r\n                let user = UserRepository::get_user_by_id(db.acquire().await.unwrap(), session.user_id).await.unwrap();\r\n                return Outcome::Success(AuthenticatedUser {\r\n                    user_id: user.id,\r\n                    username: user.username,\r\n                    is_admin: user.is_admin,\r\n                });\r\n            },\r\n            Err(_) =\u003e return Outcome::Error((Status::Unauthorized, ())),\r\n        };\r\n    }\r\n}","traces":[{"line":20,"address":[],"length":0,"stats":{"Line":0}},{"line":21,"address":[],"length":0,"stats":{"Line":0}},{"line":22,"address":[],"length":0,"stats":{"Line":0}},{"line":23,"address":[],"length":0,"stats":{"Line":0}},{"line":24,"address":[],"length":0,"stats":{"Line":0}},{"line":25,"address":[],"length":0,"stats":{"Line":0}},{"line":27,"address":[],"length":0,"stats":{"Line":0}},{"line":28,"address":[],"length":0,"stats":{"Line":0}},{"line":29,"address":[],"length":0,"stats":{"Line":0}},{"line":30,"address":[],"length":0,"stats":{"Line":0}},{"line":32,"address":[],"length":0,"stats":{"Line":0}},{"line":33,"address":[],"length":0,"stats":{"Line":0}},{"line":35,"address":[],"length":0,"stats":{"Line":0}},{"line":36,"address":[],"length":0,"stats":{"Line":0}},{"line":37,"address":[],"length":0,"stats":{"Line":0}},{"line":38,"address":[],"length":0,"stats":{"Line":0}},{"line":39,"address":[],"length":0,"stats":{"Line":0}},{"line":42,"address":[],"length":0,"stats":{"Line":0}}],"covered":0,"coverable":18},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","auth","guards","mod.rs"],"content":"pub mod auth;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","auth","mod.rs"],"content":"pub mod model;\r\npub mod repository;\r\npub mod service;\r\npub mod controller;\r\npub mod guards;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","auth","model","mod.rs"],"content":"pub mod user;\r\npub mod session;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","auth","model","session.rs"],"content":"use rocket::serde::{Deserialize, Serialize};\r\nuse uuid::Uuid;\r\nuse chrono::{DateTime, Utc};\r\nuse crate::auth::model::user::User;\r\n\r\n#[derive(Debug, Clone, Serialize, Deserialize)]\r\n#[serde(crate = \"rocket::serde\")]\r\npub struct Session {\r\n    pub session_key: String,\r\n    pub user_id: i64,\r\n    pub expires_at: DateTime\u003cUtc\u003e,\r\n}\r\n\r\nimpl Session {\r\n    pub fn new(user: User) -\u003e Self {\r\n        Session {\r\n            session_key: Uuid::new_v4().to_string(),\r\n            user_id: user.id,\r\n            expires_at: Utc::now() + chrono::Duration::hours(24),\r\n        }\r\n    }\r\n\r\n    pub fn is_valid(\u0026self) -\u003e bool {\r\n        Utc::now() \u003c self.expires_at\r\n    }\r\n\r\n    pub fn generate_session_key() -\u003e String {\r\n        Uuid::new_v4().to_string()\r\n    }\r\n}\r\n\r\n#[cfg(test)]\r\nmod test {\r\n    use super::*;\r\n\r\n    #[test]\r\n    fn test_create_session() {\r\n        let user = User::new(\"test_user\".to_string(), \"password\".to_string(), false);\r\n        let session = Session::new(user.clone());\r\n        assert_eq!(session.user_id, 0);\r\n        assert_eq!(session.session_key.len(), 36);\r\n    }\r\n\r\n    #[test]\r\n    fn test_session_is_valid() {\r\n        let user = User::new(\"test_user\".to_string(), \"password\".to_string(), false);\r\n        let session = Session::new(user.clone());\r\n        assert!(session.is_valid());\r\n    }\r\n\r\n    #[test]\r\n    fn test_session_is_not_valid() {\r\n        let user = User::new(\"test_user\".to_string(), \"password\".to_string(), false);\r\n        let mut session = Session::new(user.clone());\r\n        session.expires_at = Utc::now() - chrono::Duration::hours(1);\r\n        assert!(!session.is_valid());\r\n    }\r\n\r\n    #[test]\r\n    fn test_generate_session_key() {\r\n        let session_key = Session::generate_session_key();\r\n        assert_eq!(session_key.len(), 36);\r\n    }\r\n}","traces":[{"line":15,"address":[],"length":0,"stats":{"Line":1441151880758558720}},{"line":17,"address":[],"length":0,"stats":{"Line":1441151880758558720}},{"line":18,"address":[],"length":0,"stats":{"Line":1441151880758558720}},{"line":19,"address":[],"length":0,"stats":{"Line":1441151880758558720}},{"line":23,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":24,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":27,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":28,"address":[],"length":0,"stats":{"Line":144115188075855872}}],"covered":8,"coverable":8},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","auth","model","user.rs"],"content":"use rocket::serde::{Deserialize, Serialize};\r\n\r\n#[derive(Debug, Clone, Serialize, Deserialize)]\r\n#[serde(crate = \"rocket::serde\")]\r\npub struct User {\r\n    pub id: i64,\r\n    pub username: String,\r\n    pub password: String,\r\n    pub is_admin: bool,\r\n}\r\n\r\nimpl User {\r\n    pub fn new(username: String, password: String, is_admin: bool) -\u003e Self {\r\n        User {\r\n            id: 0,\r\n            username,\r\n            password: bcrypt::hash(password, bcrypt::DEFAULT_COST).expect(\"Failed to hash password\"),\r\n            is_admin,\r\n        }\r\n    }\r\n\r\n    pub fn verify_password(\u0026self, password: \u0026str) -\u003e bool {\r\n        bcrypt::verify(password, \u0026self.password).unwrap_or(false)\r\n    }\r\n}\r\n\r\n#[cfg(test)]\r\nmod test {\r\n    use super::*;\r\n\r\n    #[test]\r\n    fn test_create_default_user() {\r\n        let user = User::new(\"test_user\".to_string(), \"password\".to_string(), false);\r\n        assert_eq!(user.username, \"test_user\");\r\n        assert_eq!(user.is_admin, false);\r\n    }\r\n\r\n    #[test]\r\n    fn test_create_admin_user() {\r\n        let user = User::new(\"test_user\".to_string(), \"password\".to_string(), true);\r\n        assert_eq!(user.username, \"test_user\");\r\n        assert_eq!(user.is_admin, true);\r\n    }\r\n\r\n    #[test]\r\n    fn test_verify_correct_password() {\r\n        let user = User::new(\"test_user\".to_string(), \"password\".to_string(), false);\r\n        assert!(user.verify_password(\"password\"));\r\n    }\r\n\r\n    #[test]\r\n    fn test_verify_wrong_password() {\r\n        let user = User::new(\"test_user\".to_string(), \"password\".to_string(), false);\r\n        assert!(!user.verify_password(\"wrong_password\"));\r\n    }\r\n}","traces":[{"line":13,"address":[],"length":0,"stats":{"Line":3458764513820540928}},{"line":17,"address":[],"length":0,"stats":{"Line":3458764513820540928}},{"line":22,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":23,"address":[],"length":0,"stats":{"Line":1008806316530991104}}],"covered":4,"coverable":4},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","auth","repository","mod.rs"],"content":"pub mod user;\r\npub mod session;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","auth","repository","session.rs"],"content":"use rocket_db_pools::sqlx;\r\nuse sqlx::{Any, Row};\r\nuse sqlx::pool::PoolConnection;\r\nuse uuid::Uuid;\r\nuse chrono::DateTime;\r\nuse crate::auth::model::session::Session;\r\n\r\npub struct SessionRepository;\r\n\r\nimpl SessionRepository {\r\n    pub async fn create_session(mut db: PoolConnection\u003cAny\u003e, session: Session) -\u003e Result\u003cSession, sqlx::Error\u003e {\r\n        sqlx::query(\"INSERT INTO sessions (session_key, user_id, expires_at) VALUES ($1, $2, $3)\")\r\n            .bind(\u0026session.session_key)\r\n            .bind(\u0026session.user_id)\r\n            .bind(\u0026session.expires_at.to_rfc3339())\r\n            .execute(\u0026mut *db)\r\n            .await?;\r\n\r\n        Ok(session)\r\n    }\r\n\r\n    pub async fn get_session_by_key(mut db: PoolConnection\u003cAny\u003e, session_key: Uuid) -\u003e Result\u003cSession, sqlx::Error\u003e {\r\n        let row = sqlx::query(\"SELECT * FROM sessions WHERE session_key = $1\")\r\n            .bind(session_key.to_string())\r\n            .fetch_one(\u0026mut *db)\r\n            .await?;\r\n\r\n        let session_key: String = row.get(\"session_key\");\r\n        let user_id: i64 = row.get(\"user_id\");\r\n        let expires_at: String = row.get(\"expires_at\");\r\n\r\n        Ok(Session {\r\n            session_key,\r\n            user_id,\r\n            expires_at: DateTime::parse_from_rfc3339(\u0026expires_at)\r\n                .expect(\"Failed to parse expires_at\")\r\n                .with_timezone(\u0026chrono::Utc),\r\n        })\r\n    }\r\n\r\n    pub async fn delete_session(mut db: PoolConnection\u003cAny\u003e, session_key: Uuid) -\u003e Result\u003c(), sqlx::Error\u003e {\r\n        sqlx::query(\"DELETE FROM sessions WHERE session_key = $1\")\r\n            .bind(session_key.to_string())\r\n            .execute(\u0026mut *db)\r\n            .await?;\r\n\r\n        Ok(())\r\n    }\r\n}\r\n\r\n#[cfg(test)]\r\nmod test {\r\n    use super::*;\r\n    use rocket::async_test;\r\n    use sqlx::any::install_default_drivers;\r\n    use sqlx::Pool;\r\n    use crate::auth::model::user::User;\r\n    use crate::auth::repository::user::UserRepository;\r\n\r\n    async fn setup() -\u003e Pool\u003cAny\u003e {\r\n        install_default_drivers();\r\n        let db = sqlx::any::AnyPoolOptions::new()\r\n            .max_connections(1)\r\n            .connect(\"sqlite::memory:\")\r\n            .await\r\n            .unwrap();\r\n\r\n        sqlx::migrate!(\"migrations/test\")\r\n            .run(\u0026db)\r\n            .await\r\n            .unwrap();\r\n\r\n        db\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_create_session() {\r\n        let db = setup().await;\r\n        let user = User::new(\"test_user\".to_string(), \"password\".to_string(), false);\r\n\r\n        let session = Session::new(user.clone());\r\n        let result = SessionRepository::create_session(db.acquire().await.unwrap(), session.clone()).await;\r\n        assert!(result.is_ok());\r\n        let fetched_session = result.unwrap();\r\n        assert_eq!(fetched_session.session_key, session.session_key);\r\n        assert_eq!(fetched_session.user_id, session.user_id);\r\n        assert_eq!(fetched_session.expires_at, session.expires_at);\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_get_session_by_key() {\r\n        let db = setup().await;\r\n        let user = User::new(\"test_user\".to_string(), \"password\".to_string(), false);\r\n\r\n        let session = Session::new(user.clone());\r\n        SessionRepository::create_session(db.acquire().await.unwrap(), session.clone()).await.unwrap();\r\n        let retrieved_session = SessionRepository::get_session_by_key(db.acquire().await.unwrap(), Uuid::parse_str(\u0026session.session_key).unwrap()).await;\r\n        assert!(retrieved_session.is_ok());\r\n        let fetched_session = retrieved_session.unwrap();\r\n        assert_eq!(fetched_session.session_key, session.session_key);\r\n        assert_eq!(fetched_session.user_id, session.user_id);\r\n        assert_eq!(fetched_session.expires_at, session.expires_at);\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_get_session_by_nonexistent_key() {\r\n        let db = setup().await;\r\n        let result = UserRepository::get_user_by_username(db.acquire().await.unwrap(), \"nonexistent_user\").await;\r\n        assert!(result.is_err());\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_delete_session() {\r\n        let db = setup().await;\r\n        let user = User::new(\"test_user\".to_string(), \"password\".to_string(), false);\r\n\r\n        let session = Session::new(user.clone());\r\n        SessionRepository::create_session(db.acquire().await.unwrap(), session.clone()).await.unwrap();\r\n        let result = SessionRepository::delete_session(db.acquire().await.unwrap(), Uuid::parse_str(\u0026session.session_key).unwrap()).await;\r\n        assert!(result.is_ok());\r\n        let retrieved_session = SessionRepository::get_session_by_key(db.acquire().await.unwrap(), Uuid::parse_str(\u0026session.session_key).unwrap()).await;\r\n        assert!(retrieved_session.is_err());\r\n    }\r\n}","traces":[{"line":11,"address":[],"length":0,"stats":{"Line":2017612633061982208}},{"line":12,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":13,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":14,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":15,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":16,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":17,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":19,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":22,"address":[],"length":0,"stats":{"Line":576460752303423488}},{"line":23,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":24,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":25,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":26,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":28,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":29,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":30,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":32,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":33,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":34,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":35,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":36,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":37,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":41,"address":[],"length":0,"stats":{"Line":864691128455135232}},{"line":42,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":43,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":44,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":45,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":47,"address":[],"length":0,"stats":{"Line":432345564227567616}}],"covered":28,"coverable":28},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","auth","repository","user.rs"],"content":"use rocket_db_pools::sqlx;\r\nuse sqlx::{Any, Row};\r\nuse sqlx::pool::PoolConnection;\r\nuse crate::auth::model::user::User;\r\n\r\npub struct UserRepository;\r\n\r\nimpl UserRepository {\r\n    pub async fn create_user(mut db: PoolConnection\u003cAny\u003e, user: User) -\u003e Result\u003cUser, sqlx::Error\u003e {\r\n        let row = sqlx::query(\"INSERT INTO users (username, password, is_admin) VALUES ($1, $2, $3) RETURNING id\")\r\n            .bind(\u0026user.username)\r\n            .bind(\u0026user.password)\r\n            .bind(user.is_admin as i32)\r\n            .fetch_one(\u0026mut *db)\r\n            .await?;\r\n\r\n        let id: i64 = row.get(\"id\");\r\n        Ok(User {\r\n            id,\r\n            username: user.username,\r\n            password: user.password,\r\n            is_admin: user.is_admin,\r\n        })\r\n    }\r\n\r\n    pub async fn get_user_by_username(mut db: PoolConnection\u003cAny\u003e, username: \u0026str) -\u003e Result\u003cUser, sqlx::Error\u003e {\r\n        let row = sqlx::query(\"SELECT * FROM users WHERE username = $1\")\r\n            .bind(username)\r\n            .fetch_one(\u0026mut *db)\r\n            .await?;\r\n\r\n        let id: i64 = row.get(\"id\");\r\n        let password: String = row.get(\"password\");\r\n        let is_admin: bool = match row.try_get(\"is_admin\") {\r\n            Ok(value) =\u003e value,\r\n            Err(_) =\u003e {\r\n                let is_admin_int: i32 = row.get(\"is_admin\");\r\n                is_admin_int != 0\r\n            }\r\n        };\r\n\r\n        Ok(User {\r\n            id,\r\n            username: username.to_string(),\r\n            password,\r\n            is_admin,\r\n        })\r\n    }\r\n\r\n    pub async fn get_user_by_id(mut db: PoolConnection\u003cAny\u003e, user_id: i64) -\u003e Result\u003cUser, sqlx::Error\u003e {\r\n        let row = sqlx::query(\"SELECT * FROM users WHERE id = $1\")\r\n            .bind(user_id)\r\n            .fetch_one(\u0026mut *db)\r\n            .await?;\r\n\r\n        let username: String = row.get(\"username\");\r\n        let password: String = row.get(\"password\");\r\n        let is_admin: bool = match row.try_get(\"is_admin\") {\r\n            Ok(value) =\u003e value,\r\n            Err(_) =\u003e {\r\n                let is_admin_int: i32 = row.get(\"is_admin\");\r\n                is_admin_int != 0\r\n            }\r\n        };\r\n\r\n        Ok(User {\r\n            id: user_id,\r\n            username,\r\n            password,\r\n            is_admin,\r\n        })\r\n    }\r\n}\r\n\r\n#[cfg(test)]\r\nmod test {\r\n    use super::*;\r\n    use rocket::async_test;\r\n    use sqlx::any::install_default_drivers;\r\n    use sqlx::Pool;\r\n\r\n    async fn setup() -\u003e Pool\u003cAny\u003e {\r\n        install_default_drivers();\r\n        let db = sqlx::any::AnyPoolOptions::new()\r\n            .max_connections(1)\r\n            .connect(\"sqlite::memory:\")\r\n            .await\r\n            .unwrap();\r\n\r\n        sqlx::migrate!(\"migrations/test\")\r\n            .run(\u0026db)\r\n            .await\r\n            .unwrap();\r\n\r\n        db\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_create_user() {\r\n        let db = setup().await;\r\n        let user = User::new(\"test_user\".to_string(), \"password\".to_string(), false);\r\n\r\n        let result = UserRepository::create_user(db.acquire().await.unwrap(), user.clone()).await;\r\n        assert!(result.is_ok());\r\n        let created_user = result.unwrap();\r\n        assert_eq!(created_user.username, user.username);\r\n        assert_eq!(created_user.is_admin, user.is_admin);\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_get_user_by_username() {\r\n        let db = setup().await;\r\n        let user = User::new(\"test_user\".to_string(), \"password\".to_string(), false);\r\n\r\n        UserRepository::create_user(db.acquire().await.unwrap(), user.clone()).await.unwrap();\r\n        let result = UserRepository::get_user_by_username(db.acquire().await.unwrap(), \u0026user.username).await;\r\n        assert!(result.is_ok());\r\n        let fetched_user = result.unwrap();\r\n        assert_eq!(fetched_user.username, user.username);\r\n        assert_eq!(fetched_user.is_admin, user.is_admin);\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_get_user_by_nonexistent_username() {\r\n        let db = setup().await;\r\n        let result = UserRepository::get_user_by_username(db.acquire().await.unwrap(), \"nonexistent_user\").await;\r\n        assert!(result.is_err());\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_get_user_by_id() {\r\n        let db = setup().await;\r\n        let user = User::new(\"test_user\".to_string(), \"password\".to_string(), false);\r\n\r\n        let created_user = UserRepository::create_user(db.acquire().await.unwrap(), user.clone()).await.unwrap();\r\n        let result = UserRepository::get_user_by_id(db.acquire().await.unwrap(), created_user.id).await;\r\n        assert!(result.is_ok());\r\n        let fetched_user = result.unwrap();\r\n        assert_eq!(fetched_user.username, user.username);\r\n        assert_eq!(fetched_user.is_admin, user.is_admin);\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_get_user_by_nonexistent_id() {\r\n        let db = setup().await;\r\n        let result = UserRepository::get_user_by_id(db.acquire().await.unwrap(), 999).await;\r\n        assert!(result.is_err());\r\n    }\r\n}","traces":[{"line":9,"address":[],"length":0,"stats":{"Line":3746994889972252672}},{"line":10,"address":[],"length":0,"stats":{"Line":3746994889972252672}},{"line":11,"address":[],"length":0,"stats":{"Line":1873497444986126336}},{"line":12,"address":[],"length":0,"stats":{"Line":1873497444986126336}},{"line":13,"address":[],"length":0,"stats":{"Line":1873497444986126336}},{"line":14,"address":[],"length":0,"stats":{"Line":1873497444986126336}},{"line":15,"address":[],"length":0,"stats":{"Line":1873497444986126336}},{"line":17,"address":[],"length":0,"stats":{"Line":1873497444986126336}},{"line":18,"address":[],"length":0,"stats":{"Line":1873497444986126336}},{"line":19,"address":[],"length":0,"stats":{"Line":1873497444986126336}},{"line":20,"address":[],"length":0,"stats":{"Line":1873497444986126336}},{"line":21,"address":[],"length":0,"stats":{"Line":1873497444986126336}},{"line":22,"address":[],"length":0,"stats":{"Line":1873497444986126336}},{"line":26,"address":[],"length":0,"stats":{"Line":6052837899185946624}},{"line":27,"address":[],"length":0,"stats":{"Line":4035225266123964416}},{"line":28,"address":[],"length":0,"stats":{"Line":3026418949592973312}},{"line":29,"address":[],"length":0,"stats":{"Line":3026418949592973312}},{"line":30,"address":[],"length":0,"stats":{"Line":5044031582654955520}},{"line":32,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":33,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":34,"address":[],"length":0,"stats":{"Line":2017612633061982208}},{"line":35,"address":[],"length":0,"stats":{"Line":0}},{"line":37,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":38,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":42,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":43,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":44,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":45,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":46,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":50,"address":[],"length":0,"stats":{"Line":576460752303423488}},{"line":51,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":52,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":53,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":54,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":56,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":57,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":58,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":59,"address":[],"length":0,"stats":{"Line":0}},{"line":61,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":62,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":66,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":67,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":68,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":69,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":70,"address":[],"length":0,"stats":{"Line":144115188075855872}}],"covered":43,"coverable":45},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","auth","service","auth.rs"],"content":"use sqlx::{Any, Pool};\r\nuse uuid::Uuid;\r\n\r\nuse crate::auth::model::user::User;\r\nuse crate::auth::model::session::Session;\r\nuse crate::auth::repository::user::UserRepository;\r\nuse crate::auth::repository::session::SessionRepository;\r\n\r\npub struct AuthService;\r\n\r\nimpl AuthService {\r\n    pub async fn register_user(db: Pool\u003cAny\u003e, user: User) -\u003e Result\u003cUser, sqlx::Error\u003e {\r\n        let existing_user = UserRepository::get_user_by_username(db.acquire().await.unwrap(), \u0026user.username).await;\r\n        if existing_user.is_ok() {\r\n            return Err(sqlx::Error::RowNotFound);\r\n        }\r\n        let new_user = UserRepository::create_user(db.acquire().await.unwrap(), user).await?;\r\n        Ok(new_user)\r\n    }\r\n\r\n    pub async fn login_user(db: Pool\u003cAny\u003e, username: String, password: String) -\u003e Result\u003cSession, sqlx::Error\u003e {\r\n        let existing_user = UserRepository::get_user_by_username(db.acquire().await.unwrap(), \u0026username).await;\r\n        if existing_user.is_err() {\r\n            return Err(sqlx::Error::RowNotFound);\r\n        }\r\n        let existing_user = existing_user.unwrap();\r\n        let is_password_valid = existing_user.verify_password(\u0026password);\r\n        if !is_password_valid {\r\n            return Err(sqlx::Error::RowNotFound);\r\n        }\r\n        let session = Session::new(existing_user.clone());\r\n        SessionRepository::create_session(db.acquire().await.unwrap(), session.clone()).await?;\r\n        Ok(session)\r\n    }\r\n\r\n    pub async fn logout_user(db: Pool\u003cAny\u003e, session_key: Uuid) -\u003e Result\u003c(), sqlx::Error\u003e {\r\n        SessionRepository::delete_session(db.acquire().await.unwrap(), session_key).await?;\r\n        Ok(())\r\n    }\r\n}\r\n\r\n#[cfg(test)]\r\nmod test {\r\n    use super::*;\r\n    use rocket::async_test;\r\n    use sqlx::any::install_default_drivers;\r\n    use sqlx::Pool;\r\n    use crate::auth::model::user::User;\r\n\r\n    async fn setup() -\u003e Pool\u003cAny\u003e {\r\n        install_default_drivers();\r\n        let db = sqlx::any::AnyPoolOptions::new()\r\n            .max_connections(1)\r\n            .connect(\"sqlite::memory:\")\r\n            .await\r\n            .unwrap();\r\n\r\n        sqlx::migrate!(\"migrations/test\")\r\n            .run(\u0026db)\r\n            .await\r\n            .unwrap();\r\n\r\n        db\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_register_user() {\r\n        let db = setup().await;\r\n        let user = User::new(\"test_user\".to_string(), \"password\".to_string(), false);\r\n\r\n        let result = AuthService::register_user(db, user.clone()).await;\r\n        assert!(result.is_ok());\r\n\r\n        let registered_user = result.unwrap();\r\n        assert_eq!(registered_user.username, user.username);\r\n        assert_eq!(registered_user.is_admin, user.is_admin);\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_login_valid_user_credentials() {\r\n        let db = setup().await;\r\n        let username = \"test_user\".to_string();\r\n        let password = \"password\".to_string();\r\n        let mut user = User::new(username.clone(), password.clone(), false);\r\n\r\n        user = AuthService::register_user(db.clone(), user.clone()).await.unwrap();\r\n        let result = AuthService::login_user(db.clone(), username.clone(), password.clone()).await;\r\n        assert!(result.is_ok());\r\n\r\n        let session = result.unwrap();\r\n        assert_eq!(session.user_id, user.id);\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_login_invalid_username() {\r\n        let db = setup().await;\r\n        let username = \"test_user\".to_string();\r\n        let password = \"password\".to_string();\r\n        let user = User::new(username.clone(), password.clone(), false);\r\n\r\n        AuthService::register_user(db.clone(), user.clone()).await.unwrap();\r\n\r\n        let result = AuthService::login_user(db.clone(), \"dummy\".to_string(), password.clone()).await;\r\n        assert!(result.is_err());\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_login_invalid_password() {\r\n        let db = setup().await;\r\n        let username = \"test_user\".to_string();\r\n        let password = \"password\".to_string();\r\n        let user = User::new(username.clone(), password.clone(), false);\r\n\r\n        AuthService::register_user(db.clone(), user.clone()).await.unwrap();\r\n\r\n        let result = AuthService::login_user(db.clone(), username.clone(), \"dummypass\".to_string()).await;\r\n        assert!(result.is_err());\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_logout_user() {\r\n        let db = setup().await;\r\n        let username = \"test_user\".to_string();\r\n        let password = \"password\".to_string();\r\n        let user = User::new(username.clone(), password.clone(), false);\r\n\r\n        AuthService::register_user(db.clone(), user.clone()).await.unwrap();\r\n        let session = AuthService::login_user(db.clone(), username.clone(), password.clone()).await.unwrap();\r\n        let result = AuthService::logout_user(db.clone(), Uuid::try_parse(\u0026session.session_key).unwrap()).await;\r\n        assert!(result.is_ok());\r\n    }\r\n}","traces":[{"line":12,"address":[],"length":0,"stats":{"Line":3170534137668829184}},{"line":13,"address":[],"length":0,"stats":{"Line":4755801206503243776}},{"line":14,"address":[],"length":0,"stats":{"Line":1585267068834414592}},{"line":15,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":17,"address":[],"length":0,"stats":{"Line":2882303761517117440}},{"line":18,"address":[],"length":0,"stats":{"Line":1441151880758558720}},{"line":21,"address":[],"length":0,"stats":{"Line":2017612633061982208}},{"line":22,"address":[],"length":0,"stats":{"Line":3026418949592973312}},{"line":23,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":24,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":26,"address":[],"length":0,"stats":{"Line":720575940379279360}},{"line":27,"address":[],"length":0,"stats":{"Line":720575940379279360}},{"line":28,"address":[],"length":0,"stats":{"Line":720575940379279360}},{"line":29,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":31,"address":[],"length":0,"stats":{"Line":576460752303423488}},{"line":32,"address":[],"length":0,"stats":{"Line":1152921504606846976}},{"line":33,"address":[],"length":0,"stats":{"Line":576460752303423488}},{"line":36,"address":[],"length":0,"stats":{"Line":576460752303423488}},{"line":37,"address":[],"length":0,"stats":{"Line":576460752303423488}},{"line":38,"address":[],"length":0,"stats":{"Line":288230376151711744}}],"covered":20,"coverable":20},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","auth","service","mod.rs"],"content":"pub mod auth;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","lib.rs"],"content":"pub mod auth;\r\npub mod manajemen_produk;\r\npub mod transaksi_penjualan;\r\npub mod manajemen_supplier;\r\npub mod manajemen_pelanggan;\r\npub mod manajemen_pembayaran;\r\n\r\nuse rocket_db_pools::Database;\r\n\r\n#[derive(Database)]\r\n#[database(\"buildingstore\")]\r\npub struct BuildingStoreDB(sqlx::PgPool);","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","main.rs"],"content":"#[macro_use] extern crate rocket;\r\nuse rocket_db_pools::Database;\r\nuse rocket_db_pools::sqlx::{self, Row};\r\nuse buildingstore_be::BuildingStoreDB;\r\nuse dotenvy::dotenv;\r\nuse sqlx::any::install_default_drivers;\r\nuse rocket::State;\r\nuse sqlx::{Any, Pool};\r\n\r\npub mod auth;\r\npub mod manajemen_produk;\r\npub mod manajemen_pelanggan;\r\n\r\n#[get(\"/\")]\r\nfn index() -\u003e \u0026'static str {\r\n    \"Hello, world!\"\r\n}\r\n\r\n#[get(\"/db\")]\r\nasync fn test_db(db: \u0026State\u003cPool\u003cAny\u003e\u003e) -\u003e Option\u003cString\u003e {\r\n    let mut db_conn = db.acquire().await.unwrap();\r\n    let row = sqlx::query(\"SELECT * FROM users LIMIT 1\")\r\n        .fetch_one(\u0026mut *db_conn)\r\n        .await\r\n        .unwrap();\r\n\r\n    let id: i64 = row.get(\"id\");\r\n    let email: String = row.get(\"username\");\r\n\r\n    Some(format!(\"Hello, {}! Your ID is {}.\", email, id))\r\n}\r\n\r\n#[launch]\r\nasync fn rocket() -\u003e _ {\r\n    dotenv().ok();\r\n\r\n    install_default_drivers();\r\n    let database_url = dotenvy::var(\"DATABASE_URL\").expect(\"DATABASE_URL must be set\");\r\n    let db_pool = sqlx::AnyPool::connect(\u0026database_url).await.unwrap();\r\n    sqlx::migrate!()\r\n        .run(\u0026db_pool)\r\n        .await\r\n        .expect(\"Failed to run migrations\");\r\n\r\n    rocket::build()\r\n        .manage(reqwest::Client::builder().build().unwrap())\r\n        .manage(db_pool)\r\n        .attach(BuildingStoreDB::init())\r\n        .attach(auth::controller::route_stage())\r\n        .attach(manajemen_pelanggan::controller::route_stage())\r\n        .mount(\"/\", routes![index, test_db])\r\n}","traces":[{"line":15,"address":[],"length":0,"stats":{"Line":0}},{"line":16,"address":[],"length":0,"stats":{"Line":0}},{"line":20,"address":[],"length":0,"stats":{"Line":0}},{"line":21,"address":[],"length":0,"stats":{"Line":0}},{"line":22,"address":[],"length":0,"stats":{"Line":0}},{"line":23,"address":[],"length":0,"stats":{"Line":0}},{"line":24,"address":[],"length":0,"stats":{"Line":0}},{"line":27,"address":[],"length":0,"stats":{"Line":0}},{"line":28,"address":[],"length":0,"stats":{"Line":0}},{"line":30,"address":[],"length":0,"stats":{"Line":0}},{"line":34,"address":[],"length":0,"stats":{"Line":0}},{"line":35,"address":[],"length":0,"stats":{"Line":0}},{"line":37,"address":[],"length":0,"stats":{"Line":0}},{"line":38,"address":[],"length":0,"stats":{"Line":0}},{"line":39,"address":[],"length":0,"stats":{"Line":0}},{"line":40,"address":[],"length":0,"stats":{"Line":0}},{"line":41,"address":[],"length":0,"stats":{"Line":0}},{"line":42,"address":[],"length":0,"stats":{"Line":0}},{"line":45,"address":[],"length":0,"stats":{"Line":0}},{"line":46,"address":[],"length":0,"stats":{"Line":0}},{"line":47,"address":[],"length":0,"stats":{"Line":0}},{"line":48,"address":[],"length":0,"stats":{"Line":0}},{"line":49,"address":[],"length":0,"stats":{"Line":0}},{"line":50,"address":[],"length":0,"stats":{"Line":0}},{"line":51,"address":[],"length":0,"stats":{"Line":0}}],"covered":0,"coverable":25},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pelanggan","controller","mod.rs"],"content":"use rocket::{fairing::AdHoc, routes};\r\n\r\npub mod pelanggan;\r\n\r\npub fn route_stage() -\u003e AdHoc {\r\n    return AdHoc::on_ignite(\"Initializing controller routes...\", |rocket| async {\r\n        rocket\r\n            .mount(\"/api/pelanggan\", routes![])\r\n    });\r\n}\r\n","traces":[{"line":5,"address":[],"length":0,"stats":{"Line":0}},{"line":6,"address":[],"length":0,"stats":{"Line":0}},{"line":7,"address":[],"length":0,"stats":{"Line":0}},{"line":8,"address":[],"length":0,"stats":{"Line":0}}],"covered":0,"coverable":4},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pelanggan","controller","pelanggan.rs"],"content":"","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pelanggan","mod.rs"],"content":"pub mod controller;\r\npub mod model;\r\npub mod repository;\r\npub mod service;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pelanggan","model","mod.rs"],"content":"pub mod pelanggan;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pelanggan","model","pelanggan.rs"],"content":"use chrono::{ Utc, NaiveDate };\r\n\r\n/// Struct representing a customer (Pelanggan) in the system.\r\n/// Contains fields for ID, name, address, phone number, and join date.\r\n/// \r\n/// The `new` method can be used to create a new `Pelanggan` with only the necessary fields.\r\n/// ID and join date will be automatically initialized.\r\n#[derive(Debug, Clone)]\r\npub struct Pelanggan {\r\n    pub id: i32,\r\n    pub nama: String,\r\n    pub alamat: String,\r\n    pub no_telp: String,\r\n    pub tanggal_gabung: NaiveDate,\r\n}\r\n\r\nimpl Pelanggan {\r\n    /// Creates a new instance of `Pelanggan`. Automatically initializes the `id` to 0 \r\n    /// and sets the `tanggal_gabung` to the current date. Use the default constructor\r\n    /// to create a `Pelanggan` object from an existing data source.\r\n    pub fn new(nama: String, alamat: String, no_telp: String) -\u003e Self {\r\n        Pelanggan {\r\n            id: 0,\r\n            nama,\r\n            alamat,\r\n            no_telp,\r\n            tanggal_gabung: Utc::now().date_naive(),\r\n        }\r\n    }\r\n}\r\n\r\n#[cfg(test)]\r\nmod test {\r\n    use super::*;\r\n\r\n    #[test]\r\n    fn test_create_pelanggan() {\r\n        let pelanggan = Pelanggan::new( \"Castorice\".to_string(), \"Amphoreus\".to_string(), \"1234567890\".to_string());\r\n        assert_eq!(pelanggan.nama, \"Castorice\");\r\n        assert_eq!(pelanggan.alamat, \"Amphoreus\");\r\n        assert_eq!(pelanggan.no_telp, \"1234567890\");\r\n        assert_eq!(pelanggan.tanggal_gabung, Utc::now().date_naive());\r\n    }\r\n}","traces":[{"line":21,"address":[],"length":0,"stats":{"Line":3170534137668829184}},{"line":27,"address":[],"length":0,"stats":{"Line":3170534137668829184}}],"covered":2,"coverable":2},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pelanggan","repository","mod.rs"],"content":"pub mod pelanggan;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pelanggan","repository","pelanggan.rs"],"content":"use sqlx::any::AnyRow;\r\nuse sqlx::{Any, pool::PoolConnection};\r\nuse sqlx::Row;\r\nuse chrono::NaiveDate;\r\n\r\nuse crate::manajemen_pelanggan::model::pelanggan::Pelanggan;\r\n\r\npub struct PelangganRepository;\r\n\r\nimpl PelangganRepository {\r\n    pub async fn create_pelanggan(mut db: PoolConnection\u003cAny\u003e, pelanggan: \u0026Pelanggan) -\u003e Result\u003cPelanggan, sqlx::Error\u003e {\r\n        let result = sqlx::query(\"\r\n                INSERT INTO pelanggan (nama, alamat, no_telp, tanggal_gabung)\r\n                VALUES ($1, $2, $3, $4)\r\n                RETURNING id, nama, alamat, no_telp, tanggal_gabung\r\n            \")\r\n            .bind(\u0026pelanggan.nama)\r\n            .bind(\u0026pelanggan.alamat)\r\n            .bind(\u0026pelanggan.no_telp)\r\n            .bind(pelanggan.tanggal_gabung.to_string())\r\n            .fetch_one(\u0026mut *db)\r\n            .await?;\r\n        \r\n        let pelanggan = Self::parse_row_to_pelanggan(result);\r\n\r\n        Ok(pelanggan)\r\n    }\r\n\r\n    pub async fn get_pelanggan_by_id(mut db: PoolConnection\u003cAny\u003e, id: i32) -\u003e Result\u003cPelanggan, sqlx::Error\u003e {\r\n        let result = sqlx::query(\"\r\n                SELECT id, nama, alamat, no_telp, tanggal_gabung\r\n                FROM pelanggan\r\n                WHERE id = $1\r\n            \")\r\n            .bind(id)\r\n            .fetch_one(\u0026mut *db)\r\n            .await?;\r\n        \r\n        let pelanggan = Self::parse_row_to_pelanggan(result);\r\n\r\n        Ok(pelanggan)\r\n    }\r\n\r\n    pub async fn update_pelanggan(mut db: PoolConnection\u003cAny\u003e, pelanggan: \u0026Pelanggan) -\u003e Result\u003cPelanggan, sqlx::Error\u003e {\r\n        let result = sqlx::query(\"\r\n        UPDATE pelanggan\r\n        SET nama = $1, alamat = $2, no_telp = $3, tanggal_gabung = $4\r\n        WHERE id = $5\r\n        RETURNING id, nama, alamat, no_telp, tanggal_gabung\r\n        \")\r\n            .bind(\u0026pelanggan.nama)\r\n            .bind(\u0026pelanggan.alamat)\r\n            .bind(\u0026pelanggan.no_telp)\r\n            .bind(pelanggan.tanggal_gabung.to_string())\r\n            .bind(pelanggan.id)\r\n            .fetch_one(\u0026mut *db)\r\n            .await?;\r\n        \r\n        let pelanggan = Self::parse_row_to_pelanggan(result);\r\n\r\n        Ok(pelanggan)\r\n    }\r\n    \r\n    pub async fn delete_pelanggan(mut db: PoolConnection\u003cAny\u003e, id: i32) -\u003e Result\u003c(), sqlx::Error\u003e {\r\n        sqlx::query(\"\r\n        DELETE FROM pelanggan\r\n                WHERE id = $1\r\n                \")\r\n            .bind(id)\r\n            .execute(\u0026mut *db)\r\n            .await?;\r\n        \r\n        Ok(())\r\n    }\r\n    \r\n    pub async fn get_all_pelanggan(mut db: PoolConnection\u003cAny\u003e) -\u003e Result\u003cVec\u003cPelanggan\u003e, sqlx::Error\u003e {\r\n        let rows = sqlx::query(\"\r\n                SELECT id, nama, alamat, no_telp, tanggal_gabung\r\n                FROM pelanggan\r\n            \")\r\n            .fetch_all(\u0026mut *db)\r\n            .await?;\r\n        \r\n        let mut pelanggan_list = Vec::new();\r\n        for row in rows {\r\n            let pelanggan = Self::parse_row_to_pelanggan(row);\r\n            pelanggan_list.push(pelanggan);\r\n        }\r\n        \r\n        Ok(pelanggan_list)\r\n    }\r\n\r\n    fn parse_row_to_pelanggan(row: AnyRow) -\u003e Pelanggan {\r\n        Pelanggan {\r\n            id: row.get(\"id\"),\r\n            nama: row.get(\"nama\"),\r\n            alamat: row.get(\"alamat\"),\r\n            no_telp: row.get(\"no_telp\"),\r\n            tanggal_gabung: NaiveDate::parse_from_str(\u0026row.get::\u003cString, _\u003e(\"tanggal_gabung\"), \"%Y-%m-%d\").unwrap(),\r\n        }\r\n    }\r\n}\r\n\r\n#[cfg(test)]\r\nmod test {\r\n    use super::*;\r\n    use sqlx::any::install_default_drivers;\r\n    use sqlx::{Any, Pool};\r\n    use sqlx::any::AnyPoolOptions;\r\n    use rocket::async_test;\r\n    use chrono::Utc;\r\n\r\n    async fn setup() -\u003e Pool\u003cAny\u003e {\r\n        install_default_drivers();\r\n        let db = AnyPoolOptions::new()\r\n            .max_connections(1)\r\n            .connect(\"sqlite::memory:\")\r\n            .await\r\n            .unwrap();\r\n        sqlx::migrate!(\"migrations/test\")\r\n            .run(\u0026db)\r\n            .await\r\n            .unwrap();\r\n        db\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_create_pelanggan() {\r\n        let db = setup().await;\r\n\r\n        let pelanggan = Pelanggan::new(\"Castorice\".to_string(), \"Styxia\".to_string(), \"1234567890\".to_string());\r\n        let created_pelanggan = PelangganRepository::create_pelanggan(db.acquire().await.unwrap(), \u0026pelanggan).await.unwrap();\r\n\r\n        assert_eq!(created_pelanggan.nama, \"Castorice\");\r\n        assert_eq!(created_pelanggan.alamat, \"Styxia\");\r\n        assert_eq!(created_pelanggan.no_telp, \"1234567890\");\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_get_pelanggan_by_id() {\r\n        let db = setup().await;\r\n\r\n        let pelanggan = Pelanggan::new(\"Tribbie\".to_string(), \"Okhema\".to_string(), \"0987654321\".to_string());\r\n        let created_pelanggan = PelangganRepository::create_pelanggan(db.acquire().await.unwrap(), \u0026pelanggan).await.unwrap();\r\n\r\n        let fetched_pelanggan = PelangganRepository::get_pelanggan_by_id(db.acquire().await.unwrap(), created_pelanggan.id).await.unwrap();\r\n\r\n        assert_eq!(fetched_pelanggan.nama, \"Tribbie\");\r\n        assert_eq!(fetched_pelanggan.alamat, \"Okhema\");\r\n        assert_eq!(fetched_pelanggan.no_telp, \"0987654321\");\r\n        assert_eq!(fetched_pelanggan.tanggal_gabung, Utc::now().date_naive());\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_get_pelanggan_by_id_not_found() {\r\n        let db = setup().await;\r\n\r\n        let result = PelangganRepository::get_pelanggan_by_id(db.acquire().await.unwrap(), 999).await;\r\n        assert!(result.is_err());\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_update_pelanggan() {\r\n        let db = setup().await;\r\n\r\n        let pelanggan = Pelanggan::new(\"Hyacine\".to_string(), \"The Grove\".to_string(), \"1122334455\".to_string());\r\n        let created_pelanggan = PelangganRepository::create_pelanggan(db.acquire().await.unwrap(), \u0026pelanggan).await.unwrap();\r\n\r\n        let updated_pelanggan = Pelanggan {\r\n            id: created_pelanggan.id,\r\n            nama: \"Hyacine\".to_string(),\r\n            alamat: \"Okhema\".to_string(),\r\n            no_telp: \"1234567890\".to_string(),\r\n            tanggal_gabung: created_pelanggan.tanggal_gabung,\r\n        };\r\n\r\n        let result = PelangganRepository::update_pelanggan(db.acquire().await.unwrap(), \u0026updated_pelanggan).await.unwrap();\r\n        assert_eq!(result.nama, \"Hyacine\");\r\n        assert_eq!(result.no_telp, \"1234567890\");\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_update_pelanggan_not_found() {\r\n        let db = setup().await;\r\n\r\n        let pelanggan = Pelanggan::new(\"Anaxa\".to_string(), \"The Grove\".to_string(), \"5566778899\".to_string());\r\n        let created_pelanggan = PelangganRepository::create_pelanggan(db.acquire().await.unwrap(), \u0026pelanggan).await.unwrap();\r\n\r\n        let updated_pelanggan = Pelanggan {\r\n            id: 999,\r\n            nama: \"Anaxagoras\".to_string(),\r\n            alamat: \"Dragonbone City\".to_string(),\r\n            no_telp: \"5566778899\".to_string(),\r\n            tanggal_gabung: created_pelanggan.tanggal_gabung,\r\n        };\r\n\r\n        let result = PelangganRepository::update_pelanggan(db.acquire().await.unwrap(), \u0026updated_pelanggan).await;\r\n        assert!(result.is_err());\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_delete_pelanggan() {\r\n        let db = setup().await;\r\n\r\n        let pelanggan = Pelanggan::new(\"Aglaea\".to_string(), \"Okhema\".to_string(), \"9988776655\".to_string());\r\n        let created_pelanggan = PelangganRepository::create_pelanggan(db.acquire().await.unwrap(), \u0026pelanggan).await.unwrap();\r\n\r\n        PelangganRepository::delete_pelanggan(db.acquire().await.unwrap(), created_pelanggan.id).await.unwrap();\r\n\r\n        let result = PelangganRepository::get_pelanggan_by_id(db.acquire().await.unwrap(), created_pelanggan.id).await;\r\n        assert!(result.is_err());\r\n    }\r\n\r\n    #[async_test]\r\n    async fn test_get_all_pelanggan() {\r\n        let db = setup().await;\r\n\r\n        let pelanggan1 = Pelanggan::new(\"Polyxia\".to_string(), \"River of Souls\".to_string(), \"2233445566\".to_string());\r\n        let pelanggan2 = Pelanggan::new(\"Pollux\".to_string(), \"River of Souls\".to_string(), \"3344556677\".to_string());\r\n\r\n        PelangganRepository::create_pelanggan(db.acquire().await.unwrap(), \u0026pelanggan1).await.unwrap();\r\n        PelangganRepository::create_pelanggan(db.acquire().await.unwrap(), \u0026pelanggan2).await.unwrap();\r\n\r\n        let result = PelangganRepository::get_all_pelanggan(db.acquire().await.unwrap()).await.unwrap();\r\n        assert_eq!(result.len(), 2);\r\n    }\r\n}","traces":[{"line":11,"address":[],"length":0,"stats":{"Line":2017612633061982208}},{"line":17,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":18,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":19,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":20,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":21,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":22,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":24,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":26,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":29,"address":[],"length":0,"stats":{"Line":864691128455135232}},{"line":35,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":36,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":37,"address":[],"length":0,"stats":{"Line":720575940379279360}},{"line":39,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":41,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":44,"address":[],"length":0,"stats":{"Line":576460752303423488}},{"line":51,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":52,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":53,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":54,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":55,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":56,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":57,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":59,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":61,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":64,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":69,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":70,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":71,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":73,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":76,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":81,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":82,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":84,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":85,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":86,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":87,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":90,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":93,"address":[],"length":0,"stats":{"Line":1585267068834414592}},{"line":95,"address":[],"length":0,"stats":{"Line":1585267068834414592}},{"line":96,"address":[],"length":0,"stats":{"Line":1585267068834414592}},{"line":97,"address":[],"length":0,"stats":{"Line":1585267068834414592}},{"line":98,"address":[],"length":0,"stats":{"Line":1585267068834414592}},{"line":99,"address":[],"length":0,"stats":{"Line":1585267068834414592}}],"covered":44,"coverable":44},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pelanggan","service","filter.rs"],"content":"use crate::manajemen_pelanggan::model::pelanggan::Pelanggan;\r\n\r\npub trait FilterStrategy {\r\n    fn execute(\u0026self, pelanggan_vec: \u0026mut Vec\u003cPelanggan\u003e, query: \u0026str);\r\n}\r\n\r\npub struct FilterByNama;\r\nimpl FilterStrategy for FilterByNama {\r\n    fn execute(\u0026self, pelanggan_vec: \u0026mut Vec\u003cPelanggan\u003e, query: \u0026str) {\r\n        pelanggan_vec.retain(|customer| customer.nama.contains(query));\r\n    }\r\n}\r\n\r\npub struct FilterByTanggalGabungPrev;\r\nimpl FilterStrategy for FilterByTanggalGabungPrev {\r\n    fn execute(\u0026self, pelanggan_vec: \u0026mut Vec\u003cPelanggan\u003e, query: \u0026str) {\r\n        let date = match chrono::NaiveDate::parse_from_str(query, \"%Y-%m-%d\") {\r\n            Ok(parsed_date) =\u003e parsed_date,\r\n            Err(_) =\u003e return,\r\n        };\r\n        pelanggan_vec.retain(|customer| {customer.tanggal_gabung \u003c date});\r\n    }\r\n}\r\n\r\npub struct FilterByTanggalGabungAfter;\r\nimpl FilterStrategy for FilterByTanggalGabungAfter {\r\n    fn execute(\u0026self, pelanggan_vec: \u0026mut Vec\u003cPelanggan\u003e, query: \u0026str) {\r\n        let date = match chrono::NaiveDate::parse_from_str(query, \"%Y-%m-%d\") {\r\n            Ok(parsed_date) =\u003e parsed_date,\r\n            Err(_) =\u003e return,\r\n        };\r\n        pelanggan_vec.retain(|customer| {customer.tanggal_gabung \u003e date});\r\n    }\r\n}\r\n\r\n#[cfg(test)]\r\nmod test {\r\n    use super::*;\r\n    use crate::manajemen_pelanggan::model::pelanggan::Pelanggan;\r\n\r\n    #[test]\r\n    fn test_filter_by_nama() {\r\n        let mut pelanggan_vec = vec![\r\n            Pelanggan::new(\"John Doe\".to_string(), \"123 Main St\".to_string(), \"1234567890\".to_string()),\r\n            Pelanggan::new(\"Jane Smith\".to_string(), \"456 Elm St\".to_string(), \"0987654321\".to_string()),\r\n        ];\r\n\r\n        let filter = FilterByNama;\r\n        filter.execute(\u0026mut pelanggan_vec, \"John\");\r\n\r\n        assert_eq!(pelanggan_vec.len(), 1);\r\n        assert_eq!(pelanggan_vec[0].nama, \"John Doe\");\r\n    }\r\n\r\n    \r\n    #[test]\r\n    fn test_filter_by_tanggal_gabung_prev() {\r\n        let mut pelanggan_vec = vec![\r\n            Pelanggan::new(\"John Doe\".to_string(), \"123 Main St\".to_string(), \"1234567890\".to_string()),\r\n            Pelanggan::new(\"Jane Smith\".to_string(), \"456 Elm St\".to_string(), \"0987654321\".to_string()),\r\n        ];\r\n\r\n        let filter = FilterByTanggalGabungPrev;\r\n        filter.execute(\u0026mut pelanggan_vec, \"2023-01-01\");\r\n\r\n        assert_eq!(pelanggan_vec.len(), 0);\r\n    }\r\n\r\n    #[test]\r\n    fn test_filter_by_tanggal_gabung_after() {\r\n        let mut pelanggan_vec = vec![\r\n            Pelanggan::new(\"John Doe\".to_string(), \"123 Main St\".to_string(), \"1234567890\".to_string()),\r\n            Pelanggan::new(\"Jane Smith\".to_string(), \"456 Elm St\".to_string(), \"0987654321\".to_string()),\r\n        ];\r\n\r\n        let filter = FilterByTanggalGabungAfter;\r\n        filter.execute(\u0026mut pelanggan_vec, \"2023-01-01\");\r\n\r\n        assert_eq!(pelanggan_vec.len(), 2);\r\n    }\r\n}","traces":[{"line":9,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":10,"address":[],"length":0,"stats":{"Line":1152921504606846976}},{"line":16,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":17,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":19,"address":[],"length":0,"stats":{"Line":0}},{"line":21,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":27,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":28,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":30,"address":[],"length":0,"stats":{"Line":0}},{"line":32,"address":[],"length":0,"stats":{"Line":288230376151711744}}],"covered":8,"coverable":10},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pelanggan","service","filter_context.rs"],"content":"use crate::manajemen_pelanggan::service::filter::FilterStrategy;\r\nuse crate::manajemen_pelanggan::model::pelanggan::Pelanggan;\r\nuse crate::manajemen_pelanggan::service::filter::FilterByNama;\r\n\r\npub struct FilterContext\u003c'a\u003e {\r\n    filter_strategy: Box\u003cdyn FilterStrategy + 'a\u003e,\r\n}\r\n\r\nimpl\u003c'a\u003e FilterContext\u003c'a\u003e {\r\n    pub fn new() -\u003e Self {\r\n        FilterContext {\r\n            filter_strategy: Box::new(FilterByNama),\r\n        }\r\n    }\r\n\r\n    pub fn set_strategy(\u0026mut self, filter_strategy: Box\u003cdyn FilterStrategy\u003e) {\r\n        self.filter_strategy = filter_strategy;\r\n    }\r\n\r\n    pub fn execute_filter(\u0026mut self, customers: \u0026mut Vec\u003cPelanggan\u003e, query: \u0026str) {\r\n        self.filter_strategy.execute( customers, query);\r\n    }\r\n}\r\n\r\n#[cfg(test)]\r\nmod test {\r\n    use super::*;\r\n    use crate::manajemen_pelanggan::model::pelanggan::Pelanggan;\r\n    use crate::manajemen_pelanggan::service::filter::FilterByNama;\r\n\r\n    #[test]\r\n    fn test_sort_context() {\r\n        let mut customers = vec![\r\n            Pelanggan::new(\"John Doe\".to_string(), \"123 Main St\".to_string(), \"1234567890\".to_string()),\r\n            Pelanggan::new(\"Jane Smith\".to_string(), \"456 Elm St\".to_string(), \"0987654321\".to_string()),\r\n        ];\r\n\r\n        let mut filter_context = FilterContext::new();\r\n        filter_context.set_strategy(Box::new(FilterByNama));\r\n\r\n        let query = \"Jane\";\r\n\r\n        filter_context.execute_filter(\u0026mut customers, query);\r\n\r\n        assert_eq!(customers.len(), 1);\r\n        assert_eq!(customers[0].nama, \"Jane Smith\");\r\n    }\r\n}","traces":[{"line":10,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":12,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":16,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":17,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":20,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":21,"address":[],"length":0,"stats":{"Line":144115188075855872}}],"covered":6,"coverable":6},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pelanggan","service","mod.rs"],"content":"pub mod pelanggan;\r\npub mod sort;\r\npub mod sort_context;\r\npub mod filter;\r\npub mod filter_context;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pelanggan","service","pelanggan.rs"],"content":"","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pelanggan","service","sort.rs"],"content":"use crate::manajemen_pelanggan::model::pelanggan::Pelanggan;\r\n\r\npub trait SortStrategy {\r\n    fn execute(\u0026self, customers: \u0026mut Vec\u003cPelanggan\u003e);\r\n}\r\n\r\npub struct SortByNama;\r\nimpl SortStrategy for SortByNama {\r\n    fn execute(\u0026self, customers: \u0026mut Vec\u003cPelanggan\u003e) {\r\n        customers.sort_by(|a, b| a.nama.cmp(\u0026b.nama));\r\n    }\r\n}\r\n\r\npub struct SortByTanggalGabung;\r\nimpl SortStrategy for SortByTanggalGabung {\r\n    fn execute(\u0026self, customers: \u0026mut Vec\u003cPelanggan\u003e) {\r\n        customers.sort_by(|a, b| a.tanggal_gabung.cmp(\u0026b.tanggal_gabung));\r\n    }\r\n}\r\n\r\n#[cfg(test)]\r\nmod test {\r\n    use super::*;\r\n    use crate::manajemen_pelanggan::model::pelanggan::Pelanggan;\r\n\r\n    #[test]\r\n    fn test_sort_by_nama() {\r\n        let mut customers = vec![\r\n            Pelanggan::new(\"John Doe\".to_string(), \"123 Main St\".to_string(), \"1234567890\".to_string()),\r\n            Pelanggan::new(\"Jane Smith\".to_string(), \"456 Elm St\".to_string(), \"0987654321\".to_string()),\r\n        ];\r\n\r\n        let sorter = SortByNama;\r\n        sorter.execute(\u0026mut customers);\r\n\r\n        assert_eq!(customers[0].nama, \"Jane Smith\");\r\n        assert_eq!(customers[1].nama, \"John Doe\");\r\n    }\r\n\r\n    #[test]\r\n    fn test_sort_by_tanggal_gabung() {\r\n        let mut customers = vec![\r\n            Pelanggan::new(\"John Doe\".to_string(), \"123 Main St\".to_string(), \"1234567890\".to_string()),\r\n            Pelanggan::new(\"Jane Smith\".to_string(), \"456 Elm St\".to_string(), \"0987654321\".to_string()),\r\n        ];\r\n\r\n        let sorter = SortByTanggalGabung;\r\n        sorter.execute(\u0026mut customers);\r\n\r\n        assert_eq!(customers[0].tanggal_gabung, customers[1].tanggal_gabung);\r\n    }\r\n}","traces":[{"line":9,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":10,"address":[],"length":0,"stats":{"Line":864691128455135232}},{"line":16,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":17,"address":[],"length":0,"stats":{"Line":432345564227567616}}],"covered":4,"coverable":4},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pelanggan","service","sort_context.rs"],"content":"use crate::manajemen_pelanggan::service::sort::SortStrategy;\r\nuse crate::manajemen_pelanggan::model::pelanggan::Pelanggan;\r\n\r\nuse super::sort::SortByNama;\r\n\r\npub struct SortContext\u003c'a\u003e {\r\n    sort_strategy: Box\u003cdyn SortStrategy + 'a\u003e,\r\n}\r\n\r\nimpl\u003c'a\u003e SortContext\u003c'a\u003e {\r\n    pub fn new() -\u003e Self {\r\n        SortContext {\r\n            sort_strategy: Box::new(SortByNama),\r\n        }\r\n    }\r\n\r\n    pub fn set_strategy(\u0026mut self, sort_strategy: Box\u003cdyn SortStrategy\u003e) {\r\n        self.sort_strategy = sort_strategy;\r\n    }\r\n\r\n    pub fn execute_sort(\u0026mut self, customers: \u0026mut Vec\u003cPelanggan\u003e) {\r\n        self.sort_strategy.execute(customers);\r\n    }\r\n}\r\n\r\n#[cfg(test)]\r\nmod test {\r\n    use super::*;\r\n    use crate::manajemen_pelanggan::model::pelanggan::Pelanggan;\r\n    use crate::manajemen_pelanggan::service::sort::SortByNama;\r\n\r\n    #[test]\r\n    fn test_sort_context() {\r\n        let mut customers = vec![\r\n            Pelanggan::new(\"John Doe\".to_string(), \"123 Main St\".to_string(), \"1234567890\".to_string()),\r\n            Pelanggan::new(\"Jane Smith\".to_string(), \"456 Elm St\".to_string(), \"0987654321\".to_string()),\r\n        ];\r\n\r\n        let mut sort_context = SortContext::new();\r\n        sort_context.set_strategy(Box::new(SortByNama));\r\n\r\n        sort_context.execute_sort(\u0026mut customers);\r\n\r\n        assert_eq!(customers[0].nama, \"Jane Smith\");\r\n        assert_eq!(customers[1].nama, \"John Doe\");\r\n    }\r\n}","traces":[{"line":11,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":13,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":17,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":18,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":21,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":22,"address":[],"length":0,"stats":{"Line":144115188075855872}}],"covered":6,"coverable":6},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pembayaran","controller","mod.rs"],"content":"pub mod payment_controller;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pembayaran","controller","payment_controller.rs"],"content":"use std::sync::Arc;\r\nuse std::collections::HashMap;\r\nuse serde::{Serialize, Deserialize};\r\n\r\nuse crate::manajemen_pembayaran::model::payment::{Payment, PaymentMethod};\r\nuse crate::manajemen_pembayaran::enums::payment_status::PaymentStatus;\r\nuse crate::manajemen_pembayaran::service::payment_service::PaymentService;\r\n\r\n#[derive(Deserialize)]\r\npub struct CreatePaymentRequest {\r\n    pub transaction_id: String,\r\n    pub amount: f64,\r\n    pub method: String,\r\n}\r\n\r\n#[derive(Deserialize)]\r\npub struct UpdatePaymentStatusRequest {\r\n    pub payment_id: String,\r\n    pub new_status: String,\r\n    pub additional_amount: Option\u003cf64\u003e,\r\n}\r\n\r\n#[derive(Deserialize)]\r\npub struct AddInstallmentRequest {\r\n    pub payment_id: String,\r\n    pub amount: f64,\r\n}\r\n\r\n#[derive(Deserialize)]\r\npub struct PaymentFilterRequest {\r\n    pub status: Option\u003cString\u003e,\r\n    pub method: Option\u003cString\u003e,\r\n}\r\n\r\n#[derive(Serialize)]\r\npub struct ApiResponse\u003cT\u003e {\r\n    pub success: bool,\r\n    pub data: Option\u003cT\u003e,\r\n    pub message: Option\u003cString\u003e,\r\n}\r\n\r\npub struct PaymentController {\r\n    service: Arc\u003cdyn PaymentService\u003e,\r\n}\r\n\r\nimpl PaymentController {\r\n    pub fn new(service: Arc\u003cdyn PaymentService\u003e) -\u003e Self {\r\n        Self { service }\r\n    }\r\n\r\n    pub fn create_payment(\u0026self, request: CreatePaymentRequest) -\u003e ApiResponse\u003cPayment\u003e {\r\n        let method = match request.method.to_uppercase().as_str() {\r\n            \"CASH\" =\u003e PaymentMethod::Cash,\r\n            \"CREDIT_CARD\" =\u003e PaymentMethod::CreditCard,\r\n            \"BANK_TRANSFER\" =\u003e PaymentMethod::BankTransfer,\r\n            \"E_WALLET\" =\u003e PaymentMethod::EWallet,\r\n            _ =\u003e {\r\n                return ApiResponse {\r\n                    success: false,\r\n                    data: None,\r\n                    message: Some(\"Metode pembayaran tidak valid\".to_string()),\r\n                }\r\n            }\r\n        };\r\n\r\n        match self.service.create_payment(request.transaction_id, request.amount, method) {\r\n            Ok(payment) =\u003e ApiResponse {\r\n                success: true,\r\n                data: Some(payment),\r\n                message: None,\r\n            },\r\n            Err(error) =\u003e ApiResponse {\r\n                success: false,\r\n                data: None,\r\n                message: Some(error),\r\n            },\r\n        }\r\n    }\r\n\r\n    pub fn update_payment_status(\u0026self, request: UpdatePaymentStatusRequest) -\u003e ApiResponse\u003cPayment\u003e {\r\n        let status = match PaymentStatus::from_string(\u0026request.new_status) {\r\n            Some(status) =\u003e status,\r\n            None =\u003e {\r\n                return ApiResponse {\r\n                    success: false,\r\n                    data: None,\r\n                    message: Some(\"Status pembayaran tidak valid\".to_string()),\r\n                }\r\n            }\r\n        };\r\n\r\n        match self.service.update_payment_status(\r\n            request.payment_id,\r\n            status,\r\n            request.additional_amount,\r\n        ) {\r\n            Ok(payment) =\u003e ApiResponse {\r\n                success: true,\r\n                data: Some(payment),\r\n                message: None,\r\n            },\r\n            Err(error) =\u003e ApiResponse {\r\n                success: false,\r\n                data: None,\r\n                message: Some(error),\r\n            },\r\n        }\r\n    }\r\n\r\n    pub fn add_installment(\u0026self, request: AddInstallmentRequest) -\u003e ApiResponse\u003cPayment\u003e {\r\n        match self.service.add_installment(\u0026request.payment_id, request.amount) {\r\n            Ok(payment) =\u003e ApiResponse {\r\n                success: true,\r\n                data: Some(payment),\r\n                message: None,\r\n            },\r\n            Err(error) =\u003e ApiResponse {\r\n                success: false,\r\n                data: None,\r\n                message: Some(error),\r\n            },\r\n        }\r\n    }\r\n\r\n    pub fn get_payment(\u0026self, payment_id: \u0026str) -\u003e ApiResponse\u003cPayment\u003e {\r\n        match self.service.get_payment(payment_id) {\r\n            Some(payment) =\u003e ApiResponse {\r\n                success: true,\r\n                data: Some(payment),\r\n                message: None,\r\n            },\r\n            None =\u003e ApiResponse {\r\n                success: false,\r\n                data: None,\r\n                message: Some(format!(\"Pembayaran dengan ID {} tidak ditemukan\", payment_id)),\r\n            },\r\n        }\r\n    }\r\n\r\n    pub fn get_payment_by_transaction(\u0026self, transaction_id: \u0026str) -\u003e ApiResponse\u003cPayment\u003e {\r\n        match self.service.get_payment_by_transaction(transaction_id) {\r\n            Some(payment) =\u003e ApiResponse {\r\n                success: true,\r\n                data: Some(payment),\r\n                message: None,\r\n            },\r\n            None =\u003e ApiResponse {\r\n                success: false,\r\n                data: None,\r\n                message: Some(format!(\r\n                    \"Pembayaran untuk transaksi {} tidak ditemukan\",\r\n                    transaction_id\r\n                )),\r\n            },\r\n        }\r\n    }\r\n\r\n    pub fn get_all_payments(\u0026self, filter: Option\u003cPaymentFilterRequest\u003e) -\u003e ApiResponse\u003cVec\u003cPayment\u003e\u003e {\r\n        let mut filters: Option\u003cHashMap\u003cString, String\u003e\u003e = None;\r\n        \r\n        if let Some(filter_req) = filter {\r\n            let mut map = HashMap::new();\r\n            \r\n            if let Some(status) = filter_req.status {\r\n                map.insert(\"status\".to_string(), status);\r\n            }\r\n            \r\n            if let Some(method) = filter_req.method {\r\n                map.insert(\"method\".to_string(), method);\r\n            }\r\n            \r\n            if !map.is_empty() {\r\n                filters = Some(map);\r\n            }\r\n        }\r\n\r\n        let payments = self.service.get_all_payments(filters);\r\n        \r\n        ApiResponse {\r\n            success: true,\r\n            data: Some(payments),\r\n            message: None,\r\n        }\r\n    }\r\n\r\n    pub fn delete_payment(\u0026self, payment_id: \u0026str) -\u003e ApiResponse\u003c()\u003e {\r\n        match self.service.delete_payment(payment_id.to_string()) {\r\n            Ok(_) =\u003e ApiResponse {\r\n                success: true,\r\n                data: Some(()),\r\n                message: Some(\"Pembayaran berhasil dihapus\".to_string()),\r\n            },\r\n            Err(error) =\u003e ApiResponse {\r\n                success: false,\r\n                data: None,\r\n                message: Some(error),\r\n            },\r\n        }\r\n    }\r\n}\r\n\r\n#[cfg(test)]\r\nmod tests {\r\n    use super::*;\r\n    use std::sync::Arc;\r\n    use uuid::Uuid;\r\n\r\n    use crate::manajemen_pembayaran::repository::payment_repository_impl::PaymentRepositoryImpl;\r\n    use crate::manajemen_pembayaran::repository::payment_repository::PaymentRepository;\r\n    use crate::manajemen_pembayaran::patterns::observer::{PaymentSubject, TransactionObserver, PaymentObserver};\r\n    use crate::manajemen_pembayaran::service::payment_service_impl::PaymentServiceImpl;\r\n    use crate::manajemen_pembayaran::service::payment_service::PaymentService;\r\n\r\n    fn setup_controller() -\u003e PaymentController {\r\n        let repository: Arc\u003cdyn PaymentRepository\u003e = Arc::new(PaymentRepositoryImpl::new());\r\n        \r\n        let mut subject = PaymentSubject::new();\r\n        let observer = Arc::new(TransactionObserver) as Arc\u003cdyn PaymentObserver\u003e;\r\n        subject.attach(observer);\r\n        let subject = Arc::new(subject);\r\n        \r\n        let service: Arc\u003cdyn PaymentService\u003e = Arc::new(PaymentServiceImpl::new(repository, subject));\r\n        \r\n        PaymentController::new(service)\r\n    }\r\n\r\n    #[test]\r\n    fn test_create_payment() {\r\n        let controller = setup_controller();\r\n        let transaction_id = format!(\"TRX-{}\", Uuid::new_v4());\r\n        \r\n        let request = CreatePaymentRequest {\r\n            transaction_id: transaction_id.clone(),\r\n            amount: 1000.0,\r\n            method: \"CASH\".to_string(),\r\n        };\r\n        \r\n        let response = controller.create_payment(request);\r\n        \r\n        assert!(response.success);\r\n        assert!(response.data.is_some());\r\n        let payment = response.data.unwrap();\r\n        assert_eq!(payment.transaction_id, transaction_id);\r\n        assert_eq!(payment.amount, 1000.0);\r\n        assert_eq!(payment.method, PaymentMethod::Cash);\r\n    }\r\n\r\n    #[test]\r\n    fn test_invalid_payment_method() {\r\n        let controller = setup_controller();\r\n        let transaction_id = format!(\"TRX-{}\", Uuid::new_v4());\r\n        \r\n        let request = CreatePaymentRequest {\r\n            transaction_id: transaction_id.clone(),\r\n            amount: 1000.0,\r\n            method: \"INVALID\".to_string(),\r\n        };\r\n        \r\n        let response = controller.create_payment(request);\r\n        \r\n        assert!(!response.success);\r\n        assert!(response.data.is_none());\r\n        assert!(response.message.is_some());\r\n        assert_eq!(response.message.unwrap(), \"Metode pembayaran tidak valid\");\r\n    }\r\n\r\n    #[test]\r\n    fn test_update_payment_status() {\r\n        let controller = setup_controller();\r\n        let transaction_id = format!(\"TRX-{}\", Uuid::new_v4());\r\n        \r\n        let create_request = CreatePaymentRequest {\r\n            transaction_id: transaction_id.clone(),\r\n            amount: 1000.0,\r\n            method: \"CASH\".to_string(),\r\n        };\r\n        \r\n        let create_response = controller.create_payment(create_request);\r\n        let payment = create_response.data.unwrap();\r\n        \r\n        let update_request = UpdatePaymentStatusRequest {\r\n            payment_id: payment.id.clone(),\r\n            new_status: \"CICILAN\".to_string(),\r\n            additional_amount: Some(500.0),\r\n        };\r\n        \r\n        let update_response = controller.update_payment_status(update_request);\r\n        \r\n        assert!(update_response.success);\r\n        assert!(update_response.data.is_some());\r\n        let updated_payment = update_response.data.unwrap();\r\n        assert_eq!(updated_payment.status, PaymentStatus::Installment);\r\n        assert_eq!(updated_payment.installments.len(), 1);\r\n        assert_eq!(updated_payment.installments[0].amount, 500.0);\r\n    }\r\n\r\n    #[test]\r\n    fn test_get_payment() {\r\n        let controller = setup_controller();\r\n        let transaction_id = format!(\"TRX-{}\", Uuid::new_v4());\r\n        \r\n        let create_request = CreatePaymentRequest {\r\n            transaction_id: transaction_id.clone(),\r\n            amount: 1000.0,\r\n            method: \"CASH\".to_string(),\r\n        };\r\n        \r\n        let create_response = controller.create_payment(create_request);\r\n        let payment = create_response.data.unwrap();\r\n        \r\n        let get_response = controller.get_payment(\u0026payment.id);\r\n        \r\n        assert!(get_response.success);\r\n        assert!(get_response.data.is_some());\r\n        assert_eq!(get_response.data.unwrap().id, payment.id);\r\n        \r\n        let get_by_tx_response = controller.get_payment_by_transaction(\u0026transaction_id);\r\n        \r\n        assert!(get_by_tx_response.success);\r\n        assert!(get_by_tx_response.data.is_some());\r\n        assert_eq!(get_by_tx_response.data.unwrap().transaction_id, transaction_id);\r\n    }\r\n\r\n    #[test]\r\n    fn test_add_installment() {\r\n        let controller = setup_controller();\r\n        \r\n        let create_request = CreatePaymentRequest {\r\n            transaction_id: format!(\"TRX-{}\", Uuid::new_v4()),\r\n            amount: 1000.0,\r\n            method: \"CASH\".to_string(),\r\n        };\r\n        \r\n        let create_response = controller.create_payment(create_request);\r\n        let payment = create_response.data.unwrap();\r\n        \r\n        let update_request = UpdatePaymentStatusRequest {\r\n            payment_id: payment.id.clone(),\r\n            new_status: \"CICILAN\".to_string(),\r\n            additional_amount: None,\r\n        };\r\n        \r\n        controller.update_payment_status(update_request);\r\n        \r\n        let add_request = AddInstallmentRequest {\r\n            payment_id: payment.id.clone(),\r\n            amount: 500.0,\r\n        };\r\n        \r\n        let add_response = controller.add_installment(add_request);\r\n        \r\n        assert!(add_response.success);\r\n        assert!(add_response.data.is_some());\r\n        assert_eq!(add_response.data.unwrap().installments.len(), 1);\r\n    }\r\n\r\n    #[test]\r\n    fn test_delete_payment() {\r\n        let controller = setup_controller();\r\n        \r\n        let create_request = CreatePaymentRequest {\r\n            transaction_id: format!(\"TRX-{}\", Uuid::new_v4()),\r\n            amount: 1000.0,\r\n            method: \"CASH\".to_string(),\r\n        };\r\n        \r\n        let create_response = controller.create_payment(create_request);\r\n        let payment = create_response.data.unwrap();\r\n        \r\n        let update_request = UpdatePaymentStatusRequest {\r\n            payment_id: payment.id.clone(),\r\n            new_status: \"CICILAN\".to_string(),\r\n            additional_amount: None,\r\n        };\r\n        \r\n        controller.update_payment_status(update_request);\r\n        \r\n        let delete_response = controller.delete_payment(\u0026payment.id);\r\n        \r\n        assert!(delete_response.success);\r\n        assert!(delete_response.data.is_some());\r\n        \r\n        let get_response = controller.get_payment(\u0026payment.id);\r\n        assert!(!get_response.success);\r\n    }\r\n\r\n    #[test]\r\n    fn test_get_all_payments() {\r\n        let controller = setup_controller();\r\n\r\n        let request1 = CreatePaymentRequest {\r\n            transaction_id: format!(\"TRX-{}\", Uuid::new_v4()),\r\n            amount: 1000.0,\r\n            method: \"CASH\".to_string(),\r\n        };\r\n        controller.create_payment(request1);\r\n\r\n        let request2 = CreatePaymentRequest {\r\n            transaction_id: format!(\"TRX-{}\", Uuid::new_v4()),\r\n            amount: 2000.0,\r\n            method: \"CREDIT_CARD\".to_string(),\r\n        };\r\n        controller.create_payment(request2);\r\n\r\n        let response = controller.get_all_payments(None);\r\n        assert!(response.success);\r\n        assert!(response.data.is_some());\r\n        assert_eq!(response.data.unwrap().len(), 2);\r\n\r\n        let filter_request = PaymentFilterRequest {\r\n            status: None,\r\n            method: Some(\"CASH\".to_string()),\r\n        };\r\n        let response = controller.get_all_payments(Some(filter_request));\r\n        assert!(response.success);\r\n        assert!(response.data.is_some());\r\n        assert_eq!(response.data.unwrap().len(), 1);\r\n    }\r\n}","traces":[{"line":47,"address":[],"length":0,"stats":{"Line":504403158265495552}},{"line":51,"address":[],"length":0,"stats":{"Line":576460752303423488}},{"line":52,"address":[],"length":0,"stats":{"Line":1080863910568919040}},{"line":53,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":54,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":55,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":56,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":58,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":59,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":60,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":61,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":69,"address":[],"length":0,"stats":{"Line":504403158265495552}},{"line":75,"address":[],"length":0,"stats":{"Line":0}},{"line":80,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":81,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":82,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":84,"address":[],"length":0,"stats":{"Line":0}},{"line":85,"address":[],"length":0,"stats":{"Line":0}},{"line":86,"address":[],"length":0,"stats":{"Line":0}},{"line":87,"address":[],"length":0,"stats":{"Line":0}},{"line":92,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":93,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":94,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":95,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":99,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":105,"address":[],"length":0,"stats":{"Line":0}},{"line":110,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":111,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":114,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":120,"address":[],"length":0,"stats":{"Line":0}},{"line":125,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":126,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":129,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":135,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":140,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":141,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":144,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":150,"address":[],"length":0,"stats":{"Line":0}},{"line":158,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":159,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":161,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":164,"address":[],"length":0,"stats":{"Line":0}},{"line":168,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":172,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":173,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":177,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":181,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":186,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":187,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":190,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":191,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":196,"address":[],"length":0,"stats":{"Line":0}}],"covered":42,"coverable":52},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pembayaran","enums","mod.rs"],"content":"pub mod payment_status;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pembayaran","enums","payment_status.rs"],"content":"#[derive(Debug, Clone, PartialEq)]\r\npub enum PaymentStatus {\r\n    Paid,    // LUNAS\r\n    Installment,  // CICILAN\r\n}\r\n\r\nimpl PaymentStatus {\r\n    pub fn from_string(status: \u0026str) -\u003e Option\u003cSelf\u003e {\r\n        match status.to_uppercase().as_str() {\r\n            \"LUNAS\" =\u003e Some(PaymentStatus::Paid),\r\n            \"CICILAN\" =\u003e Some(PaymentStatus::Installment),\r\n            _ =\u003e None,\r\n        }\r\n    }\r\n    \r\n    pub fn to_string(\u0026self) -\u003e String {\r\n        match self {\r\n            PaymentStatus::Paid =\u003e \"LUNAS\".to_string(),\r\n            PaymentStatus::Installment =\u003e \"CICILAN\".to_string(),\r\n        }\r\n    }\r\n}\r\n\r\n#[cfg(test)]\r\nmod tests {\r\n    use super::*;\r\n\r\n    #[test]\r\n    fn test_payment_status_from_string() {\r\n        // Valid status\r\n        let paid_status = PaymentStatus::from_string(\"LUNAS\");\r\n        assert!(paid_status.is_some());\r\n        assert_eq!(paid_status.unwrap(), PaymentStatus::Paid);\r\n\r\n        let installment_status = PaymentStatus::from_string(\"CICILAN\");\r\n        assert!(installment_status.is_some());\r\n        assert_eq!(installment_status.unwrap(), PaymentStatus::Installment);\r\n\r\n        // Case insensitive\r\n        let lowercase_status = PaymentStatus::from_string(\"lunas\");\r\n        assert!(lowercase_status.is_some());\r\n        assert_eq!(lowercase_status.unwrap(), PaymentStatus::Paid);\r\n\r\n        // Invalid status\r\n        let invalid_status = PaymentStatus::from_string(\"INVALID\");\r\n        assert!(invalid_status.is_none());\r\n    }\r\n\r\n    #[test]\r\n    fn test_payment_status_to_string() {\r\n        assert_eq!(PaymentStatus::Paid.to_string(), \"LUNAS\");\r\n        assert_eq!(PaymentStatus::Installment.to_string(), \"CICILAN\");\r\n    }\r\n}","traces":[{"line":8,"address":[],"length":0,"stats":{"Line":936748722493063168}},{"line":9,"address":[],"length":0,"stats":{"Line":936748722493063168}},{"line":10,"address":[],"length":0,"stats":{"Line":1369094286720630784}},{"line":11,"address":[],"length":0,"stats":{"Line":864691128455135232}},{"line":12,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":16,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":17,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":18,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":19,"address":[],"length":0,"stats":{"Line":144115188075855872}}],"covered":9,"coverable":9},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pembayaran","mod.rs"],"content":"pub mod model;\r\npub mod repository;\r\npub mod patterns;\r\npub mod enums;\r\npub mod service;\r\npub mod controller;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pembayaran","model","mod.rs"],"content":"pub mod payment;\r\n","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pembayaran","model","payment.rs"],"content":"use chrono::{DateTime, Utc};\r\nuse crate::manajemen_pembayaran::enums::payment_status::PaymentStatus;\r\n\r\n#[derive(Debug, Clone, PartialEq)]\r\npub enum PaymentMethod {\r\n    Cash,\r\n    CreditCard,\r\n    BankTransfer,\r\n    EWallet,\r\n}\r\n\r\n#[derive(Debug, Clone)]\r\npub struct Payment {\r\n    pub id: String,\r\n    pub transaction_id: String,\r\n    pub amount: f64,\r\n    pub method: PaymentMethod,\r\n    pub status: PaymentStatus,\r\n    pub payment_date: DateTime\u003cUtc\u003e,\r\n    pub installments: Vec\u003cInstallment\u003e,\r\n    pub due_date: Option\u003cDateTime\u003cUtc\u003e\u003e,\r\n}\r\n\r\n#[derive(Debug, Clone)]\r\npub struct Installment {\r\n    pub id: String,\r\n    pub payment_id: String,\r\n    pub amount: f64,\r\n    pub payment_date: DateTime\u003cUtc\u003e,\r\n}\r\n\r\n#[cfg(test)]\r\nmod tests {\r\n    use super::*;\r\n    use chrono::Utc;\r\n    use uuid::Uuid;\r\n\r\n    #[test]\r\n    fn test_payment_status_from_string() {\r\n        let paid_status = PaymentStatus::from_string(\"LUNAS\");\r\n        assert!(paid_status.is_some());\r\n        assert_eq!(paid_status.unwrap(), PaymentStatus::Paid);\r\n\r\n        let installment_status = PaymentStatus::from_string(\"CICILAN\");\r\n        assert!(installment_status.is_some());\r\n        assert_eq!(installment_status.unwrap(), PaymentStatus::Installment);\r\n\r\n        let lowercase_status = PaymentStatus::from_string(\"lunas\");\r\n        assert!(lowercase_status.is_some());\r\n        assert_eq!(lowercase_status.unwrap(), PaymentStatus::Paid);\r\n\r\n        let invalid_status = PaymentStatus::from_string(\"INVALID\");\r\n        assert!(invalid_status.is_none());\r\n    }\r\n\r\n    #[test]\r\n    fn test_payment_status_to_string() {\r\n        assert_eq!(PaymentStatus::Paid.to_string(), \"LUNAS\");\r\n        assert_eq!(PaymentStatus::Installment.to_string(), \"CICILAN\");\r\n    }\r\n\r\n\r\n    #[test]\r\n    fn test_create_payment() {\r\n        let payment_id = format!(\"PMT-{}\", Uuid::new_v4());\r\n        let transaction_id = format!(\"TRX-{}\", Uuid::new_v4());\r\n        \r\n        let payment = Payment {\r\n            id: payment_id.clone(),\r\n            transaction_id: transaction_id.clone(),\r\n            amount: 1000.0,\r\n            method: PaymentMethod::Cash,\r\n            status: PaymentStatus::Paid,\r\n            payment_date: Utc::now(),\r\n            installments: Vec::new(),\r\n            due_date: None,\r\n        };\r\n        \r\n        assert_eq!(payment.id, payment_id);\r\n        assert_eq!(payment.transaction_id, transaction_id);\r\n        assert_eq!(payment.amount, 1000.0);\r\n        assert_eq!(payment.method, PaymentMethod::Cash);\r\n        assert_eq!(payment.status, PaymentStatus::Paid);\r\n        assert!(payment.installments.is_empty());\r\n    }\r\n\r\n    #[test]\r\n    fn test_add_installment() {\r\n        let payment_id = format!(\"PMT-{}\", Uuid::new_v4());\r\n        \r\n        let mut payment = Payment {\r\n            id: payment_id.clone(),\r\n            transaction_id: format!(\"TRX-{}\", Uuid::new_v4()),\r\n            amount: 1000.0,\r\n            method: PaymentMethod::Cash,\r\n            status: PaymentStatus::Installment,\r\n            payment_date: Utc::now(),\r\n            installments: Vec::new(),\r\n            due_date: None,\r\n        };\r\n        \r\n        let installment = Installment {\r\n            id: format!(\"INST-{}\", Uuid::new_v4()),\r\n            payment_id: payment_id.clone(),\r\n            amount: 500.0,\r\n            payment_date: Utc::now(),\r\n        };\r\n        \r\n        payment.installments.push(installment);\r\n        \r\n        assert_eq!(payment.installments.len(), 1);\r\n        assert_eq!(payment.installments[0].amount, 500.0);\r\n    }\r\n}","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pembayaran","patterns","command.rs"],"content":"use std::sync::Arc;\r\nuse chrono::Utc;\r\nuse uuid::Uuid;\r\n\r\nuse crate::manajemen_pembayaran::model::payment::{Payment, PaymentMethod, Installment};\r\nuse crate::manajemen_pembayaran::enums::payment_status::PaymentStatus;\r\nuse crate::manajemen_pembayaran::repository::payment_repository::PaymentRepository;\r\nuse crate::manajemen_pembayaran::patterns::observer::PaymentSubject;\r\nuse crate::manajemen_pembayaran::patterns::factory::{PaymentProcessorFactory, PaymentStateFactory};\r\n\r\npub trait PaymentCommand {\r\n    fn execute(\u0026self) -\u003e Result\u003cPayment, String\u003e;\r\n}\r\n\r\npub struct CreatePaymentCommand {\r\n    transaction_id: String,\r\n    amount: f64,\r\n    method: PaymentMethod,\r\n    repository: Arc\u003cdyn PaymentRepository\u003e,\r\n    subject: Arc\u003cPaymentSubject\u003e,\r\n}\r\n\r\nimpl CreatePaymentCommand {\r\n    pub fn new(\r\n        transaction_id: String,\r\n        amount: f64,\r\n        method: PaymentMethod,\r\n        repository: Arc\u003cdyn PaymentRepository\u003e,\r\n        subject: Arc\u003cPaymentSubject\u003e,\r\n    ) -\u003e Self {\r\n        Self {\r\n            transaction_id,\r\n            amount,\r\n            method,\r\n            repository,\r\n            subject,\r\n        }\r\n    }\r\n}\r\n\r\nimpl PaymentCommand for CreatePaymentCommand {\r\n    fn execute(\u0026self) -\u003e Result\u003cPayment, String\u003e {\r\n        if self.repository.find_by_transaction_id(\u0026self.transaction_id).is_some() {\r\n            return Err(format!(\"Transaksi {} sudah memiliki pembayaran\", self.transaction_id));\r\n        }\r\n\r\n        let processor = PaymentProcessorFactory::create(self.method.clone());\r\n        let payment_id = processor.process(self.amount, \u0026self.transaction_id)?;\r\n\r\n        let payment = Payment {\r\n            id: payment_id,\r\n            transaction_id: self.transaction_id.clone(),\r\n            amount: self.amount,\r\n            method: processor.get_method(),\r\n            status: PaymentStatus::Paid,\r\n            payment_date: Utc::now(),\r\n            installments: Vec::new(),\r\n            due_date: None,\r\n        };\r\n\r\n        let saved_payment = self.repository.save(payment)?;\r\n        \r\n        self.subject.notify(\u0026saved_payment);\r\n        \r\n        Ok(saved_payment)\r\n    }\r\n}\r\n\r\npub struct UpdatePaymentStatusCommand {\r\n    payment_id: String,\r\n    new_status: PaymentStatus,\r\n    additional_amount: Option\u003cf64\u003e,\r\n    repository: Arc\u003cdyn PaymentRepository\u003e,\r\n    subject: Arc\u003cPaymentSubject\u003e,\r\n}\r\n\r\nimpl UpdatePaymentStatusCommand {\r\n    pub fn new(\r\n        payment_id: String,\r\n        new_status: PaymentStatus,\r\n        additional_amount: Option\u003cf64\u003e,\r\n        repository: Arc\u003cdyn PaymentRepository\u003e,\r\n        subject: Arc\u003cPaymentSubject\u003e,\r\n    ) -\u003e Self {\r\n        Self {\r\n            payment_id,\r\n            new_status,\r\n            additional_amount,\r\n            repository,\r\n            subject,\r\n        }\r\n    }\r\n}\r\n\r\nimpl PaymentCommand for UpdatePaymentStatusCommand {\r\n    fn execute(\u0026self) -\u003e Result\u003cPayment, String\u003e {\r\n        let mut payment = self.repository\r\n            .find_by_id(\u0026self.payment_id)\r\n            .ok_or_else(|| format!(\"Pembayaran dengan ID {} tidak ditemukan\", self.payment_id))?;\r\n\r\n        payment.status = self.new_status.clone();\r\n\r\n        if let Some(amount) = self.additional_amount {\r\n            if amount \u003c= 0.0 {\r\n                return Err(\"Jumlah cicilan harus lebih dari 0\".to_string());\r\n            }\r\n            \r\n            let installment = Installment {\r\n                id: format!(\"INST-{}\", Uuid::new_v4()),\r\n                payment_id: payment.id.clone(),\r\n                amount,\r\n                payment_date: Utc::now(),\r\n            };\r\n            payment.installments.push(installment);\r\n        }\r\n\r\n        let updated_payment = self.repository.update(payment)?;\r\n        \r\n        self.subject.notify(\u0026updated_payment);\r\n        \r\n        Ok(updated_payment)\r\n    }\r\n}\r\n\r\npub struct AddInstallmentCommand {\r\n    payment_id: String,\r\n    amount: f64,\r\n    repository: Arc\u003cdyn PaymentRepository\u003e,\r\n    subject: Arc\u003cPaymentSubject\u003e,\r\n}\r\n\r\nimpl AddInstallmentCommand {\r\n    pub fn new(\r\n        payment_id: String,\r\n        amount: f64,\r\n        repository: Arc\u003cdyn PaymentRepository\u003e,\r\n        subject: Arc\u003cPaymentSubject\u003e,\r\n    ) -\u003e Self {\r\n        Self {\r\n            payment_id,\r\n            amount,\r\n            repository,\r\n            subject,\r\n        }\r\n    }\r\n}\r\n\r\nimpl PaymentCommand for AddInstallmentCommand {\r\n    fn execute(\u0026self) -\u003e Result\u003cPayment, String\u003e {\r\n        let mut payment = self.repository\r\n            .find_by_id(\u0026self.payment_id)\r\n            .ok_or_else(|| format!(\"Pembayaran dengan ID {} tidak ditemukan\", self.payment_id))?;\r\n\r\n        let state = PaymentStateFactory::create(\u0026payment.status);\r\n        state.process_payment(\u0026mut payment, self.amount)?;\r\n\r\n        let updated_payment = self.repository.update(payment)?;\r\n        self.subject.notify(\u0026updated_payment);\r\n        \r\n        Ok(updated_payment)\r\n    }\r\n}\r\n\r\npub struct DeletePaymentCommand {\r\n    payment_id: String,\r\n    repository: Arc\u003cdyn PaymentRepository\u003e,\r\n}\r\n\r\nimpl DeletePaymentCommand {\r\n    pub fn new(payment_id: String, repository: Arc\u003cdyn PaymentRepository\u003e) -\u003e Self {\r\n        Self {\r\n            payment_id,\r\n            repository,\r\n        }\r\n    }\r\n}\r\n\r\nimpl DeletePaymentCommand {\r\n    pub fn execute(\u0026self) -\u003e Result\u003c(), String\u003e {\r\n        let payment = self.repository.find_by_id(\u0026self.payment_id)\r\n            .ok_or_else(|| format!(\"Pembayaran dengan ID {} tidak ditemukan\", self.payment_id))?;\r\n            \r\n        let state = PaymentStateFactory::create(\u0026payment.status);\r\n        if !state.can_delete() {\r\n            return Err(format!(\"Tidak dapat menghapus pembayaran dengan status {}\", state.get_name()));\r\n        }\r\n        \r\n        self.repository.delete(\u0026self.payment_id)\r\n    }\r\n}","traces":[{"line":24,"address":[],"length":0,"stats":{"Line":1224979098644774912}},{"line":42,"address":[],"length":0,"stats":{"Line":1224979098644774912}},{"line":43,"address":[],"length":0,"stats":{"Line":1224979098644774912}},{"line":44,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":47,"address":[],"length":0,"stats":{"Line":1152921504606846976}},{"line":48,"address":[],"length":0,"stats":{"Line":1152921504606846976}},{"line":61,"address":[],"length":0,"stats":{"Line":1152921504606846976}},{"line":78,"address":[],"length":0,"stats":{"Line":504403158265495552}},{"line":96,"address":[],"length":0,"stats":{"Line":504403158265495552}},{"line":97,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":98,"address":[],"length":0,"stats":{"Line":504403158265495552}},{"line":99,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":103,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":105,"address":[],"length":0,"stats":{"Line":0}},{"line":109,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":110,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":112,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":114,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":117,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":133,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":149,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":150,"address":[],"length":0,"stats":{"Line":576460752303423488}},{"line":151,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":152,"address":[],"length":0,"stats":{"Line":576460752303423488}},{"line":155,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":157,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":170,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":179,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":180,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":181,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":185,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":188,"address":[],"length":0,"stats":{"Line":144115188075855872}}],"covered":31,"coverable":32},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pembayaran","patterns","factory.rs"],"content":"use crate::manajemen_pembayaran::model::payment::PaymentMethod;\r\nuse crate::manajemen_pembayaran::enums::payment_status::PaymentStatus;\r\nuse crate::manajemen_pembayaran::patterns::strategy::{PaymentProcessor, CashPaymentProcessor, CreditCardPaymentProcessor, BankTransferPaymentProcessor, EWalletPaymentProcessor};\r\nuse crate::manajemen_pembayaran::patterns::state::{PaymentState, PaidState, InstallmentState};\r\n\r\npub struct PaymentProcessorFactory;\r\nimpl PaymentProcessorFactory {\r\n    pub fn create(method: PaymentMethod) -\u003e Box\u003cdyn PaymentProcessor\u003e {\r\n        match method {\r\n            PaymentMethod::Cash =\u003e Box::new(CashPaymentProcessor),\r\n            PaymentMethod::CreditCard =\u003e Box::new(CreditCardPaymentProcessor),\r\n            PaymentMethod::BankTransfer =\u003e Box::new(BankTransferPaymentProcessor),\r\n            PaymentMethod::EWallet =\u003e Box::new(EWalletPaymentProcessor),\r\n        }\r\n    }\r\n}\r\n\r\npub struct PaymentStateFactory;\r\nimpl PaymentStateFactory {\r\n    pub fn create(status: \u0026PaymentStatus) -\u003e Box\u003cdyn PaymentState\u003e {\r\n        match status {\r\n            PaymentStatus::Paid =\u003e Box::new(PaidState),\r\n            PaymentStatus::Installment =\u003e Box::new(InstallmentState),\r\n        }\r\n    }\r\n}\r\n\r\n#[cfg(test)]\r\nmod tests {\r\n    use super::*;\r\n    use uuid::Uuid;\r\n\r\n    #[test]\r\n    fn test_payment_processor_factory() {\r\n        let transaction_id = format!(\"TRX-{}\", Uuid::new_v4());\r\n        \r\n        for method in [\r\n            PaymentMethod::Cash,\r\n            PaymentMethod::CreditCard,\r\n            PaymentMethod::BankTransfer,\r\n            PaymentMethod::EWallet,\r\n        ] {\r\n            let processor = PaymentProcessorFactory::create(method.clone());\r\n            \r\n            assert_eq!(processor.get_method(), method);\r\n            \r\n            let result = processor.process(1000.0, \u0026transaction_id);\r\n            assert!(result.is_ok());\r\n            \r\n            let invalid_result = processor.process(-100.0, \u0026transaction_id);\r\n            assert!(invalid_result.is_err());\r\n        }\r\n    }\r\n}","traces":[{"line":8,"address":[],"length":0,"stats":{"Line":1441151880758558720}},{"line":9,"address":[],"length":0,"stats":{"Line":1441151880758558720}},{"line":10,"address":[],"length":0,"stats":{"Line":1080863910568919040}},{"line":11,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":12,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":13,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":20,"address":[],"length":0,"stats":{"Line":504403158265495552}},{"line":21,"address":[],"length":0,"stats":{"Line":504403158265495552}},{"line":22,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":23,"address":[],"length":0,"stats":{"Line":360287970189639680}}],"covered":10,"coverable":10},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pembayaran","patterns","mod.rs"],"content":"pub mod strategy;\r\npub mod observer;\r\npub mod state;\r\npub mod factory;\r\npub mod command;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pembayaran","patterns","observer.rs"],"content":"use std::sync::Arc;\r\nuse crate::manajemen_pembayaran::model::payment::Payment;\r\n\r\npub trait PaymentObserver: Send + Sync {\r\n    fn payment_updated(\u0026self, payment: \u0026Payment);\r\n}\r\n\r\npub struct TransactionObserver;\r\nimpl PaymentObserver for TransactionObserver {\r\n    fn payment_updated(\u0026self, payment: \u0026Payment) {\r\n        println!(\"Observer: Memperbarui status transaksi untuk ID {}\", payment.transaction_id);\r\n    }\r\n}\r\n\r\npub struct InventoryObserver;\r\nimpl PaymentObserver for InventoryObserver {\r\n    fn payment_updated(\u0026self, payment: \u0026Payment) {\r\n        println!(\"Observer: Memperbarui stok untuk transaksi ID {}\", payment.transaction_id);\r\n    }\r\n}\r\n\r\npub struct CustomerObserver;\r\nimpl PaymentObserver for CustomerObserver {\r\n    fn payment_updated(\u0026self, payment: \u0026Payment) {\r\n        println!(\"Observer: Memperbarui riwayat pelanggan untuk transaksi ID {}\", payment.transaction_id);\r\n    }\r\n}\r\n\r\npub struct PaymentSubject {\r\n    observers: Vec\u003cArc\u003cdyn PaymentObserver\u003e\u003e,\r\n}\r\n\r\nimpl PaymentSubject {\r\n    pub fn new() -\u003e Self {\r\n        Self {\r\n            observers: Vec::new(),\r\n        }\r\n    }\r\n\r\n    pub fn attach(\u0026mut self, observer: Arc\u003cdyn PaymentObserver\u003e) {\r\n        self.observers.push(observer);\r\n    }\r\n\r\n    pub fn notify(\u0026self, payment: \u0026Payment) {\r\n        for observer in \u0026self.observers {\r\n            observer.payment_updated(payment);\r\n        }\r\n    }\r\n}\r\n\r\n#[cfg(test)]\r\nmod tests {\r\n    use super::*;\r\n    use std::sync::{Arc, Mutex};\r\n    use chrono::Utc;\r\n    use uuid::Uuid;\r\n    use crate::manajemen_pembayaran::model::payment::{Payment, PaymentMethod};\r\n    use crate::manajemen_pembayaran::enums::payment_status::PaymentStatus;\r\n\r\n    struct MockObserver {\r\n        notification_count: Mutex\u003cusize\u003e,\r\n        last_payment_id: Mutex\u003cOption\u003cString\u003e\u003e,\r\n    }\r\n\r\n    impl MockObserver {\r\n        fn new() -\u003e Self {\r\n            Self {\r\n                notification_count: Mutex::new(0),\r\n                last_payment_id: Mutex::new(None),\r\n            }\r\n        }\r\n        \r\n        fn get_notification_count(\u0026self) -\u003e usize {\r\n            *self.notification_count.lock().unwrap()\r\n        }\r\n        \r\n        fn get_last_payment_id(\u0026self) -\u003e Option\u003cString\u003e {\r\n            self.last_payment_id.lock().unwrap().clone()\r\n        }\r\n    }\r\n\r\n    impl PaymentObserver for MockObserver {\r\n        fn payment_updated(\u0026self, payment: \u0026Payment) {\r\n            let mut count = self.notification_count.lock().unwrap();\r\n            *count += 1;\r\n            \r\n            let mut last_id = self.last_payment_id.lock().unwrap();\r\n            *last_id = Some(payment.id.clone());\r\n        }\r\n    }\r\n\r\n    #[test]\r\n    fn test_observer_notification() {\r\n        let mut subject = PaymentSubject::new();\r\n        let observer = Arc::new(MockObserver::new());\r\n        \r\n        subject.attach(observer.clone() as Arc\u003cdyn PaymentObserver\u003e);\r\n        \r\n        let payment = Payment {\r\n            id: format!(\"PMT-{}\", Uuid::new_v4()),\r\n            transaction_id: format!(\"TRX-{}\", Uuid::new_v4()),\r\n            amount: 1000.0,\r\n            method: PaymentMethod::Cash,\r\n            status: PaymentStatus::Paid,\r\n            payment_date: Utc::now(),\r\n            installments: Vec::new(),\r\n            due_date: None,\r\n        };\r\n        \r\n        subject.notify(\u0026payment);\r\n        \r\n        assert_eq!(observer.get_notification_count(), 1);\r\n        assert_eq!(observer.get_last_payment_id(), Some(payment.id.clone()));\r\n    }\r\n\r\n    #[test]\r\n    fn test_multiple_observers() {\r\n        let mut subject = PaymentSubject::new();\r\n        let observer1 = Arc::new(MockObserver::new());\r\n        let observer2 = Arc::new(MockObserver::new());\r\n        \r\n        subject.attach(observer1.clone() as Arc\u003cdyn PaymentObserver\u003e);\r\n        subject.attach(observer2.clone() as Arc\u003cdyn PaymentObserver\u003e);\r\n        \r\n        let payment = Payment {\r\n            id: format!(\"PMT-{}\", Uuid::new_v4()),\r\n            transaction_id: format!(\"TRX-{}\", Uuid::new_v4()),\r\n            amount: 1000.0,\r\n            method: PaymentMethod::Cash,\r\n            status: PaymentStatus::Paid,\r\n            payment_date: Utc::now(),\r\n            installments: Vec::new(),\r\n            due_date: None,\r\n        };\r\n        \r\n        subject.notify(\u0026payment);\r\n        \r\n        assert_eq!(observer1.get_notification_count(), 1);\r\n        assert_eq!(observer2.get_notification_count(), 1);\r\n    }\r\n\r\n    #[test]\r\n    fn test_concrete_observers() {\r\n        let mut subject = PaymentSubject::new();\r\n        \r\n        let transaction_observer = Arc::new(TransactionObserver);\r\n        let inventory_observer = Arc::new(InventoryObserver);\r\n        let customer_observer = Arc::new(CustomerObserver);\r\n        \r\n        subject.attach(transaction_observer as Arc\u003cdyn PaymentObserver\u003e);\r\n        subject.attach(inventory_observer as Arc\u003cdyn PaymentObserver\u003e);\r\n        subject.attach(customer_observer as Arc\u003cdyn PaymentObserver\u003e);\r\n        \r\n        let payment = Payment {\r\n            id: format!(\"PMT-{}\", Uuid::new_v4()),\r\n            transaction_id: format!(\"TRX-{}\", Uuid::new_v4()),\r\n            amount: 1000.0,\r\n            method: PaymentMethod::Cash,\r\n            status: PaymentStatus::Paid,\r\n            payment_date: Utc::now(),\r\n            installments: Vec::new(),\r\n            due_date: None,\r\n        };\r\n        \r\n        subject.notify(\u0026payment);\r\n        \r\n        assert!(true);\r\n    }\r\n}\r\n","traces":[{"line":10,"address":[],"length":0,"stats":{"Line":1945555039024054272}},{"line":11,"address":[],"length":0,"stats":{"Line":1945555039024054272}},{"line":17,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":18,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":24,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":25,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":34,"address":[],"length":0,"stats":{"Line":1297036692682702848}},{"line":36,"address":[],"length":0,"stats":{"Line":1297036692682702848}},{"line":40,"address":[],"length":0,"stats":{"Line":1513209474796486656}},{"line":41,"address":[],"length":0,"stats":{"Line":1513209474796486656}},{"line":44,"address":[],"length":0,"stats":{"Line":2089670227099910144}},{"line":45,"address":[],"length":0,"stats":{"Line":9007199254740992000}},{"line":46,"address":[],"length":0,"stats":{"Line":2305843009213693952}}],"covered":13,"coverable":13},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pembayaran","patterns","state.rs"],"content":"use uuid::Uuid;\r\nuse chrono::Utc;\r\n\r\nuse crate::manajemen_pembayaran::model::payment::{Payment, Installment};\r\nuse crate::manajemen_pembayaran::enums::payment_status::PaymentStatus;\r\n\r\npub trait PaymentState: Send + Sync {\r\n    fn process_payment(\u0026self, payment: \u0026mut Payment, amount: f64) -\u003e Result\u003c(), String\u003e;\r\n    fn can_delete(\u0026self) -\u003e bool;\r\n    fn get_name(\u0026self) -\u003e String;\r\n}\r\n\r\npub struct PaidState;\r\nimpl PaymentState for PaidState {\r\n    fn process_payment(\u0026self, _payment: \u0026mut Payment, _amount: f64) -\u003e Result\u003c(), String\u003e {\r\n        Err(\"Pembayaran sudah lunas, tidak dapat menambahkan pembayaran lagi\".to_string())\r\n    }\r\n    \r\n    fn can_delete(\u0026self) -\u003e bool {\r\n        false\r\n    }\r\n\r\n    fn get_name(\u0026self) -\u003e String {\r\n        \"LUNAS\".to_string()\r\n    }\r\n}\r\n\r\npub struct InstallmentState;\r\nimpl PaymentState for InstallmentState {\r\n    fn process_payment(\u0026self, payment: \u0026mut Payment, amount: f64) -\u003e Result\u003c(), String\u003e {\r\n        if amount \u003c= 0.0 {\r\n            return Err(\"Jumlah cicilan harus lebih dari 0\".to_string());\r\n        }\r\n        \r\n        let installment = Installment {\r\n            id: format!(\"INST-{}\", Uuid::new_v4()),\r\n            payment_id: payment.id.clone(),\r\n            amount,\r\n            payment_date: Utc::now(),\r\n        };\r\n        payment.installments.push(installment);\r\n\r\n        let total_paid: f64 = payment.installments.iter().map(|i| i.amount).sum();\r\n        if total_paid \u003e= payment.amount {\r\n            payment.status = PaymentStatus::Paid;\r\n        }\r\n\r\n        Ok(())\r\n    }\r\n    \r\n    fn can_delete(\u0026self) -\u003e bool {\r\n        true\r\n    }\r\n\r\n    fn get_name(\u0026self) -\u003e String {\r\n        \"CICILAN\".to_string()\r\n    }\r\n}\r\n\r\n#[cfg(test)]\r\nmod tests {\r\n    use super::*;\r\n    use chrono::Utc;\r\n    use uuid::Uuid;\r\n    use crate::manajemen_pembayaran::model::payment::{Payment, PaymentMethod};\r\n\r\n    #[test]\r\n    fn test_paid_state_process_payment() {\r\n        let state = PaidState;\r\n        let mut payment = Payment {\r\n            id: format!(\"PMT-{}\", Uuid::new_v4()),\r\n            transaction_id: format!(\"TRX-{}\", Uuid::new_v4()),\r\n            amount: 1000.0,\r\n            method: PaymentMethod::Cash,\r\n            status: PaymentStatus::Paid,\r\n            payment_date: Utc::now(),\r\n            installments: Vec::new(),\r\n            due_date: None,\r\n        };\r\n        \r\n        let result = state.process_payment(\u0026mut payment, 500.0);\r\n        \r\n        assert!(result.is_err());\r\n        assert_eq!(payment.installments.len(), 0);\r\n    }\r\n\r\n    #[test]\r\n    fn test_installment_state_process_payment() {\r\n        let state = InstallmentState;\r\n        let mut payment = Payment {\r\n            id: format!(\"PMT-{}\", Uuid::new_v4()),\r\n            transaction_id: format!(\"TRX-{}\", Uuid::new_v4()),\r\n            amount: 1000.0,\r\n            method: PaymentMethod::Cash,\r\n            status: PaymentStatus::Installment,\r\n            payment_date: Utc::now(),\r\n            installments: Vec::new(),\r\n            due_date: None,\r\n        };\r\n        \r\n        let result = state.process_payment(\u0026mut payment, 400.0);\r\n        \r\n        assert!(result.is_ok()); \r\n        assert_eq!(payment.installments.len(), 1);\r\n        assert_eq!(payment.installments[0].amount, 400.0);\r\n        assert_eq!(payment.status, PaymentStatus::Installment);\r\n        \r\n        let result = state.process_payment(\u0026mut payment, 600.0);\r\n        \r\n        assert!(result.is_ok());\r\n        assert_eq!(payment.installments.len(), 2);\r\n        assert_eq!(payment.status, PaymentStatus::Paid);\r\n    }\r\n\r\n    #[test]\r\n    fn test_installment_state_invalid_amount() {\r\n        let state = InstallmentState;\r\n        let mut payment = Payment {\r\n            id: format!(\"PMT-{}\", Uuid::new_v4()),\r\n            transaction_id: format!(\"TRX-{}\", Uuid::new_v4()),\r\n            amount: 1000.0,\r\n            method: PaymentMethod::Cash,\r\n            status: PaymentStatus::Installment,\r\n            payment_date: Utc::now(),\r\n            installments: Vec::new(),\r\n            due_date: None,\r\n        };\r\n        \r\n        let result = state.process_payment(\u0026mut payment, -100.0);\r\n        \r\n        assert!(result.is_err());\r\n        assert_eq!(payment.installments.len(), 0);\r\n    }\r\n\r\n    #[test]\r\n    fn test_state_can_delete() {\r\n        let paid_state = PaidState;\r\n        assert!(!paid_state.can_delete());\r\n        \r\n        let installment_state = InstallmentState;\r\n        assert!(installment_state.can_delete());\r\n    }\r\n}","traces":[{"line":15,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":16,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":19,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":20,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":23,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":24,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":30,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":31,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":32,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":36,"address":[],"length":0,"stats":{"Line":360287970189639680}},{"line":37,"address":[],"length":0,"stats":{"Line":360287970189639680}},{"line":39,"address":[],"length":0,"stats":{"Line":360287970189639680}},{"line":41,"address":[],"length":0,"stats":{"Line":360287970189639680}},{"line":43,"address":[],"length":0,"stats":{"Line":864691128455135232}},{"line":44,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":45,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":51,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":52,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":55,"address":[],"length":0,"stats":{"Line":0}},{"line":56,"address":[],"length":0,"stats":{"Line":0}}],"covered":18,"coverable":20},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pembayaran","patterns","strategy.rs"],"content":"use uuid::Uuid;\r\nuse crate::manajemen_pembayaran::model::payment::PaymentMethod;\r\n\r\npub trait PaymentProcessor: Send + Sync {\r\n    fn process(\u0026self, amount: f64, transaction_id: \u0026str) -\u003e Result\u003cString, String\u003e;\r\n    fn get_method(\u0026self) -\u003e PaymentMethod;\r\n}\r\n\r\npub struct CashPaymentProcessor;\r\nimpl PaymentProcessor for CashPaymentProcessor {\r\n    fn process(\u0026self, amount: f64, transaction_id: \u0026str) -\u003e Result\u003cString, String\u003e {\r\n        println!(\"Memproses pembayaran tunai sebesar Rp{} untuk transaksi {}\", amount, transaction_id);\r\n        \r\n        if amount \u003c= 0.0 {\r\n            return Err(\"Jumlah pembayaran tunai harus lebih dari 0\".to_string());\r\n        }\r\n        Ok(format!(\"CASH-{}\", Uuid::new_v4()))\r\n    }\r\n\r\n    fn get_method(\u0026self) -\u003e PaymentMethod {\r\n        PaymentMethod::Cash\r\n    }\r\n}\r\n\r\npub struct CreditCardPaymentProcessor;\r\nimpl PaymentProcessor for CreditCardPaymentProcessor {\r\n    fn process(\u0026self, amount: f64, transaction_id: \u0026str) -\u003e Result\u003cString, String\u003e {\r\n        println!(\"Memproses pembayaran kartu kredit sebesar Rp{} untuk transaksi {}\", amount, transaction_id);\r\n        \r\n        if amount \u003c= 0.0 {\r\n            return Err(\"Jumlah pembayaran kartu kredit harus lebih dari 0\".to_string());\r\n        }\r\n        Ok(format!(\"CC-{}\", Uuid::new_v4()))\r\n    }\r\n\r\n    fn get_method(\u0026self) -\u003e PaymentMethod {\r\n        PaymentMethod::CreditCard\r\n    }\r\n}\r\n\r\npub struct BankTransferPaymentProcessor;\r\nimpl PaymentProcessor for BankTransferPaymentProcessor {\r\n    fn process(\u0026self, amount: f64, transaction_id: \u0026str) -\u003e Result\u003cString, String\u003e {\r\n        println!(\"Memproses pembayaran transfer bank sebesar Rp{} untuk transaksi {}\", amount, transaction_id);\r\n        \r\n        if amount \u003c= 0.0 {\r\n            return Err(\"Jumlah pembayaran transfer bank harus lebih dari 0\".to_string());\r\n        }\r\n        Ok(format!(\"BANK-{}\", Uuid::new_v4()))\r\n    }\r\n\r\n    fn get_method(\u0026self) -\u003e PaymentMethod {\r\n        PaymentMethod::BankTransfer\r\n    }\r\n}\r\n\r\npub struct EWalletPaymentProcessor;\r\nimpl PaymentProcessor for EWalletPaymentProcessor {\r\n    fn process(\u0026self, amount: f64, transaction_id: \u0026str) -\u003e Result\u003cString, String\u003e {\r\n        println!(\"Memproses pembayaran e-wallet sebesar Rp{} untuk transaksi {}\", amount, transaction_id);\r\n        \r\n        if amount \u003c= 0.0 {\r\n            return Err(\"Jumlah pembayaran e-wallet harus lebih dari 0\".to_string());\r\n        }\r\n        Ok(format!(\"EWALLET-{}\", Uuid::new_v4()))\r\n    }\r\n\r\n    fn get_method(\u0026self) -\u003e PaymentMethod {\r\n        PaymentMethod::EWallet\r\n    }\r\n}\r\n\r\n#[cfg(test)]\r\nmod tests {\r\n    use super::*;\r\n    use uuid::Uuid;\r\n\r\n    #[test]\r\n    fn test_cash_payment_processor() {\r\n        let processor = CashPaymentProcessor;\r\n        let transaction_id = format!(\"TRX-{}\", Uuid::new_v4());\r\n        \r\n        let result = processor.process(1000.0, \u0026transaction_id);\r\n        assert!(result.is_ok());\r\n        let payment_id = result.unwrap();\r\n        assert!(payment_id.starts_with(\"CASH-\"));\r\n        \r\n        assert_eq!(processor.get_method(), PaymentMethod::Cash);\r\n    }\r\n\r\n    #[test]\r\n    fn test_credit_card_payment_processor() {\r\n        let processor = CreditCardPaymentProcessor;\r\n        let transaction_id = format!(\"TRX-{}\", Uuid::new_v4());\r\n        \r\n        let result = processor.process(1000.0, \u0026transaction_id);\r\n        assert!(result.is_ok());\r\n        let payment_id = result.unwrap();\r\n        assert!(payment_id.starts_with(\"CC-\"));\r\n        \r\n        assert_eq!(processor.get_method(), PaymentMethod::CreditCard);\r\n    }\r\n\r\n    #[test]\r\n    fn test_bank_transfer_payment_processor() {\r\n        let processor = BankTransferPaymentProcessor;\r\n        let transaction_id = format!(\"TRX-{}\", Uuid::new_v4());\r\n        \r\n        let result = processor.process(1000.0, \u0026transaction_id);\r\n        assert!(result.is_ok());\r\n        let payment_id = result.unwrap();\r\n        assert!(payment_id.starts_with(\"BANK-\"));\r\n        \r\n        assert_eq!(processor.get_method(), PaymentMethod::BankTransfer);\r\n    }\r\n\r\n    #[test]\r\n    fn test_e_wallet_payment_processor() {\r\n        let processor = EWalletPaymentProcessor;\r\n        let transaction_id = format!(\"TRX-{}\", Uuid::new_v4());\r\n        \r\n        let result = processor.process(1000.0, \u0026transaction_id);\r\n        assert!(result.is_ok());\r\n        let payment_id = result.unwrap();\r\n        assert!(payment_id.starts_with(\"EWALLET-\"));\r\n        \r\n        assert_eq!(processor.get_method(), PaymentMethod::EWallet);\r\n    }\r\n\r\n    #[test]\r\n    fn test_invalid_amount() {\r\n        let processor = CashPaymentProcessor;\r\n        let transaction_id = format!(\"TRX-{}\", Uuid::new_v4());\r\n        \r\n        let result = processor.process(-100.0, \u0026transaction_id);\r\n        assert!(result.is_err());\r\n    }\r\n}","traces":[{"line":11,"address":[],"length":0,"stats":{"Line":1297036692682702848}},{"line":12,"address":[],"length":0,"stats":{"Line":1297036692682702848}},{"line":14,"address":[],"length":0,"stats":{"Line":1297036692682702848}},{"line":15,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":17,"address":[],"length":0,"stats":{"Line":1152921504606846976}},{"line":20,"address":[],"length":0,"stats":{"Line":1152921504606846976}},{"line":21,"address":[],"length":0,"stats":{"Line":1152921504606846976}},{"line":27,"address":[],"length":0,"stats":{"Line":360287970189639680}},{"line":28,"address":[],"length":0,"stats":{"Line":360287970189639680}},{"line":30,"address":[],"length":0,"stats":{"Line":360287970189639680}},{"line":31,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":33,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":36,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":37,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":43,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":44,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":46,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":47,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":49,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":52,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":53,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":59,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":60,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":62,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":63,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":65,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":68,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":69,"address":[],"length":0,"stats":{"Line":144115188075855872}}],"covered":28,"coverable":28},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pembayaran","repository","mod.rs"],"content":"pub mod payment_repository;\r\npub mod payment_repository_impl;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pembayaran","repository","payment_repository.rs"],"content":"use std::collections::HashMap;\r\nuse crate::manajemen_pembayaran::model::payment::Payment;\r\n\r\npub trait PaymentRepository: Send + Sync {\r\n    fn save(\u0026self, payment: Payment) -\u003e Result\u003cPayment, String\u003e;\r\n    fn find_by_id(\u0026self, id: \u0026str) -\u003e Option\u003cPayment\u003e;\r\n    fn find_by_transaction_id(\u0026self, transaction_id: \u0026str) -\u003e Option\u003cPayment\u003e;\r\n    fn find_all(\u0026self, filters: Option\u003cHashMap\u003cString, String\u003e\u003e) -\u003e Vec\u003cPayment\u003e;\r\n    fn update(\u0026self, payment: Payment) -\u003e Result\u003cPayment, String\u003e;\r\n    fn delete(\u0026self, id: \u0026str) -\u003e Result\u003c(), String\u003e;\r\n}","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pembayaran","repository","payment_repository_impl.rs"],"content":"use std::collections::HashMap;\r\nuse std::sync::{Arc, Mutex};\r\n\r\nuse crate::manajemen_pembayaran::model::payment::Payment;\r\nuse crate::manajemen_pembayaran::enums::payment_status::PaymentStatus;\r\nuse crate::manajemen_pembayaran::repository::payment_repository::PaymentRepository;\r\n\r\npub struct PaymentRepositoryImpl {\r\n    payments: Arc\u003cMutex\u003cHashMap\u003cString, Payment\u003e\u003e\u003e,\r\n}\r\n\r\nimpl PaymentRepositoryImpl {\r\n    pub fn new() -\u003e Self {\r\n        Self {\r\n            payments: Arc::new(Mutex::new(HashMap::new())),\r\n        }\r\n    }\r\n}\r\n\r\nimpl PaymentRepository for PaymentRepositoryImpl {\r\n    fn save(\u0026self, payment: Payment) -\u003e Result\u003cPayment, String\u003e {\r\n        let mut payments = self.payments.lock().unwrap();\r\n        let payment_clone = payment.clone();\r\n        payments.insert(payment.id.clone(), payment);\r\n        Ok(payment_clone)\r\n    }\r\n\r\n    fn find_by_id(\u0026self, id: \u0026str) -\u003e Option\u003cPayment\u003e {\r\n        let payments = self.payments.lock().unwrap();\r\n        payments.get(id).cloned()\r\n    }\r\n\r\n    fn find_by_transaction_id(\u0026self, transaction_id: \u0026str) -\u003e Option\u003cPayment\u003e {\r\n        let payments = self.payments.lock().unwrap();\r\n        payments\r\n            .values()\r\n            .find(|p| p.transaction_id == transaction_id)\r\n            .cloned()\r\n    }\r\n\r\n    fn find_all(\u0026self, filters: Option\u003cHashMap\u003cString, String\u003e\u003e) -\u003e Vec\u003cPayment\u003e {\r\n        let payments = self.payments.lock().unwrap();\r\n        let mut result: Vec\u003cPayment\u003e = payments.values().cloned().collect();\r\n\r\n        if let Some(filter_map) = filters {\r\n            // Filter by status\r\n            if let Some(status_str) = filter_map.get(\"status\") {\r\n                if let Some(status) = PaymentStatus::from_string(status_str) {\r\n                    result = result\r\n                        .into_iter()\r\n                        .filter(|p| p.status == status)\r\n                        .collect();\r\n                }\r\n            }\r\n            \r\n            // Filter by method\r\n            if let Some(method) = filter_map.get(\"method\") {\r\n                result = result\r\n                    .into_iter()\r\n                    .filter(|p| format!(\"{:?}\", p.method).to_uppercase() == method.to_uppercase())\r\n                    .collect();\r\n            }\r\n        }\r\n\r\n        result\r\n    }\r\n\r\n    fn update(\u0026self, payment: Payment) -\u003e Result\u003cPayment, String\u003e {\r\n        let mut payments = self.payments.lock().unwrap();\r\n        if !payments.contains_key(\u0026payment.id) {\r\n            return Err(format!(\"Pembayaran dengan ID {} tidak ditemukan\", payment.id));\r\n        }\r\n        let payment_clone = payment.clone();\r\n        payments.insert(payment.id.clone(), payment);\r\n        Ok(payment_clone)\r\n    }\r\n\r\n    fn delete(\u0026self, id: \u0026str) -\u003e Result\u003c(), String\u003e {\r\n        let mut payments = self.payments.lock().unwrap();\r\n        if payments.remove(id).is_none() {\r\n            return Err(format!(\"Pembayaran dengan ID {} tidak ditemukan\", id));\r\n        }\r\n        Ok(())\r\n    }\r\n}\r\n\r\n#[cfg(test)]\r\nmod tests {\r\n    use super::*;\r\n    use chrono::Utc;\r\n    use uuid::Uuid;\r\n    use crate::manajemen_pembayaran::model::payment::{Payment, PaymentMethod};\r\n\r\n    #[test]\r\n    fn test_save_payment() {\r\n        let repository = PaymentRepositoryImpl::new();\r\n        let payment_id = format!(\"PMT-{}\", Uuid::new_v4());\r\n        let transaction_id = format!(\"TRX-{}\", Uuid::new_v4());\r\n        \r\n        let payment = Payment {\r\n            id: payment_id.clone(),\r\n            transaction_id: transaction_id.clone(),\r\n            amount: 1000.0,\r\n            method: PaymentMethod::Cash,\r\n            status: PaymentStatus::Paid,\r\n            payment_date: Utc::now(),\r\n            installments: Vec::new(),\r\n            due_date: None,\r\n        };\r\n        \r\n        let result = repository.save(payment.clone());\r\n        \r\n        assert!(result.is_ok());\r\n        let saved_payment = result.unwrap();\r\n        assert_eq!(saved_payment.id, payment_id);\r\n        assert_eq!(saved_payment.transaction_id, transaction_id);\r\n        assert_eq!(saved_payment.amount, 1000.0);\r\n    }\r\n\r\n    #[test]\r\n    fn test_find_by_id() {\r\n        let repository = PaymentRepositoryImpl::new();\r\n        let payment_id = format!(\"PMT-{}\", Uuid::new_v4());\r\n        \r\n        let payment = Payment {\r\n            id: payment_id.clone(),\r\n            transaction_id: format!(\"TRX-{}\", Uuid::new_v4()),\r\n            amount: 1000.0,\r\n            method: PaymentMethod::Cash,\r\n            status: PaymentStatus::Paid,\r\n            payment_date: Utc::now(),\r\n            installments: Vec::new(),\r\n            due_date: None,\r\n        };\r\n        \r\n        repository.save(payment.clone()).unwrap();\r\n        \r\n        let result = repository.find_by_id(\u0026payment_id);\r\n        \r\n        assert!(result.is_some());\r\n        let found_payment = result.unwrap();\r\n        assert_eq!(found_payment.id, payment_id);\r\n    }\r\n\r\n    #[test]\r\n    fn test_find_by_transaction_id() {\r\n        let repository = PaymentRepositoryImpl::new();\r\n        let transaction_id = format!(\"TRX-{}\", Uuid::new_v4());\r\n        \r\n        let payment = Payment {\r\n            id: format!(\"PMT-{}\", Uuid::new_v4()),\r\n            transaction_id: transaction_id.clone(),\r\n            amount: 1000.0,\r\n            method: PaymentMethod::Cash,\r\n            status: PaymentStatus::Paid,\r\n            payment_date: Utc::now(),\r\n            installments: Vec::new(),\r\n            due_date: None,\r\n        };\r\n        \r\n        repository.save(payment.clone()).unwrap();\r\n        \r\n        let result = repository.find_by_transaction_id(\u0026transaction_id);\r\n        \r\n        assert!(result.is_some());\r\n        let found_payment = result.unwrap();\r\n        assert_eq!(found_payment.transaction_id, transaction_id);\r\n    }\r\n\r\n    #[test]\r\n    fn test_update_payment() {\r\n        let repository = PaymentRepositoryImpl::new();\r\n        let payment_id = format!(\"PMT-{}\", Uuid::new_v4());\r\n        \r\n        let payment = Payment {\r\n            id: payment_id.clone(),\r\n            transaction_id: format!(\"TRX-{}\", Uuid::new_v4()),\r\n            amount: 1000.0,\r\n            method: PaymentMethod::Cash,\r\n            status: PaymentStatus::Installment,\r\n            payment_date: Utc::now(),\r\n            installments: Vec::new(),\r\n            due_date: None,\r\n        };\r\n        \r\n        repository.save(payment.clone()).unwrap();\r\n        \r\n        let mut updated_payment = payment.clone();\r\n        updated_payment.status = PaymentStatus::Paid;\r\n        let result = repository.update(updated_payment);\r\n        \r\n        assert!(result.is_ok());\r\n        let found = repository.find_by_id(\u0026payment_id).unwrap();\r\n        assert_eq!(found.status, PaymentStatus::Paid);\r\n    }\r\n\r\n    #[test]\r\n    fn test_delete_payment() {\r\n        let repository = PaymentRepositoryImpl::new();\r\n        let payment_id = format!(\"PMT-{}\", Uuid::new_v4());\r\n        \r\n        let payment = Payment {\r\n            id: payment_id.clone(),\r\n            transaction_id: format!(\"TRX-{}\", Uuid::new_v4()),\r\n            amount: 1000.0,\r\n            method: PaymentMethod::Cash,\r\n            status: PaymentStatus::Paid,\r\n            payment_date: Utc::now(),\r\n            installments: Vec::new(),\r\n            due_date: None,\r\n        };\r\n        \r\n        repository.save(payment.clone()).unwrap();\r\n        \r\n        let result = repository.delete(\u0026payment_id);\r\n        \r\n        assert!(result.is_ok());\r\n        assert!(repository.find_by_id(\u0026payment_id).is_none());\r\n    }\r\n\r\n    #[test]\r\n    fn test_find_all_with_filters() {\r\n        let repository = PaymentRepositoryImpl::new();\r\n        \r\n        let cash_payment = Payment {\r\n            id: format!(\"PMT-{}\", Uuid::new_v4()),\r\n            transaction_id: format!(\"TRX-{}\", Uuid::new_v4()),\r\n            amount: 1000.0,\r\n            method: PaymentMethod::Cash,\r\n            status: PaymentStatus::Paid,\r\n            payment_date: Utc::now(),\r\n            installments: Vec::new(),\r\n            due_date: None,\r\n        };\r\n        \r\n        let credit_payment = Payment {\r\n            id: format!(\"PMT-{}\", Uuid::new_v4()),\r\n            transaction_id: format!(\"TRX-{}\", Uuid::new_v4()),\r\n            amount: 2000.0,\r\n            method: PaymentMethod::CreditCard,\r\n            status: PaymentStatus::Installment,\r\n            payment_date: Utc::now(),\r\n            installments: Vec::new(),\r\n            due_date: None,\r\n        };\r\n        \r\n        repository.save(cash_payment.clone()).unwrap();\r\n        repository.save(credit_payment.clone()).unwrap();\r\n        \r\n        let mut filters = HashMap::new();\r\n        filters.insert(\"status\".to_string(), \"LUNAS\".to_string());\r\n        let status_results = repository.find_all(Some(filters));\r\n        \r\n        assert_eq!(status_results.len(), 1);\r\n        assert_eq!(status_results[0].status, PaymentStatus::Paid);\r\n        \r\n        let all_results = repository.find_all(None);\r\n        \r\n        assert_eq!(all_results.len(), 2);\r\n    }\r\n}","traces":[{"line":13,"address":[],"length":0,"stats":{"Line":1513209474796486656}},{"line":15,"address":[],"length":0,"stats":{"Line":1513209474796486656}},{"line":21,"address":[],"length":0,"stats":{"Line":1657324662872342528}},{"line":22,"address":[],"length":0,"stats":{"Line":1657324662872342528}},{"line":23,"address":[],"length":0,"stats":{"Line":1657324662872342528}},{"line":24,"address":[],"length":0,"stats":{"Line":1657324662872342528}},{"line":25,"address":[],"length":0,"stats":{"Line":1657324662872342528}},{"line":28,"address":[],"length":0,"stats":{"Line":1585267068834414592}},{"line":29,"address":[],"length":0,"stats":{"Line":1585267068834414592}},{"line":30,"address":[],"length":0,"stats":{"Line":1585267068834414592}},{"line":33,"address":[],"length":0,"stats":{"Line":1441151880758558720}},{"line":34,"address":[],"length":0,"stats":{"Line":1441151880758558720}},{"line":35,"address":[],"length":0,"stats":{"Line":1441151880758558720}},{"line":37,"address":[],"length":0,"stats":{"Line":3314649325744685056}},{"line":41,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":42,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":43,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":45,"address":[],"length":0,"stats":{"Line":648518346341351424}},{"line":47,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":48,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":51,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":57,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":60,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":65,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":68,"address":[],"length":0,"stats":{"Line":792633534417207296}},{"line":69,"address":[],"length":0,"stats":{"Line":792633534417207296}},{"line":70,"address":[],"length":0,"stats":{"Line":792633534417207296}},{"line":71,"address":[],"length":0,"stats":{"Line":0}},{"line":73,"address":[],"length":0,"stats":{"Line":792633534417207296}},{"line":74,"address":[],"length":0,"stats":{"Line":792633534417207296}},{"line":75,"address":[],"length":0,"stats":{"Line":792633534417207296}},{"line":78,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":79,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":80,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":81,"address":[],"length":0,"stats":{"Line":0}},{"line":83,"address":[],"length":0,"stats":{"Line":216172782113783808}}],"covered":34,"coverable":36},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pembayaran","service","mod.rs"],"content":"pub mod payment_service;\r\npub mod payment_service_impl;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pembayaran","service","payment_service.rs"],"content":"use std::collections::HashMap;\r\nuse crate::manajemen_pembayaran::model::payment::{Payment, PaymentMethod};\r\nuse crate::manajemen_pembayaran::enums::payment_status::PaymentStatus;\r\n\r\npub trait PaymentService: Send + Sync {\r\n    fn create_payment(\u0026self, transaction_id: String, amount: f64, method: PaymentMethod) -\u003e Result\u003cPayment, String\u003e;\r\n    fn update_payment_status(\u0026self, payment_id: String, new_status: PaymentStatus, additional_amount: Option\u003cf64\u003e) -\u003e Result\u003cPayment, String\u003e;\r\n    fn delete_payment(\u0026self, payment_id: String) -\u003e Result\u003c(), String\u003e;\r\n    fn get_payment(\u0026self, payment_id: \u0026str) -\u003e Option\u003cPayment\u003e;\r\n    fn get_payment_by_transaction(\u0026self, transaction_id: \u0026str) -\u003e Option\u003cPayment\u003e;\r\n    fn get_all_payments(\u0026self, filters: Option\u003cHashMap\u003cString, String\u003e\u003e) -\u003e Vec\u003cPayment\u003e;\r\n    fn add_installment(\u0026self, payment_id: \u0026str, amount: f64) -\u003e Result\u003cPayment, String\u003e;\r\n}","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_pembayaran","service","payment_service_impl.rs"],"content":"use std::collections::HashMap;\r\nuse std::sync::Arc;\r\n\r\nuse crate::manajemen_pembayaran::model::payment::{Payment, PaymentMethod};\r\nuse crate::manajemen_pembayaran::enums::payment_status::PaymentStatus;\r\nuse crate::manajemen_pembayaran::repository::payment_repository::PaymentRepository;\r\nuse crate::manajemen_pembayaran::patterns::observer::PaymentSubject;\r\nuse crate::manajemen_pembayaran::patterns::command::{AddInstallmentCommand, CreatePaymentCommand, DeletePaymentCommand, PaymentCommand, UpdatePaymentStatusCommand};\r\nuse crate::manajemen_pembayaran::service::payment_service::PaymentService;\r\n\r\npub struct PaymentServiceImpl {\r\n    repository: Arc\u003cdyn PaymentRepository\u003e,\r\n    subject: Arc\u003cPaymentSubject\u003e,\r\n}\r\n\r\nimpl PaymentServiceImpl {\r\n    pub fn new(repository: Arc\u003cdyn PaymentRepository\u003e, subject: Arc\u003cPaymentSubject\u003e) -\u003e Self {\r\n        Self {\r\n            repository,\r\n            subject,\r\n        }\r\n    }\r\n}\r\n\r\nimpl PaymentService for PaymentServiceImpl {\r\n    fn create_payment(\r\n        \u0026self,\r\n        transaction_id: String,\r\n        amount: f64,\r\n        method: PaymentMethod,\r\n    ) -\u003e Result\u003cPayment, String\u003e {\r\n        let command = CreatePaymentCommand::new(\r\n            transaction_id,\r\n            amount,\r\n            method,\r\n            self.repository.clone(),\r\n            self.subject.clone(),\r\n        );\r\n        command.execute()\r\n    }\r\n\r\n    fn update_payment_status(\r\n        \u0026self,\r\n        payment_id: String,\r\n        new_status: PaymentStatus,\r\n        additional_amount: Option\u003cf64\u003e,\r\n    ) -\u003e Result\u003cPayment, String\u003e {\r\n        let command = UpdatePaymentStatusCommand::new(\r\n            payment_id,\r\n            new_status,\r\n            additional_amount,\r\n            self.repository.clone(),\r\n            self.subject.clone(),\r\n        );\r\n        command.execute()\r\n    }\r\n\r\n    fn delete_payment(\u0026self, payment_id: String) -\u003e Result\u003c(), String\u003e {\r\n        let command = DeletePaymentCommand::new(payment_id, self.repository.clone());\r\n        command.execute()\r\n    }\r\n\r\n    fn get_payment(\u0026self, payment_id: \u0026str) -\u003e Option\u003cPayment\u003e {\r\n        self.repository.find_by_id(payment_id)\r\n    }\r\n\r\n    fn get_payment_by_transaction(\u0026self, transaction_id: \u0026str) -\u003e Option\u003cPayment\u003e {\r\n        self.repository.find_by_transaction_id(transaction_id)\r\n    }\r\n\r\n    fn get_all_payments(\u0026self, filters: Option\u003cHashMap\u003cString, String\u003e\u003e) -\u003e Vec\u003cPayment\u003e {\r\n        self.repository.find_all(filters)\r\n    }\r\n\r\n    fn add_installment(\u0026self, payment_id: \u0026str, amount: f64) -\u003e Result\u003cPayment, String\u003e {\r\n        let command = AddInstallmentCommand::new(\r\n            payment_id.to_string(),\r\n            amount,\r\n            self.repository.clone(),\r\n            self.subject.clone(),\r\n        );\r\n        command.execute()\r\n    }\r\n}\r\n\r\n#[cfg(test)]\r\nmod tests {\r\n    use super::*;\r\n    use uuid::Uuid;\r\n    use std::collections::HashMap;\r\n    \r\n    use crate::manajemen_pembayaran::repository::payment_repository_impl::PaymentRepositoryImpl;\r\n    use crate::manajemen_pembayaran::patterns::observer::{PaymentSubject, TransactionObserver, PaymentObserver};\r\n\r\n    #[test]\r\n    fn test_create_payment() {\r\n        let repository = Arc::new(PaymentRepositoryImpl::new());\r\n        let mut subject = PaymentSubject::new();\r\n        let observer = Arc::new(TransactionObserver) as Arc\u003cdyn PaymentObserver\u003e;\r\n        subject.attach(observer);\r\n        let subject = Arc::new(subject);\r\n        \r\n        let service: Arc\u003cdyn PaymentService\u003e = Arc::new(PaymentServiceImpl::new(repository.clone(), subject.clone()));\r\n        \r\n        let transaction_id = format!(\"TRX-{}\", Uuid::new_v4());\r\n        \r\n        let result = service.create_payment(transaction_id.clone(), 1000.0, PaymentMethod::Cash);\r\n        \r\n        assert!(result.is_ok());\r\n        let payment = result.unwrap();\r\n        assert_eq!(payment.transaction_id, transaction_id);\r\n        assert_eq!(payment.amount, 1000.0);\r\n        assert_eq!(payment.method, PaymentMethod::Cash);\r\n        assert_eq!(payment.status, PaymentStatus::Paid);\r\n    }\r\n\r\n    #[test]\r\n    fn test_create_payment_with_existing_transaction() {\r\n        let repository = Arc::new(PaymentRepositoryImpl::new());\r\n        let mut subject = PaymentSubject::new();\r\n        let observer = Arc::new(TransactionObserver) as Arc\u003cdyn PaymentObserver\u003e;\r\n        subject.attach(observer);\r\n        let subject = Arc::new(subject);\r\n        \r\n        let service: Arc\u003cdyn PaymentService\u003e = Arc::new(PaymentServiceImpl::new(repository.clone(), subject.clone()));\r\n        \r\n        let transaction_id = format!(\"TRX-{}\", Uuid::new_v4());\r\n        \r\n        service.create_payment(transaction_id.clone(), 1000.0, PaymentMethod::Cash).unwrap();\r\n        \r\n        let result = service.create_payment(transaction_id.clone(), 2000.0, PaymentMethod::CreditCard);\r\n        \r\n        assert!(result.is_err());\r\n    }\r\n\r\n    #[test]\r\n    fn test_update_payment_status() {\r\n        let repository = Arc::new(PaymentRepositoryImpl::new());\r\n        let mut subject = PaymentSubject::new();\r\n        let observer = Arc::new(TransactionObserver) as Arc\u003cdyn PaymentObserver\u003e;\r\n        subject.attach(observer);\r\n        let subject = Arc::new(subject);\r\n        \r\n        let service: Arc\u003cdyn PaymentService\u003e = Arc::new(PaymentServiceImpl::new(repository.clone(), subject.clone()));\r\n        \r\n        let transaction_id = format!(\"TRX-{}\", Uuid::new_v4());\r\n        let payment = service.create_payment(transaction_id.clone(), 1000.0, PaymentMethod::Cash).unwrap();\r\n        \r\n        let result = service.update_payment_status(\r\n            payment.id.clone(),\r\n            PaymentStatus::Installment,\r\n            Some(500.0)\r\n        );\r\n        \r\n        assert!(result.is_ok());\r\n        let updated_payment = result.unwrap();\r\n        assert_eq!(updated_payment.status, PaymentStatus::Installment);\r\n        assert_eq!(updated_payment.installments.len(), 1);\r\n        assert_eq!(updated_payment.installments[0].amount, 500.0);\r\n    }\r\n\r\n    #[test]\r\n    fn test_add_installment() {\r\n        let repository = Arc::new(PaymentRepositoryImpl::new());\r\n        let mut subject = PaymentSubject::new();\r\n        let observer = Arc::new(TransactionObserver) as Arc\u003cdyn PaymentObserver\u003e;\r\n        subject.attach(observer);\r\n        let subject = Arc::new(subject);\r\n        \r\n        let service: Arc\u003cdyn PaymentService\u003e = Arc::new(PaymentServiceImpl::new(repository.clone(), subject.clone()));\r\n        \r\n        let transaction_id = format!(\"TRX-{}\", Uuid::new_v4());\r\n        let payment = service.create_payment(transaction_id.clone(), 1000.0, PaymentMethod::Cash).unwrap();\r\n        \r\n        let payment = service.update_payment_status(\r\n            payment.id.clone(),\r\n            PaymentStatus::Installment,\r\n            None\r\n        ).unwrap();\r\n        \r\n        let result = service.add_installment(\u0026payment.id, 400.0);\r\n        \r\n        assert!(result.is_ok());\r\n        let payment_with_installment = result.unwrap();\r\n        assert_eq!(payment_with_installment.installments.len(), 1);\r\n        \r\n        let result = service.add_installment(\u0026payment.id, 600.0);\r\n        \r\n        assert!(result.is_ok());\r\n        let completed_payment = result.unwrap();\r\n        assert_eq!(completed_payment.installments.len(), 2);\r\n        assert_eq!(completed_payment.status, PaymentStatus::Paid);\r\n        \r\n        let result = service.add_installment(\u0026payment.id, 100.0);\r\n        \r\n        assert!(result.is_err());\r\n    }\r\n\r\n    #[test]\r\n    fn test_get_payment() {\r\n        let repository = Arc::new(PaymentRepositoryImpl::new());\r\n        let mut subject = PaymentSubject::new();\r\n        let observer = Arc::new(TransactionObserver) as Arc\u003cdyn PaymentObserver\u003e;\r\n        subject.attach(observer);\r\n        let subject = Arc::new(subject);\r\n        \r\n        let service: Arc\u003cdyn PaymentService\u003e = Arc::new(PaymentServiceImpl::new(repository.clone(), subject.clone()));\r\n        \r\n        let transaction_id = format!(\"TRX-{}\", Uuid::new_v4());\r\n        let payment = service.create_payment(transaction_id.clone(), 1000.0, PaymentMethod::Cash).unwrap();\r\n        \r\n        let result = service.get_payment(\u0026payment.id);\r\n        \r\n        assert!(result.is_some());\r\n        let found_payment = result.unwrap();\r\n        assert_eq!(found_payment.id, payment.id);\r\n        \r\n        let result = service.get_payment_by_transaction(\u0026transaction_id);\r\n        \r\n        assert!(result.is_some());\r\n        let found_payment = result.unwrap();\r\n        assert_eq!(found_payment.transaction_id, transaction_id);\r\n    }\r\n\r\n    #[test]\r\n    fn test_get_all_payments() {\r\n        let repository = Arc::new(PaymentRepositoryImpl::new());\r\n        let mut subject = PaymentSubject::new();\r\n        let observer = Arc::new(TransactionObserver) as Arc\u003cdyn PaymentObserver\u003e;\r\n        subject.attach(observer);\r\n        let subject = Arc::new(subject);\r\n        \r\n        let service: Arc\u003cdyn PaymentService\u003e = Arc::new(PaymentServiceImpl::new(repository.clone(), subject.clone()));\r\n        \r\n        service.create_payment(format!(\"TRX-1-{}\", Uuid::new_v4()), 1000.0, PaymentMethod::Cash).unwrap();\r\n        \r\n        let p2 = service.create_payment(format!(\"TRX-2-{}\", Uuid::new_v4()), 2000.0, PaymentMethod::CreditCard).unwrap();\r\n        service.update_payment_status(p2.id, PaymentStatus::Installment, None).unwrap();\r\n        \r\n        let all_payments = service.get_all_payments(None);\r\n        \r\n        assert_eq!(all_payments.len(), 2);\r\n        \r\n        let mut filters = HashMap::new();\r\n        filters.insert(\"status\".to_string(), \"LUNAS\".to_string());\r\n        let paid_payments = service.get_all_payments(Some(filters));\r\n        \r\n        assert_eq!(paid_payments.len(), 1);\r\n        assert_eq!(paid_payments[0].status, PaymentStatus::Paid);\r\n    }\r\n\r\n    #[test]\r\n    fn test_delete_payment() {\r\n        let repository = Arc::new(PaymentRepositoryImpl::new());\r\n        let mut subject = PaymentSubject::new();\r\n        let observer = Arc::new(TransactionObserver) as Arc\u003cdyn PaymentObserver\u003e;\r\n        subject.attach(observer);\r\n        let subject = Arc::new(subject);\r\n        \r\n        let service: Arc\u003cdyn PaymentService\u003e = Arc::new(PaymentServiceImpl::new(repository.clone(), subject.clone()));\r\n        \r\n        let transaction_id = format!(\"TRX-{}\", Uuid::new_v4());\r\n        let payment = service.create_payment(transaction_id.clone(), 1000.0, PaymentMethod::Cash).unwrap();\r\n        let payment = service.update_payment_status(payment.id.clone(), PaymentStatus::Installment, None).unwrap();\r\n        \r\n        let result = service.delete_payment(payment.id.clone());\r\n        \r\n        assert!(result.is_ok());\r\n        assert!(service.get_payment(\u0026payment.id).is_none());\r\n    }\r\n\r\n    #[test]\r\n    fn test_delete_paid_payment() {\r\n        let repository = Arc::new(PaymentRepositoryImpl::new());\r\n        let mut subject = PaymentSubject::new();\r\n        let observer = Arc::new(TransactionObserver) as Arc\u003cdyn PaymentObserver\u003e;\r\n        subject.attach(observer);\r\n        let subject = Arc::new(subject);\r\n        \r\n        let service: Arc\u003cdyn PaymentService\u003e = Arc::new(PaymentServiceImpl::new(repository.clone(), subject.clone()));\r\n        \r\n        let transaction_id = format!(\"TRX-{}\", Uuid::new_v4());\r\n        let payment = service.create_payment(transaction_id.clone(), 1000.0, PaymentMethod::Cash).unwrap();\r\n        \r\n        let result = service.delete_payment(payment.id.clone());\r\n        \r\n        assert!(result.is_err());\r\n        assert!(service.get_payment(\u0026payment.id).is_some());\r\n    }\r\n}\r\n","traces":[{"line":17,"address":[],"length":0,"stats":{"Line":1080863910568919040}},{"line":26,"address":[],"length":0,"stats":{"Line":1224979098644774912}},{"line":33,"address":[],"length":0,"stats":{"Line":1224979098644774912}},{"line":34,"address":[],"length":0,"stats":{"Line":1224979098644774912}},{"line":35,"address":[],"length":0,"stats":{"Line":1224979098644774912}},{"line":36,"address":[],"length":0,"stats":{"Line":1224979098644774912}},{"line":37,"address":[],"length":0,"stats":{"Line":1224979098644774912}},{"line":39,"address":[],"length":0,"stats":{"Line":1224979098644774912}},{"line":42,"address":[],"length":0,"stats":{"Line":504403158265495552}},{"line":49,"address":[],"length":0,"stats":{"Line":504403158265495552}},{"line":50,"address":[],"length":0,"stats":{"Line":504403158265495552}},{"line":51,"address":[],"length":0,"stats":{"Line":504403158265495552}},{"line":52,"address":[],"length":0,"stats":{"Line":504403158265495552}},{"line":53,"address":[],"length":0,"stats":{"Line":504403158265495552}},{"line":55,"address":[],"length":0,"stats":{"Line":504403158265495552}},{"line":58,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":59,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":60,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":63,"address":[],"length":0,"stats":{"Line":360287970189639680}},{"line":64,"address":[],"length":0,"stats":{"Line":360287970189639680}},{"line":67,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":68,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":71,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":72,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":75,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":77,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":78,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":79,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":80,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":82,"address":[],"length":0,"stats":{"Line":288230376151711744}}],"covered":30,"coverable":30},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_produk","mod.rs"],"content":"pub mod produk;\r\n","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_produk","produk","audit_log_observer.rs"],"content":"use std::fmt::Debug;\r\n// use rocket_db_pools::sqlx::PgPool;\r\nuse super::model::Produk;\r\nuse super::events::ProdukObserver;\r\n\r\n#[derive(Debug)]\r\npub struct AuditLogObserver;\r\n\r\nimpl AuditLogObserver {\r\n    pub fn new() -\u003e Self {\r\n        AuditLogObserver\r\n    }\r\n}\r\n\r\nimpl ProdukObserver for AuditLogObserver {\r\n    fn on_stock_changed(\u0026self, produk: \u0026Produk, old_stock: u32) {\r\n        println!(\r\n            \"AUDIT LOG: Stock changed for product '{}' (ID: {:?}) from {} to {}\",\r\n            produk.nama, produk.id, old_stock, produk.stok\r\n        );\r\n    }\r\n}","traces":[{"line":10,"address":[],"length":0,"stats":{"Line":0}},{"line":11,"address":[],"length":0,"stats":{"Line":0}},{"line":16,"address":[],"length":0,"stats":{"Line":0}},{"line":17,"address":[],"length":0,"stats":{"Line":0}},{"line":18,"address":[],"length":0,"stats":{"Line":0}},{"line":19,"address":[],"length":0,"stats":{"Line":0}}],"covered":0,"coverable":6},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_produk","produk","controller.rs"],"content":"use rocket::serde::{Deserialize, Serialize, json::Json};\r\nuse rocket_db_pools::Connection;\r\nuse rocket::{get, post, put, delete, routes};\r\nuse crate::BuildingStoreDB;\r\nuse crate::manajemen_produk::produk::model::{Produk, ProdukBuilder, get_produk_factory_registry, get_produk_template_pool};\r\nuse crate::manajemen_produk::produk::repository::ProdukRepository;\r\nuse crate::manajemen_produk::produk::audit_log_observer::AuditLogObserver;\r\nuse std::sync::Arc;\r\n\r\n#[derive(Debug, Deserialize, Serialize)]\r\n#[serde(crate = \"rocket::serde\")]\r\npub struct ProdukRequest {\r\n    pub nama: String,\r\n    pub kategori: String,\r\n    pub harga: f64,\r\n    pub stok: i32,  // Changed from u32 to i32\r\n    pub deskripsi: Option\u003cString\u003e,\r\n}\r\n\r\n#[derive(Debug, Deserialize, Serialize)]\r\n#[serde(crate = \"rocket::serde\")]\r\npub struct ProdukResponse {\r\n    pub id: Option\u003ci64\u003e,\r\n    pub nama: String,\r\n    pub kategori: String,\r\n    pub harga: f64,\r\n    pub stok: u32,  // Changed from u32 to i32\r\n    pub deskripsi: Option\u003cString\u003e,\r\n}\r\n\r\nimpl From\u003cProduk\u003e for ProdukResponse {\r\n    fn from(produk: Produk) -\u003e Self {\r\n        Self {\r\n            id: produk.id,\r\n            nama: produk.nama,\r\n            kategori: produk.kategori,\r\n            harga: produk.harga,\r\n            stok: produk.stok,\r\n            deskripsi: produk.deskripsi,\r\n        }\r\n    }\r\n}\r\n\r\n#[derive(Debug, Deserialize, Serialize)]\r\n#[serde(crate = \"rocket::serde\")]\r\npub struct ApiResponse\u003cT\u003e {\r\n    pub success: bool,\r\n    pub message: Option\u003cString\u003e,\r\n    pub data: Option\u003cT\u003e,\r\n}\r\n\r\n// Controller functions\r\n#[get(\"/produk\")]\r\npub async fn list_produk(mut db: Connection\u003cBuildingStoreDB\u003e) -\u003e Json\u003cApiResponse\u003cVec\u003cProdukResponse\u003e\u003e\u003e {\r\n    match ProdukRepository::ambil_semua_produk(\u0026mut *db).await {\r\n        Ok(produk_list) =\u003e {\r\n            let response_list = produk_list.into_iter()\r\n                .map(|p| ProdukResponse::from(p))\r\n                .collect();\r\n                \r\n            Json(ApiResponse {\r\n                success: true,\r\n                message: Some(\"Berhasil mengambil daftar produk\".to_string()),\r\n                data: Some(response_list),\r\n            })\r\n        },\r\n        Err(e) =\u003e Json(ApiResponse {\r\n            success: false,\r\n            message: Some(format!(\"Gagal mengambil daftar produk: {}\", e)),\r\n            data: None,\r\n        }),\r\n    }\r\n}\r\n\r\n#[get(\"/produk/\u003cid\u003e\")]\r\npub async fn detail_produk(mut db: Connection\u003cBuildingStoreDB\u003e, id: i64) -\u003e Json\u003cApiResponse\u003cProdukResponse\u003e\u003e {\r\n    match ProdukRepository::ambil_produk_by_id(\u0026mut *db, id).await {\r\n        Ok(Some(produk)) =\u003e Json(ApiResponse {\r\n            success: true,\r\n            message: Some(\"Berhasil mengambil detail produk\".to_string()),\r\n            data: Some(ProdukResponse::from(produk)),\r\n        }),\r\n        Ok(None) =\u003e Json(ApiResponse {\r\n            success: false,\r\n            message: Some(format!(\"Produk dengan ID {} tidak ditemukan\", id)),\r\n            data: None,\r\n        }),\r\n        Err(e) =\u003e Json(ApiResponse {\r\n            success: false,\r\n            message: Some(format!(\"Gagal mengambil detail produk: {}\", e)),\r\n            data: None,\r\n        }),\r\n    }\r\n}\r\n\r\n#[post(\"/produk\", format = \"json\", data = \"\u003crequest\u003e\")]\r\npub async fn tambah_produk(\r\n    mut db: Connection\u003cBuildingStoreDB\u003e, \r\n    request: Json\u003cProdukRequest\u003e\r\n) -\u003e Json\u003cApiResponse\u003cProdukResponse\u003e\u003e {\r\n    // Builder Pattern untuk membuat produk baru\r\n    let produk_result = ProdukBuilder::new(request.nama.clone(), request.kategori.clone())\r\n        .harga(request.harga)\r\n        .stok(request.stok.try_into().unwrap())\r\n        .deskripsi(request.deskripsi.clone().unwrap_or_default())\r\n        .build();\r\n    \r\n    match produk_result {\r\n        Ok(produk) =\u003e {\r\n            match ProdukRepository::tambah_produk(\u0026mut *db, \u0026produk).await {\r\n                Ok(id) =\u003e {\r\n                    let produk_with_id = Produk::with_id(\r\n                        id, \r\n                        produk.nama, \r\n                        produk.kategori, \r\n                        produk.harga, \r\n                        produk.stok, \r\n                        produk.deskripsi\r\n                    );\r\n                    \r\n                    Json(ApiResponse {\r\n                        success: true,\r\n                        message: Some(\"Berhasil menambahkan produk baru\".to_string()),\r\n                        data: Some(ProdukResponse::from(produk_with_id)),\r\n                    })\r\n                },\r\n                Err(e) =\u003e Json(ApiResponse {\r\n                    success: false,\r\n                    message: Some(format!(\"Gagal menyimpan produk: {}\", e)),\r\n                    data: None,\r\n                }),\r\n            }\r\n        },\r\n        Err(e) =\u003e Json(ApiResponse {\r\n            success: false,\r\n            message: Some(format!(\"Validasi gagal: {:?}\", e)),\r\n            data: None,\r\n        }),\r\n    }\r\n}\r\n\r\n#[post(\"/produk/factory\", format = \"json\", data = \"\u003crequest\u003e\")]\r\npub async fn tambah_produk_with_factory(\r\n    mut db: Connection\u003cBuildingStoreDB\u003e, \r\n    request: Json\u003cProdukRequest\u003e\r\n) -\u003e Json\u003cApiResponse\u003cProdukResponse\u003e\u003e {\r\n    // Abstract Factory Pattern - Fixed async lock issue\r\n    let registry = get_produk_factory_registry();\r\n    \r\n    // Create the product before awaiting\r\n    let produk = {\r\n        match registry.lock() {\r\n            Ok(registry) =\u003e {\r\n                registry.create_produk(\r\n                    \u0026request.kategori, \r\n                    request.nama.clone(), \r\n                    request.harga, \r\n                    request.stok.try_into().unwrap(), \r\n                    request.deskripsi.clone()\r\n                )\r\n            },\r\n            Err(_) =\u003e {\r\n                return Json(ApiResponse {\r\n                    success: false,\r\n                    message: Some(\"Gagal mengakses registry factory\".to_string()),\r\n                    data: None,\r\n                });\r\n            }\r\n        }\r\n    };\r\n    \r\n    match produk {\r\n        Some(produk) =\u003e {\r\n            match ProdukRepository::tambah_produk(\u0026mut *db, \u0026produk).await {\r\n                Ok(id) =\u003e {\r\n                    let produk_with_id = Produk::with_id(\r\n                        id, \r\n                        produk.nama, \r\n                        produk.kategori, \r\n                        produk.harga, \r\n                        produk.stok, \r\n                        produk.deskripsi\r\n                    );\r\n                    \r\n                    Json(ApiResponse {\r\n                        success: true,\r\n                        message: Some(\"Berhasil menambahkan produk baru dengan factory\".to_string()),\r\n                        data: Some(ProdukResponse::from(produk_with_id)),\r\n                    })\r\n                },\r\n                Err(e) =\u003e Json(ApiResponse {\r\n                    success: false,\r\n                    message: Some(format!(\"Gagal menyimpan produk: {}\", e)),\r\n                    data: None,\r\n                }),\r\n            }\r\n        },\r\n        None =\u003e Json(ApiResponse {\r\n            success: false,\r\n            message: Some(format!(\"Factory untuk kategori '{}' tidak ditemukan\", request.kategori)),\r\n            data: None,\r\n        }),\r\n    }\r\n}\r\n\r\n#[post(\"/produk/template/\u003ctemplate_key\u003e\", format = \"json\", data = \"\u003crequest\u003e\")]\r\npub async fn tambah_produk_from_template(\r\n    mut db: Connection\u003cBuildingStoreDB\u003e,\r\n    template_key: String,\r\n    request: Json\u003cProdukRequest\u003e\r\n) -\u003e Json\u003cApiResponse\u003cProdukResponse\u003e\u003e {\r\n    // Object Pool Pattern - Fixed async lock issue\r\n    let template_pool = get_produk_template_pool();\r\n    \r\n    // Get template before awaiting\r\n    let mut produk = {\r\n        match template_pool.lock() {\r\n            Ok(pool) =\u003e {\r\n                pool.create_from_template(\u0026template_key, request.harga, request.stok.try_into().unwrap())\r\n            },\r\n            Err(_) =\u003e {\r\n                return Json(ApiResponse {\r\n                    success: false,\r\n                    message: Some(\"Gagal mengakses template pool\".to_string()),\r\n                    data: None,\r\n                });\r\n            }\r\n        }\r\n    };\r\n    \r\n    match produk {\r\n        Some(ref mut produk) =\u003e {\r\n            // Update nama jika disediakan\r\n            if !request.nama.trim().is_empty() {\r\n                produk.nama = request.nama.clone();\r\n            }\r\n            \r\n            // Update deskripsi jika disediakan\r\n            if request.deskripsi.is_some() {\r\n                produk.deskripsi = request.deskripsi.clone();\r\n            }\r\n            \r\n            match ProdukRepository::tambah_produk(\u0026mut *db, \u0026produk).await {\r\n                Ok(id) =\u003e {\r\n                    let produk_with_id = Produk::with_id(\r\n                        id, \r\n                        produk.nama.clone(), \r\n                        produk.kategori.clone(), \r\n                        produk.harga, \r\n                        produk.stok, \r\n                        produk.deskripsi.clone()\r\n                    );\r\n                    \r\n                    Json(ApiResponse {\r\n                        success: true,\r\n                        message: Some(\"Berhasil menambahkan produk dari template\".to_string()),\r\n                        data: Some(ProdukResponse::from(produk_with_id)),\r\n                    })\r\n                },\r\n                Err(e) =\u003e Json(ApiResponse {\r\n                    success: false,\r\n                    message: Some(format!(\"Gagal menyimpan produk: {}\", e)),\r\n                    data: None,\r\n                }),\r\n            }\r\n        },\r\n        None =\u003e Json(ApiResponse {\r\n            success: false,\r\n            message: Some(format!(\"Template dengan key '{}' tidak ditemukan\", template_key)),\r\n            data: None,\r\n        }),\r\n    }\r\n}\r\n\r\n#[put(\"/produk/\u003cid\u003e\", format = \"json\", data = \"\u003crequest\u003e\")]\r\npub async fn update_produk(\r\n    mut db: Connection\u003cBuildingStoreDB\u003e,\r\n    id: i64,\r\n    request: Json\u003cProdukRequest\u003e\r\n) -\u003e Json\u003cApiResponse\u003cProdukResponse\u003e\u003e {\r\n    // Prototype Pattern - Clone dengan modifikasi\r\n    let produk_result = match ProdukRepository::ambil_produk_by_id(\u0026mut *db, id).await {\r\n        Ok(Some(_)) =\u003e {\r\n            // Menggunakan builder untuk memperbarui produk\r\n            let updated_produk = ProdukBuilder::new(request.nama.clone(), request.kategori.clone())\r\n                .id(id)\r\n                .harga(request.harga)\r\n                .stok(request.stok.try_into().unwrap())\r\n                .deskripsi(request.deskripsi.clone().unwrap_or_default())\r\n                .build();\r\n                \r\n            updated_produk\r\n        },\r\n        Ok(None) =\u003e {\r\n            return Json(ApiResponse {\r\n                success: false,\r\n                message: Some(format!(\"Produk dengan ID {} tidak ditemukan\", id)),\r\n                data: None,\r\n            })\r\n        },\r\n        Err(e) =\u003e {\r\n            return Json(ApiResponse {\r\n                success: false,\r\n                message: Some(format!(\"Gagal mengambil produk untuk update: {}\", e)),\r\n                data: None,\r\n            })\r\n        }\r\n    };\r\n    \r\n    match produk_result {\r\n        Ok(updated_produk) =\u003e {\r\n            match ProdukRepository::update_produk(\u0026mut *db, id, \u0026updated_produk).await {\r\n                Ok(true) =\u003e {\r\n                    Json(ApiResponse {\r\n                        success: true,\r\n                        message: Some(\"Berhasil memperbarui produk\".to_string()),\r\n                        data: Some(ProdukResponse::from(updated_produk)),\r\n                    })\r\n                },\r\n                Ok(false) =\u003e {\r\n                    Json(ApiResponse {\r\n                        success: false,\r\n                        message: Some(format!(\"Produk dengan ID {} tidak ditemukan\", id)),\r\n                        data: None,\r\n                    })\r\n                },\r\n                Err(e) =\u003e {\r\n                    Json(ApiResponse {\r\n                        success: false,\r\n                        message: Some(format!(\"Gagal memperbarui produk: {}\", e)),\r\n                        data: None,\r\n                    })\r\n                }\r\n            }\r\n        },\r\n        Err(e) =\u003e {\r\n            Json(ApiResponse {\r\n                success: false,\r\n                message: Some(format!(\"Validasi gagal: {:?}\", e)),\r\n                data: None,\r\n            })\r\n        }\r\n    }\r\n}\r\n\r\n#[delete(\"/produk/\u003cid\u003e\")]\r\npub async fn hapus_produk(\r\n    mut db: Connection\u003cBuildingStoreDB\u003e, \r\n    id: i64\r\n) -\u003e Json\u003cApiResponse\u003c()\u003e\u003e {\r\n    match ProdukRepository::hapus_produk(\u0026mut *db, id).await {\r\n        Ok(true) =\u003e {\r\n            Json(ApiResponse {\r\n                success: true,\r\n                message: Some(format!(\"Produk dengan ID {} berhasil dihapus\", id)),\r\n                data: None,\r\n            })\r\n        },\r\n        Ok(false) =\u003e {\r\n            Json(ApiResponse {\r\n                success: false,\r\n                message: Some(format!(\"Produk dengan ID {} tidak ditemukan\", id)),\r\n                data: None,\r\n            })\r\n        },\r\n        Err(e) =\u003e {\r\n            Json(ApiResponse {\r\n                success: false,\r\n                message: Some(format!(\"Gagal menghapus produk: {}\", e)),\r\n                data: None,\r\n            })\r\n        }\r\n    }\r\n}\r\n\r\n// Implementasi Filter Produk\r\n#[get(\"/produk/kategori/\u003ckategori\u003e\")]\r\npub async fn filter_produk_by_kategori(\r\n    mut db: Connection\u003cBuildingStoreDB\u003e,\r\n    kategori: String\r\n) -\u003e Json\u003cApiResponse\u003cVec\u003cProdukResponse\u003e\u003e\u003e {\r\n    match ProdukRepository::filter_produk_by_kategori(\u0026mut *db, \u0026kategori).await {\r\n        Ok(produk_list) =\u003e {\r\n            let response_list = produk_list.into_iter()\r\n                .map(|p| ProdukResponse::from(p))\r\n                .collect();\r\n                \r\n            Json(ApiResponse {\r\n                success: true,\r\n                message: Some(format!(\"Berhasil filter produk berdasarkan kategori '{}'\", kategori)),\r\n                data: Some(response_list),\r\n            })\r\n        },\r\n        Err(e) =\u003e Json(ApiResponse {\r\n            success: false,\r\n            message: Some(format!(\"Gagal filter produk: {}\", e)),\r\n            data: None,\r\n        }),\r\n    }\r\n}\r\n\r\n#[get(\"/produk/harga?\u003cmin\u003e\u0026\u003cmax\u003e\")]\r\npub async fn filter_produk_by_price(\r\n    mut db: Connection\u003cBuildingStoreDB\u003e,\r\n    min: f64,\r\n    max: f64\r\n) -\u003e Json\u003cApiResponse\u003cVec\u003cProdukResponse\u003e\u003e\u003e {\r\n    match ProdukRepository::filter_produk_by_price_range(\u0026mut *db, min, max).await {\r\n        Ok(produk_list) =\u003e {\r\n            let response_list = produk_list.into_iter()\r\n                .map(|p| ProdukResponse::from(p))\r\n                .collect();\r\n                \r\n            Json(ApiResponse {\r\n                success: true,\r\n                message: Some(format!(\"Berhasil filter produk dengan harga {} - {}\", min, max)),\r\n                data: Some(response_list),\r\n            })\r\n        },\r\n        Err(e) =\u003e Json(ApiResponse {\r\n            success: false,\r\n            message: Some(format!(\"Gagal filter produk: {}\", e)),\r\n            data: None,\r\n        }),\r\n    }\r\n}\r\n\r\n#[get(\"/produk/stok?\u003cmin_stok\u003e\")]\r\npub async fn filter_produk_by_stock(\r\n    mut db: Connection\u003cBuildingStoreDB\u003e,\r\n    min_stok: i32  // Changed from u32 to i32\r\n) -\u003e Json\u003cApiResponse\u003cVec\u003cProdukResponse\u003e\u003e\u003e {\r\n    match ProdukRepository::filter_produk_by_stock_availability(\u0026mut *db, min_stok.try_into().unwrap()).await {\r\n        Ok(produk_list) =\u003e {\r\n            let response_list = produk_list.into_iter()\r\n                .map(|p| ProdukResponse::from(p))\r\n                .collect();\r\n                \r\n            Json(ApiResponse {\r\n                success: true,\r\n                message: Some(format!(\"Berhasil filter produk dengan stok minimal {}\", min_stok)),\r\n                data: Some(response_list),\r\n            })\r\n        },\r\n        Err(e) =\u003e Json(ApiResponse {\r\n            success: false,\r\n            message: Some(format!(\"Gagal filter produk: {}\", e)),\r\n            data: None,\r\n        }),\r\n    }\r\n}\r\n\r\n// Prototype pattern implementation endpoint\r\n#[post(\"/produk/\u003cid\u003e/clone_with_price\", format = \"json\", data = \"\u003crequest\u003e\")]\r\npub async fn clone_produk_with_price(\r\n    mut db: Connection\u003cBuildingStoreDB\u003e,\r\n    id: i64,\r\n    request: Json\u003cProdukRequest\u003e\r\n) -\u003e Json\u003cApiResponse\u003cProdukResponse\u003e\u003e {\r\n    match ProdukRepository::ambil_produk_by_id(\u0026mut *db, id).await {\r\n        Ok(Some(existing_produk)) =\u003e {\r\n            match existing_produk.clone_with_new_price(request.harga) {\r\n                Ok(cloned_produk) =\u003e {\r\n                    // Add custom nama if provided, otherwise keep existing\r\n                    let final_produk = if !request.nama.trim().is_empty() {\r\n                        Produk {\r\n                            id: None,\r\n                            nama: request.nama.clone(),\r\n                            ..cloned_produk\r\n                        }\r\n                    } else {\r\n                        cloned_produk\r\n                    };\r\n                    \r\n                    match ProdukRepository::tambah_produk(\u0026mut *db, \u0026final_produk).await {\r\n                        Ok(new_id) =\u003e {\r\n                            let produk_with_id = Produk::with_id(\r\n                                new_id,\r\n                                final_produk.nama,\r\n                                final_produk.kategori,\r\n                                final_produk.harga,\r\n                                final_produk.stok,\r\n                                final_produk.deskripsi\r\n                            );\r\n                            \r\n                            Json(ApiResponse {\r\n                                success: true,\r\n                                message: Some(\"Berhasil membuat clone produk dengan harga baru\".to_string()),\r\n                                data: Some(ProdukResponse::from(produk_with_id)),\r\n                            })\r\n                        },\r\n                        Err(e) =\u003e Json(ApiResponse {\r\n                            success: false,\r\n                            message: Some(format!(\"Gagal menyimpan produk clone: {}\", e)),\r\n                            data: None,\r\n                        }),\r\n                    }\r\n                },\r\n                Err(e) =\u003e Json(ApiResponse {\r\n                    success: false,\r\n                    message: Some(format!(\"Validasi gagal: {:?}\", e)),\r\n                    data: None,\r\n                }),\r\n            }\r\n        },\r\n        Ok(None) =\u003e Json(ApiResponse {\r\n            success: false,\r\n            message: Some(format!(\"Produk dengan ID {} tidak ditemukan\", id)),\r\n            data: None,\r\n        }),\r\n        Err(e) =\u003e Json(ApiResponse {\r\n            success: false,\r\n            message: Some(format!(\"Gagal mengambil produk: {}\", e)),\r\n            data: None,\r\n        }),\r\n    }\r\n}\r\n\r\n#[post(\"/produk/\u003cid\u003e/update_stock\", format = \"json\", data = \"\u003cnew_stok\u003e\")]\r\npub async fn update_stock(\r\n    mut db: Connection\u003cBuildingStoreDB\u003e,\r\n    id: i64,\r\n    new_stok: Json\u003ci32\u003e,\r\n) -\u003e Json\u003cApiResponse\u003c()\u003e\u003e {\r\n    // Fixed async issue with observers\r\n    match ProdukRepository::ambil_produk_by_id(\u0026mut *db, id).await {\r\n        Ok(Some(mut produk)) =\u003e {\r\n            // Create the observer\r\n            let observer = Arc::new(AuditLogObserver::new());\r\n            \r\n            // Add observer to produk\r\n            produk.add_observer(observer);\r\n            \r\n            // Update stok dan trigger observer\r\n            produk.set_stok((*new_stok).try_into().unwrap());\r\n            \r\n            // Simpan ke database\r\n            match ProdukRepository::update_produk(\u0026mut *db, id, \u0026produk).await {\r\n                Ok(_) =\u003e Json(ApiResponse {\r\n                    success: true,\r\n                    message: Some(\"Stok produk berhasil diperbarui\".into()),\r\n                    data: None,\r\n                }),\r\n                Err(e) =\u003e Json(ApiResponse {\r\n                    success: false,\r\n                    message: Some(format!(\"Gagal menyimpan perubahan stok: {}\", e)),\r\n                    data: None,\r\n                }),\r\n            }\r\n        }\r\n        Ok(None) =\u003e Json(ApiResponse {\r\n            success: false,\r\n            message: Some(format!(\"Produk ID {} tidak ditemukan\", id)),\r\n            data: None,\r\n        }),\r\n        Err(e) =\u003e Json(ApiResponse {\r\n            success: false,\r\n            message: Some(format!(\"Gagal mengambil produk: {}\", e)),\r\n            data: None,\r\n        }),\r\n    }\r\n}\r\n\r\n// Fungsi untuk mendaftarkan semua routes\r\npub fn routes() -\u003e Vec\u003crocket::Route\u003e {\r\n    routes![\r\n        list_produk,\r\n        detail_produk,\r\n        tambah_produk,\r\n        tambah_produk_with_factory,\r\n        tambah_produk_from_template,\r\n        update_produk,\r\n        hapus_produk,\r\n        filter_produk_by_kategori,\r\n        filter_produk_by_price,\r\n        filter_produk_by_stock,\r\n        clone_produk_with_price,\r\n        update_stock,\r\n    ]\r\n}","traces":[{"line":32,"address":[],"length":0,"stats":{"Line":0}},{"line":34,"address":[],"length":0,"stats":{"Line":0}},{"line":35,"address":[],"length":0,"stats":{"Line":0}},{"line":36,"address":[],"length":0,"stats":{"Line":0}},{"line":37,"address":[],"length":0,"stats":{"Line":0}},{"line":38,"address":[],"length":0,"stats":{"Line":0}},{"line":39,"address":[],"length":0,"stats":{"Line":0}},{"line":54,"address":[],"length":0,"stats":{"Line":0}},{"line":55,"address":[],"length":0,"stats":{"Line":0}},{"line":56,"address":[],"length":0,"stats":{"Line":0}},{"line":57,"address":[],"length":0,"stats":{"Line":0}},{"line":58,"address":[],"length":0,"stats":{"Line":0}},{"line":61,"address":[],"length":0,"stats":{"Line":0}},{"line":62,"address":[],"length":0,"stats":{"Line":0}},{"line":63,"address":[],"length":0,"stats":{"Line":0}},{"line":64,"address":[],"length":0,"stats":{"Line":0}},{"line":67,"address":[],"length":0,"stats":{"Line":0}},{"line":68,"address":[],"length":0,"stats":{"Line":0}},{"line":69,"address":[],"length":0,"stats":{"Line":0}},{"line":70,"address":[],"length":0,"stats":{"Line":0}},{"line":76,"address":[],"length":0,"stats":{"Line":0}},{"line":77,"address":[],"length":0,"stats":{"Line":0}},{"line":78,"address":[],"length":0,"stats":{"Line":0}},{"line":79,"address":[],"length":0,"stats":{"Line":0}},{"line":80,"address":[],"length":0,"stats":{"Line":0}},{"line":81,"address":[],"length":0,"stats":{"Line":0}},{"line":83,"address":[],"length":0,"stats":{"Line":0}},{"line":84,"address":[],"length":0,"stats":{"Line":0}},{"line":85,"address":[],"length":0,"stats":{"Line":0}},{"line":86,"address":[],"length":0,"stats":{"Line":0}},{"line":88,"address":[],"length":0,"stats":{"Line":0}},{"line":89,"address":[],"length":0,"stats":{"Line":0}},{"line":90,"address":[],"length":0,"stats":{"Line":0}},{"line":91,"address":[],"length":0,"stats":{"Line":0}},{"line":97,"address":[],"length":0,"stats":{"Line":0}},{"line":102,"address":[],"length":0,"stats":{"Line":0}},{"line":103,"address":[],"length":0,"stats":{"Line":0}},{"line":104,"address":[],"length":0,"stats":{"Line":0}},{"line":105,"address":[],"length":0,"stats":{"Line":0}},{"line":108,"address":[],"length":0,"stats":{"Line":0}},{"line":109,"address":[],"length":0,"stats":{"Line":0}},{"line":110,"address":[],"length":0,"stats":{"Line":0}},{"line":111,"address":[],"length":0,"stats":{"Line":0}},{"line":113,"address":[],"length":0,"stats":{"Line":0}},{"line":114,"address":[],"length":0,"stats":{"Line":0}},{"line":115,"address":[],"length":0,"stats":{"Line":0}},{"line":116,"address":[],"length":0,"stats":{"Line":0}},{"line":117,"address":[],"length":0,"stats":{"Line":0}},{"line":118,"address":[],"length":0,"stats":{"Line":0}},{"line":121,"address":[],"length":0,"stats":{"Line":0}},{"line":122,"address":[],"length":0,"stats":{"Line":0}},{"line":123,"address":[],"length":0,"stats":{"Line":0}},{"line":124,"address":[],"length":0,"stats":{"Line":0}},{"line":127,"address":[],"length":0,"stats":{"Line":0}},{"line":128,"address":[],"length":0,"stats":{"Line":0}},{"line":129,"address":[],"length":0,"stats":{"Line":0}},{"line":130,"address":[],"length":0,"stats":{"Line":0}},{"line":134,"address":[],"length":0,"stats":{"Line":0}},{"line":135,"address":[],"length":0,"stats":{"Line":0}},{"line":136,"address":[],"length":0,"stats":{"Line":0}},{"line":137,"address":[],"length":0,"stats":{"Line":0}},{"line":143,"address":[],"length":0,"stats":{"Line":0}},{"line":148,"address":[],"length":0,"stats":{"Line":0}},{"line":151,"address":[],"length":0,"stats":{"Line":0}},{"line":152,"address":[],"length":0,"stats":{"Line":0}},{"line":153,"address":[],"length":0,"stats":{"Line":0}},{"line":154,"address":[],"length":0,"stats":{"Line":0}},{"line":155,"address":[],"length":0,"stats":{"Line":0}},{"line":156,"address":[],"length":0,"stats":{"Line":0}},{"line":157,"address":[],"length":0,"stats":{"Line":0}},{"line":158,"address":[],"length":0,"stats":{"Line":0}},{"line":159,"address":[],"length":0,"stats":{"Line":0}},{"line":163,"address":[],"length":0,"stats":{"Line":0}},{"line":164,"address":[],"length":0,"stats":{"Line":0}},{"line":165,"address":[],"length":0,"stats":{"Line":0}},{"line":166,"address":[],"length":0,"stats":{"Line":0}},{"line":172,"address":[],"length":0,"stats":{"Line":0}},{"line":173,"address":[],"length":0,"stats":{"Line":0}},{"line":174,"address":[],"length":0,"stats":{"Line":0}},{"line":175,"address":[],"length":0,"stats":{"Line":0}},{"line":177,"address":[],"length":0,"stats":{"Line":0}},{"line":178,"address":[],"length":0,"stats":{"Line":0}},{"line":179,"address":[],"length":0,"stats":{"Line":0}},{"line":180,"address":[],"length":0,"stats":{"Line":0}},{"line":181,"address":[],"length":0,"stats":{"Line":0}},{"line":182,"address":[],"length":0,"stats":{"Line":0}},{"line":185,"address":[],"length":0,"stats":{"Line":0}},{"line":186,"address":[],"length":0,"stats":{"Line":0}},{"line":187,"address":[],"length":0,"stats":{"Line":0}},{"line":188,"address":[],"length":0,"stats":{"Line":0}},{"line":191,"address":[],"length":0,"stats":{"Line":0}},{"line":192,"address":[],"length":0,"stats":{"Line":0}},{"line":193,"address":[],"length":0,"stats":{"Line":0}},{"line":194,"address":[],"length":0,"stats":{"Line":0}},{"line":198,"address":[],"length":0,"stats":{"Line":0}},{"line":199,"address":[],"length":0,"stats":{"Line":0}},{"line":200,"address":[],"length":0,"stats":{"Line":0}},{"line":201,"address":[],"length":0,"stats":{"Line":0}},{"line":207,"address":[],"length":0,"stats":{"Line":0}},{"line":213,"address":[],"length":0,"stats":{"Line":0}},{"line":216,"address":[],"length":0,"stats":{"Line":0}},{"line":217,"address":[],"length":0,"stats":{"Line":0}},{"line":218,"address":[],"length":0,"stats":{"Line":0}},{"line":219,"address":[],"length":0,"stats":{"Line":0}},{"line":222,"address":[],"length":0,"stats":{"Line":0}},{"line":223,"address":[],"length":0,"stats":{"Line":0}},{"line":224,"address":[],"length":0,"stats":{"Line":0}},{"line":225,"address":[],"length":0,"stats":{"Line":0}},{"line":231,"address":[],"length":0,"stats":{"Line":0}},{"line":232,"address":[],"length":0,"stats":{"Line":0}},{"line":234,"address":[],"length":0,"stats":{"Line":0}},{"line":235,"address":[],"length":0,"stats":{"Line":0}},{"line":239,"address":[],"length":0,"stats":{"Line":0}},{"line":240,"address":[],"length":0,"stats":{"Line":0}},{"line":243,"address":[],"length":0,"stats":{"Line":0}},{"line":244,"address":[],"length":0,"stats":{"Line":0}},{"line":246,"address":[],"length":0,"stats":{"Line":0}},{"line":247,"address":[],"length":0,"stats":{"Line":0}},{"line":248,"address":[],"length":0,"stats":{"Line":0}},{"line":249,"address":[],"length":0,"stats":{"Line":0}},{"line":250,"address":[],"length":0,"stats":{"Line":0}},{"line":251,"address":[],"length":0,"stats":{"Line":0}},{"line":254,"address":[],"length":0,"stats":{"Line":0}},{"line":255,"address":[],"length":0,"stats":{"Line":0}},{"line":256,"address":[],"length":0,"stats":{"Line":0}},{"line":257,"address":[],"length":0,"stats":{"Line":0}},{"line":260,"address":[],"length":0,"stats":{"Line":0}},{"line":261,"address":[],"length":0,"stats":{"Line":0}},{"line":262,"address":[],"length":0,"stats":{"Line":0}},{"line":263,"address":[],"length":0,"stats":{"Line":0}},{"line":267,"address":[],"length":0,"stats":{"Line":0}},{"line":268,"address":[],"length":0,"stats":{"Line":0}},{"line":269,"address":[],"length":0,"stats":{"Line":0}},{"line":270,"address":[],"length":0,"stats":{"Line":0}},{"line":276,"address":[],"length":0,"stats":{"Line":0}},{"line":282,"address":[],"length":0,"stats":{"Line":0}},{"line":285,"address":[],"length":0,"stats":{"Line":0}},{"line":286,"address":[],"length":0,"stats":{"Line":0}},{"line":287,"address":[],"length":0,"stats":{"Line":0}},{"line":288,"address":[],"length":0,"stats":{"Line":0}},{"line":289,"address":[],"length":0,"stats":{"Line":0}},{"line":292,"address":[],"length":0,"stats":{"Line":0}},{"line":295,"address":[],"length":0,"stats":{"Line":0}},{"line":296,"address":[],"length":0,"stats":{"Line":0}},{"line":297,"address":[],"length":0,"stats":{"Line":0}},{"line":298,"address":[],"length":0,"stats":{"Line":0}},{"line":301,"address":[],"length":0,"stats":{"Line":0}},{"line":302,"address":[],"length":0,"stats":{"Line":0}},{"line":303,"address":[],"length":0,"stats":{"Line":0}},{"line":304,"address":[],"length":0,"stats":{"Line":0}},{"line":305,"address":[],"length":0,"stats":{"Line":0}},{"line":310,"address":[],"length":0,"stats":{"Line":0}},{"line":311,"address":[],"length":0,"stats":{"Line":0}},{"line":312,"address":[],"length":0,"stats":{"Line":0}},{"line":314,"address":[],"length":0,"stats":{"Line":0}},{"line":315,"address":[],"length":0,"stats":{"Line":0}},{"line":316,"address":[],"length":0,"stats":{"Line":0}},{"line":317,"address":[],"length":0,"stats":{"Line":0}},{"line":321,"address":[],"length":0,"stats":{"Line":0}},{"line":322,"address":[],"length":0,"stats":{"Line":0}},{"line":323,"address":[],"length":0,"stats":{"Line":0}},{"line":324,"address":[],"length":0,"stats":{"Line":0}},{"line":327,"address":[],"length":0,"stats":{"Line":0}},{"line":328,"address":[],"length":0,"stats":{"Line":0}},{"line":329,"address":[],"length":0,"stats":{"Line":0}},{"line":330,"address":[],"length":0,"stats":{"Line":0}},{"line":331,"address":[],"length":0,"stats":{"Line":0}},{"line":336,"address":[],"length":0,"stats":{"Line":0}},{"line":337,"address":[],"length":0,"stats":{"Line":0}},{"line":338,"address":[],"length":0,"stats":{"Line":0}},{"line":339,"address":[],"length":0,"stats":{"Line":0}},{"line":340,"address":[],"length":0,"stats":{"Line":0}},{"line":347,"address":[],"length":0,"stats":{"Line":0}},{"line":351,"address":[],"length":0,"stats":{"Line":0}},{"line":353,"address":[],"length":0,"stats":{"Line":0}},{"line":354,"address":[],"length":0,"stats":{"Line":0}},{"line":355,"address":[],"length":0,"stats":{"Line":0}},{"line":356,"address":[],"length":0,"stats":{"Line":0}},{"line":360,"address":[],"length":0,"stats":{"Line":0}},{"line":361,"address":[],"length":0,"stats":{"Line":0}},{"line":362,"address":[],"length":0,"stats":{"Line":0}},{"line":363,"address":[],"length":0,"stats":{"Line":0}},{"line":366,"address":[],"length":0,"stats":{"Line":0}},{"line":367,"address":[],"length":0,"stats":{"Line":0}},{"line":368,"address":[],"length":0,"stats":{"Line":0}},{"line":369,"address":[],"length":0,"stats":{"Line":0}},{"line":370,"address":[],"length":0,"stats":{"Line":0}},{"line":378,"address":[],"length":0,"stats":{"Line":0}},{"line":382,"address":[],"length":0,"stats":{"Line":0}},{"line":383,"address":[],"length":0,"stats":{"Line":0}},{"line":384,"address":[],"length":0,"stats":{"Line":0}},{"line":385,"address":[],"length":0,"stats":{"Line":0}},{"line":388,"address":[],"length":0,"stats":{"Line":0}},{"line":389,"address":[],"length":0,"stats":{"Line":0}},{"line":390,"address":[],"length":0,"stats":{"Line":0}},{"line":391,"address":[],"length":0,"stats":{"Line":0}},{"line":394,"address":[],"length":0,"stats":{"Line":0}},{"line":395,"address":[],"length":0,"stats":{"Line":0}},{"line":396,"address":[],"length":0,"stats":{"Line":0}},{"line":397,"address":[],"length":0,"stats":{"Line":0}},{"line":403,"address":[],"length":0,"stats":{"Line":0}},{"line":408,"address":[],"length":0,"stats":{"Line":0}},{"line":409,"address":[],"length":0,"stats":{"Line":0}},{"line":410,"address":[],"length":0,"stats":{"Line":0}},{"line":411,"address":[],"length":0,"stats":{"Line":0}},{"line":414,"address":[],"length":0,"stats":{"Line":0}},{"line":415,"address":[],"length":0,"stats":{"Line":0}},{"line":416,"address":[],"length":0,"stats":{"Line":0}},{"line":417,"address":[],"length":0,"stats":{"Line":0}},{"line":420,"address":[],"length":0,"stats":{"Line":0}},{"line":421,"address":[],"length":0,"stats":{"Line":0}},{"line":422,"address":[],"length":0,"stats":{"Line":0}},{"line":423,"address":[],"length":0,"stats":{"Line":0}},{"line":429,"address":[],"length":0,"stats":{"Line":0}},{"line":433,"address":[],"length":0,"stats":{"Line":0}},{"line":434,"address":[],"length":0,"stats":{"Line":0}},{"line":435,"address":[],"length":0,"stats":{"Line":0}},{"line":436,"address":[],"length":0,"stats":{"Line":0}},{"line":439,"address":[],"length":0,"stats":{"Line":0}},{"line":440,"address":[],"length":0,"stats":{"Line":0}},{"line":441,"address":[],"length":0,"stats":{"Line":0}},{"line":442,"address":[],"length":0,"stats":{"Line":0}},{"line":445,"address":[],"length":0,"stats":{"Line":0}},{"line":446,"address":[],"length":0,"stats":{"Line":0}},{"line":447,"address":[],"length":0,"stats":{"Line":0}},{"line":448,"address":[],"length":0,"stats":{"Line":0}},{"line":455,"address":[],"length":0,"stats":{"Line":0}},{"line":460,"address":[],"length":0,"stats":{"Line":0}},{"line":461,"address":[],"length":0,"stats":{"Line":0}},{"line":462,"address":[],"length":0,"stats":{"Line":0}},{"line":463,"address":[],"length":0,"stats":{"Line":0}},{"line":465,"address":[],"length":0,"stats":{"Line":0}},{"line":468,"address":[],"length":0,"stats":{"Line":0}},{"line":472,"address":[],"length":0,"stats":{"Line":0}},{"line":475,"address":[],"length":0,"stats":{"Line":0}},{"line":476,"address":[],"length":0,"stats":{"Line":0}},{"line":478,"address":[],"length":0,"stats":{"Line":0}},{"line":479,"address":[],"length":0,"stats":{"Line":0}},{"line":480,"address":[],"length":0,"stats":{"Line":0}},{"line":481,"address":[],"length":0,"stats":{"Line":0}},{"line":482,"address":[],"length":0,"stats":{"Line":0}},{"line":483,"address":[],"length":0,"stats":{"Line":0}},{"line":486,"address":[],"length":0,"stats":{"Line":0}},{"line":487,"address":[],"length":0,"stats":{"Line":0}},{"line":488,"address":[],"length":0,"stats":{"Line":0}},{"line":489,"address":[],"length":0,"stats":{"Line":0}},{"line":492,"address":[],"length":0,"stats":{"Line":0}},{"line":493,"address":[],"length":0,"stats":{"Line":0}},{"line":494,"address":[],"length":0,"stats":{"Line":0}},{"line":495,"address":[],"length":0,"stats":{"Line":0}},{"line":499,"address":[],"length":0,"stats":{"Line":0}},{"line":500,"address":[],"length":0,"stats":{"Line":0}},{"line":501,"address":[],"length":0,"stats":{"Line":0}},{"line":502,"address":[],"length":0,"stats":{"Line":0}},{"line":506,"address":[],"length":0,"stats":{"Line":0}},{"line":507,"address":[],"length":0,"stats":{"Line":0}},{"line":508,"address":[],"length":0,"stats":{"Line":0}},{"line":509,"address":[],"length":0,"stats":{"Line":0}},{"line":511,"address":[],"length":0,"stats":{"Line":0}},{"line":512,"address":[],"length":0,"stats":{"Line":0}},{"line":513,"address":[],"length":0,"stats":{"Line":0}},{"line":514,"address":[],"length":0,"stats":{"Line":0}},{"line":520,"address":[],"length":0,"stats":{"Line":0}},{"line":526,"address":[],"length":0,"stats":{"Line":0}},{"line":527,"address":[],"length":0,"stats":{"Line":0}},{"line":529,"address":[],"length":0,"stats":{"Line":0}},{"line":532,"address":[],"length":0,"stats":{"Line":0}},{"line":535,"address":[],"length":0,"stats":{"Line":0}},{"line":538,"address":[],"length":0,"stats":{"Line":0}},{"line":539,"address":[],"length":0,"stats":{"Line":0}},{"line":540,"address":[],"length":0,"stats":{"Line":0}},{"line":541,"address":[],"length":0,"stats":{"Line":0}},{"line":542,"address":[],"length":0,"stats":{"Line":0}},{"line":544,"address":[],"length":0,"stats":{"Line":0}},{"line":545,"address":[],"length":0,"stats":{"Line":0}},{"line":546,"address":[],"length":0,"stats":{"Line":0}},{"line":547,"address":[],"length":0,"stats":{"Line":0}},{"line":551,"address":[],"length":0,"stats":{"Line":0}},{"line":552,"address":[],"length":0,"stats":{"Line":0}},{"line":553,"address":[],"length":0,"stats":{"Line":0}},{"line":554,"address":[],"length":0,"stats":{"Line":0}},{"line":556,"address":[],"length":0,"stats":{"Line":0}},{"line":557,"address":[],"length":0,"stats":{"Line":0}},{"line":558,"address":[],"length":0,"stats":{"Line":0}},{"line":559,"address":[],"length":0,"stats":{"Line":0}},{"line":565,"address":[],"length":0,"stats":{"Line":0}},{"line":566,"address":[],"length":0,"stats":{"Line":0}},{"line":567,"address":[],"length":0,"stats":{"Line":0}},{"line":568,"address":[],"length":0,"stats":{"Line":0}},{"line":569,"address":[],"length":0,"stats":{"Line":0}},{"line":570,"address":[],"length":0,"stats":{"Line":0}},{"line":571,"address":[],"length":0,"stats":{"Line":0}},{"line":572,"address":[],"length":0,"stats":{"Line":0}},{"line":573,"address":[],"length":0,"stats":{"Line":0}},{"line":574,"address":[],"length":0,"stats":{"Line":0}},{"line":575,"address":[],"length":0,"stats":{"Line":0}},{"line":576,"address":[],"length":0,"stats":{"Line":0}},{"line":577,"address":[],"length":0,"stats":{"Line":0}},{"line":578,"address":[],"length":0,"stats":{"Line":0}}],"covered":0,"coverable":299},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_produk","produk","events.rs"],"content":"use std::sync::{Arc, Mutex};\r\nuse std::fmt::Debug;\r\nuse super::model::Produk;\r\n\r\npub trait ProdukObserver: Send + Sync + Debug {\r\n    fn on_stock_changed(\u0026self, produk: \u0026Produk, old_stock: u32);\r\n}\r\n\r\n#[derive(Debug, Clone)]  // Remove PartialEq\r\npub struct ProdukEventPublisher {\r\n    observers: Arc\u003cMutex\u003cVec\u003cArc\u003cdyn ProdukObserver\u003e\u003e\u003e\u003e,\r\n}\r\n\r\nimpl ProdukEventPublisher {\r\n    pub fn new() -\u003e Self {\r\n        Self {\r\n            observers: Arc::new(Mutex::new(Vec::new())),\r\n        }\r\n    }\r\n\r\n    pub fn add_observer(\u0026self, observer: Arc\u003cdyn ProdukObserver\u003e) {\r\n        self.observers.lock().unwrap().push(observer);\r\n    }\r\n\r\n    pub fn notify_stock_changed(\u0026self, produk: \u0026Produk, old_stock: u32) {\r\n        for observer in self.observers.lock().unwrap().iter() {\r\n            observer.on_stock_changed(produk, old_stock);\r\n        }\r\n    }\r\n}","traces":[{"line":15,"address":[],"length":0,"stats":{"Line":4323455642275676160}},{"line":17,"address":[],"length":0,"stats":{"Line":4323455642275676160}},{"line":21,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":22,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":25,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":26,"address":[],"length":0,"stats":{"Line":576460752303423488}},{"line":27,"address":[],"length":0,"stats":{"Line":144115188075855872}}],"covered":7,"coverable":7},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_produk","produk","mod.rs"],"content":"pub mod model;\r\npub mod repository;\r\npub mod validation;\r\npub mod controller;\r\npub mod events;\r\npub mod audit_log_observer;\r\n\r\n#[cfg(test)]\r\npub mod tests;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_produk","produk","model.rs"],"content":"use std::sync::{Arc, Mutex};\r\nuse std::collections::HashMap;\r\nuse lazy_static::lazy_static;\r\nuse super::validation::ProdukValidator;\r\nuse super::events::{ProdukEventPublisher, ProdukObserver};\r\n\r\n#[derive(Debug, Clone)] \r\npub struct Produk {\r\n    pub id: Option\u003ci64\u003e,  // Menambahkan ID untuk memudahkan operasi database\r\n    pub nama: String,\r\n    pub kategori: String,\r\n    pub harga: f64,\r\n    pub stok: u32,\r\n    pub deskripsi: Option\u003cString\u003e,\r\n    pub event_publisher: ProdukEventPublisher,\r\n}\r\n\r\n// Builder pattern implementation - sudah baik, sedikit perbaikan\r\npub struct ProdukBuilder {\r\n    id: Option\u003ci64\u003e,\r\n    nama: String,\r\n    kategori: String,\r\n    harga: f64,\r\n    stok: u32,\r\n    deskripsi: Option\u003cString\u003e,\r\n    event_publisher: ProdukEventPublisher,\r\n}\r\n\r\nimpl ProdukBuilder {\r\n    pub fn new(nama: String, kategori: String) -\u003e Self {\r\n        Self {\r\n            id: None,\r\n            nama,\r\n            kategori,\r\n            harga: 0.0,\r\n            stok: 0,\r\n            deskripsi: None,\r\n            event_publisher: ProdukEventPublisher::new(),\r\n        }\r\n    }\r\n    \r\n    pub fn id(mut self, id: i64) -\u003e Self {\r\n        self.id = Some(id);\r\n        self\r\n    }\r\n    \r\n    pub fn harga(mut self, harga: f64) -\u003e Self {\r\n        self.harga = harga;\r\n        self\r\n    }\r\n    \r\n    pub fn stok(mut self, stok: u32) -\u003e Self {\r\n        self.stok = stok;\r\n        self\r\n    }\r\n    \r\n    pub fn deskripsi(mut self, deskripsi: String) -\u003e Self {\r\n        self.deskripsi = Some(deskripsi);\r\n        self\r\n    }\r\n    \r\n    pub fn build(self) -\u003e Result\u003cProduk, Vec\u003cString\u003e\u003e {\r\n        // Validate before building\r\n        let validator = ProdukValidator::default();\r\n        let produk = Produk {\r\n            id: self.id,\r\n            nama: self.nama,\r\n            kategori: self.kategori,\r\n            harga: self.harga,\r\n            stok: self.stok,\r\n            deskripsi: self.deskripsi,\r\n            event_publisher: self.event_publisher,\r\n        };\r\n        \r\n        validator.validate(\u0026produk)?;\r\n        Ok(produk)\r\n    }\r\n}\r\n\r\n// Prototype Pattern - Clone dengan parameter khusus\r\nimpl Produk {\r\n    // Regular constructor kept for backward compatibility\r\n    pub fn new(\r\n        nama: String,\r\n        kategori: String,\r\n        harga: f64,\r\n        stok: u32,\r\n        deskripsi: Option\u003cString\u003e,\r\n    ) -\u003e Self {\r\n        Self {\r\n            id: None,\r\n            nama,\r\n            kategori,\r\n            harga,\r\n            stok,\r\n            deskripsi,\r\n            event_publisher: ProdukEventPublisher::new(),\r\n        }\r\n    }\r\n    \r\n    // Menambahkan constructor dengan ID - untuk penggunaan dari database\r\n    pub fn with_id(\r\n        id: i64,\r\n        nama: String,\r\n        kategori: String,\r\n        harga: f64,\r\n        stok: u32,\r\n        deskripsi: Option\u003cString\u003e,\r\n    ) -\u003e Self {\r\n        Self {\r\n            id: Some(id),\r\n            nama,\r\n            kategori,\r\n            harga,\r\n            stok,\r\n            deskripsi,\r\n            event_publisher: ProdukEventPublisher::new(),\r\n        }\r\n    }\r\n    \r\n    pub fn validate(\u0026self) -\u003e Result\u003c(), Vec\u003cString\u003e\u003e {\r\n        let validator = ProdukValidator::default();\r\n        validator.validate(self)\r\n    }\r\n    \r\n    pub fn create_with_validation(\r\n        nama: String,\r\n        kategori: String,\r\n        harga: f64,\r\n        stok: u32,\r\n        deskripsi: Option\u003cString\u003e,\r\n    ) -\u003e Result\u003cSelf, Vec\u003cString\u003e\u003e {\r\n        let produk = Self::new(nama, kategori, harga, stok, deskripsi);\r\n        produk.validate()?;\r\n        Ok(produk)\r\n    }\r\n    \r\n    // Factory method pattern - sudah baik\r\n    pub fn create_laptop(nama: String, harga: f64, stok: u32, deskripsi: Option\u003cString\u003e) -\u003e Self {\r\n        Self::new(nama, \"Elektronik\".to_string(), harga, stok, deskripsi)\r\n    }\r\n    \r\n    pub fn create_building_material(nama: String, harga: f64, stok: u32, deskripsi: Option\u003cString\u003e) -\u003e Self {\r\n        Self::new(nama, \"Material\".to_string(), harga, stok, deskripsi)\r\n    }\r\n    \r\n    pub fn create_furniture(nama: String, harga: f64, stok: u32, deskripsi: Option\u003cString\u003e) -\u003e Self {\r\n        Self::new(nama, \"Furnitur\".to_string(), harga, stok, deskripsi)\r\n    }\r\n    \r\n    pub fn create_plumbing(nama: String, harga: f64, stok: u32, deskripsi: Option\u003cString\u003e) -\u003e Self {\r\n        Self::new(nama, \"Pipa \u0026 Sanitasi\".to_string(), harga, stok, deskripsi)\r\n    }\r\n    \r\n    // Prototype Pattern - Clone dengan parameter khusus\r\n    pub fn clone_with_new_price(\u0026self, new_price: f64) -\u003e Result\u003cSelf, String\u003e {\r\n        if new_price \u003c 0.0 {\r\n            return Err(\"Harga produk tidak boleh negatif\".to_string());\r\n        }\r\n        \r\n        Ok(Self {\r\n            id: self.id,\r\n            nama: self.nama.clone(),\r\n            kategori: self.kategori.clone(),\r\n            harga: new_price,\r\n            stok: self.stok,\r\n            deskripsi: self.deskripsi.clone(),\r\n            event_publisher: self.event_publisher.clone(),\r\n        })\r\n    }\r\n    \r\n    pub fn clone_with_new_stock(\u0026self, new_stock: u32) -\u003e Self {\r\n        Self {\r\n            id: self.id,\r\n            nama: self.nama.clone(),\r\n            kategori: self.kategori.clone(),\r\n            harga: self.harga,\r\n            stok: new_stock,\r\n            deskripsi: self.deskripsi.clone(),\r\n            event_publisher: self.event_publisher.clone(),\r\n        }\r\n    }\r\n\r\n    pub fn add_observer(\u0026mut self, observer: Arc\u003cdyn ProdukObserver\u003e) {\r\n        self.event_publisher.add_observer(observer);\r\n    }\r\n\r\n    pub fn set_stok(\u0026mut self, new_stock: u32) {\r\n        let old = self.stok;\r\n        self.stok = new_stock;\r\n        self.event_publisher.notify_stock_changed(self, old);\r\n    }\r\n    \r\n    pub fn set_harga(\u0026mut self, new_price: f64) -\u003e Result\u003c(), String\u003e {\r\n        if new_price \u003c 0.0 {\r\n            return Err(\"Harga produk tidak boleh negatif\".to_string());\r\n        }\r\n        \r\n        let _old = self.harga;\r\n        self.harga = new_price;\r\n        // Note: Your event publisher doesn't have a price_changed notification\r\n        // self.event_publisher.notify_price_changed(self, old);\r\n        Ok(())\r\n    }\r\n}\r\n\r\n// Abstract Factory Pattern\r\npub trait ProdukFactory {\r\n    fn create_produk(\u0026self, nama: String, harga: f64, stok: u32, deskripsi: Option\u003cString\u003e) -\u003e Produk;\r\n}\r\n\r\npub struct ElektronikFactory;\r\nimpl ProdukFactory for ElektronikFactory {\r\n    fn create_produk(\u0026self, nama: String, harga: f64, stok: u32, deskripsi: Option\u003cString\u003e) -\u003e Produk {\r\n        Produk::create_laptop(nama, harga, stok, deskripsi)\r\n    }\r\n}\r\n\r\npub struct MaterialFactory;\r\nimpl ProdukFactory for MaterialFactory {\r\n    fn create_produk(\u0026self, nama: String, harga: f64, stok: u32, deskripsi: Option\u003cString\u003e) -\u003e Produk {\r\n        Produk::create_building_material(nama, harga, stok, deskripsi)\r\n    }\r\n}\r\n\r\npub struct FurnitureFactory;\r\nimpl ProdukFactory for FurnitureFactory {\r\n    fn create_produk(\u0026self, nama: String, harga: f64, stok: u32, deskripsi: Option\u003cString\u003e) -\u003e Produk {\r\n        Produk::create_furniture(nama, harga, stok, deskripsi)\r\n    }\r\n}\r\n\r\npub struct PlumbingFactory;\r\nimpl ProdukFactory for PlumbingFactory {\r\n    fn create_produk(\u0026self, nama: String, harga: f64, stok: u32, deskripsi: Option\u003cString\u003e) -\u003e Produk {\r\n        Produk::create_plumbing(nama, harga, stok, deskripsi)\r\n    }\r\n}\r\n\r\n// Singleton Pattern untuk Registry Factory\r\npub struct ProdukFactoryRegistry {\r\n    factories: HashMap\u003cString, Box\u003cdyn ProdukFactory + Send + Sync\u003e\u003e,\r\n}\r\n\r\nimpl ProdukFactoryRegistry {\r\n    fn new() -\u003e Self {\r\n        let mut registry = Self {\r\n            factories: HashMap::new(),\r\n        };\r\n        \r\n        // Register default factories\r\n        registry.register(\"Elektronik\".to_string(), Box::new(ElektronikFactory));\r\n        registry.register(\"Material\".to_string(), Box::new(MaterialFactory));\r\n        registry.register(\"Furnitur\".to_string(), Box::new(FurnitureFactory));\r\n        registry.register(\"Pipa \u0026 Sanitasi\".to_string(), Box::new(PlumbingFactory));\r\n        \r\n        registry\r\n    }\r\n    \r\n    pub fn register(\u0026mut self, kategori: String, factory: Box\u003cdyn ProdukFactory + Send + Sync\u003e) {\r\n        self.factories.insert(kategori, factory);\r\n    }\r\n    \r\n    pub fn get_factory(\u0026self, kategori: \u0026str) -\u003e Option\u003c\u0026(dyn ProdukFactory + Send + Sync)\u003e {\r\n        self.factories.get(kategori).map(|f| f.as_ref())\r\n    }\r\n    \r\n    pub fn create_produk(\u0026self, kategori: \u0026str, nama: String, harga: f64, stok: u32, deskripsi: Option\u003cString\u003e) -\u003e Option\u003cProduk\u003e {\r\n        self.get_factory(kategori).map(|factory| {\r\n            factory.create_produk(nama, harga, stok, deskripsi)\r\n        })\r\n    }\r\n}\r\n\r\n// Implementasi singleton untuk registry factory\r\nlazy_static! {\r\n    static ref REGISTRY: Arc\u003cMutex\u003cProdukFactoryRegistry\u003e\u003e = Arc::new(Mutex::new(ProdukFactoryRegistry::new()));\r\n}\r\n\r\npub fn get_produk_factory_registry() -\u003e Arc\u003cMutex\u003cProdukFactoryRegistry\u003e\u003e {\r\n    REGISTRY.clone()\r\n}\r\n\r\n// Object Pool Pattern untuk Produk Template\r\npub struct ProdukTemplatePool {\r\n    templates: HashMap\u003cString, Produk\u003e,\r\n}\r\n\r\nimpl ProdukTemplatePool {\r\n    fn new() -\u003e Self {\r\n        let mut pool = Self {\r\n            templates: HashMap::new(),\r\n        };\r\n        \r\n        // Add some default templates\r\n        pool.add_template(\r\n            \"laptop_gaming\".to_string(),\r\n            Produk::new(\r\n                \"Laptop Gaming Template\".to_string(),\r\n                \"Elektronik\".to_string(),\r\n                0.0,  // Placeholder price\r\n                0,    // Placeholder stock\r\n                Some(\"Laptop gaming dengan performa tinggi\".to_string()),\r\n            )\r\n        );\r\n        \r\n        pool.add_template(\r\n            \"smartphone\".to_string(),\r\n            Produk::new(\r\n                \"Smartphone Template\".to_string(),\r\n                \"Elektronik\".to_string(),\r\n                0.0,\r\n                0,\r\n                Some(\"Smartphone dengan kamera berkualitas\".to_string()),\r\n            )\r\n        );\r\n        \r\n        pool.add_template(\r\n            \"cat_tembok\".to_string(),\r\n            Produk::new(\r\n                \"Cat Tembok Template\".to_string(),\r\n                \"Material\".to_string(),\r\n                0.0,\r\n                0,\r\n                Some(\"Cat tembok dengan kualitas terbaik\".to_string()),\r\n            )\r\n        );\r\n        \r\n        pool\r\n    }\r\n    \r\n    pub fn add_template(\u0026mut self, key: String, template: Produk) {\r\n        self.templates.insert(key, template);\r\n    }\r\n    \r\n    pub fn get_template(\u0026self, key: \u0026str) -\u003e Option\u003c\u0026Produk\u003e {\r\n        self.templates.get(key)\r\n    }\r\n    \r\n    pub fn create_from_template(\u0026self, key: \u0026str, harga: f64, stok: u32) -\u003e Option\u003cProduk\u003e {\r\n        self.get_template(key).map(|template| {\r\n            Produk {\r\n                id: None,\r\n                nama: template.nama.clone(),\r\n                kategori: template.kategori.clone(),\r\n                harga,\r\n                stok,\r\n                deskripsi: template.deskripsi.clone(),\r\n                event_publisher: ProdukEventPublisher::new(),\r\n            }\r\n        })\r\n    }\r\n}\r\n\r\n// Implementasi singleton untuk template pool\r\nlazy_static! {\r\n    static ref TEMPLATE_POOL: Arc\u003cMutex\u003cProdukTemplatePool\u003e\u003e = Arc::new(Mutex::new(ProdukTemplatePool::new()));\r\n}\r\n\r\npub fn get_produk_template_pool() -\u003e Arc\u003cMutex\u003cProdukTemplatePool\u003e\u003e {\r\n    TEMPLATE_POOL.clone()\r\n}\r\n\r\n// Function untuk validasi produk - ekstrak ke function supaya bisa digunakan di berbagai tempat\r\npub fn validate_produk(\r\n    nama: \u0026str,\r\n    kategori: \u0026str,\r\n    harga: f64,\r\n    stok: u32,\r\n    deskripsi: \u0026Option\u003cString\u003e,\r\n) -\u003e Result\u003c(), Vec\u003cString\u003e\u003e {\r\n    let validator = ProdukValidator::default();\r\n    let produk = Produk::new(\r\n        nama.to_string(),\r\n        kategori.to_string(),\r\n        harga,\r\n        stok,\r\n        deskripsi.clone(),\r\n    );\r\n    \r\n    validator.validate(\u0026produk)\r\n}","traces":[{"line":30,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":38,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":42,"address":[],"length":0,"stats":{"Line":0}},{"line":43,"address":[],"length":0,"stats":{"Line":0}},{"line":44,"address":[],"length":0,"stats":{"Line":0}},{"line":47,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":48,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":49,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":52,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":53,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":54,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":57,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":58,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":59,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":62,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":64,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":66,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":67,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":68,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":69,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":70,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":71,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":72,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":75,"address":[],"length":0,"stats":{"Line":720575940379279360}},{"line":76,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":83,"address":[],"length":0,"stats":{"Line":3891110078048108544}},{"line":97,"address":[],"length":0,"stats":{"Line":3891110078048108544}},{"line":102,"address":[],"length":0,"stats":{"Line":0}},{"line":111,"address":[],"length":0,"stats":{"Line":0}},{"line":117,"address":[],"length":0,"stats":{"Line":0}},{"line":121,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":122,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":123,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":126,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":133,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":134,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":135,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":139,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":140,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":143,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":144,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":147,"address":[],"length":0,"stats":{"Line":0}},{"line":148,"address":[],"length":0,"stats":{"Line":0}},{"line":151,"address":[],"length":0,"stats":{"Line":0}},{"line":152,"address":[],"length":0,"stats":{"Line":0}},{"line":156,"address":[],"length":0,"stats":{"Line":0}},{"line":157,"address":[],"length":0,"stats":{"Line":0}},{"line":158,"address":[],"length":0,"stats":{"Line":0}},{"line":161,"address":[],"length":0,"stats":{"Line":0}},{"line":162,"address":[],"length":0,"stats":{"Line":0}},{"line":163,"address":[],"length":0,"stats":{"Line":0}},{"line":164,"address":[],"length":0,"stats":{"Line":0}},{"line":165,"address":[],"length":0,"stats":{"Line":0}},{"line":166,"address":[],"length":0,"stats":{"Line":0}},{"line":167,"address":[],"length":0,"stats":{"Line":0}},{"line":168,"address":[],"length":0,"stats":{"Line":0}},{"line":172,"address":[],"length":0,"stats":{"Line":0}},{"line":174,"address":[],"length":0,"stats":{"Line":0}},{"line":175,"address":[],"length":0,"stats":{"Line":0}},{"line":176,"address":[],"length":0,"stats":{"Line":0}},{"line":177,"address":[],"length":0,"stats":{"Line":0}},{"line":179,"address":[],"length":0,"stats":{"Line":0}},{"line":180,"address":[],"length":0,"stats":{"Line":0}},{"line":184,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":185,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":188,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":189,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":190,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":191,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":194,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":195,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":196,"address":[],"length":0,"stats":{"Line":0}},{"line":199,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":200,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":203,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":214,"address":[],"length":0,"stats":{"Line":0}},{"line":215,"address":[],"length":0,"stats":{"Line":0}},{"line":221,"address":[],"length":0,"stats":{"Line":0}},{"line":222,"address":[],"length":0,"stats":{"Line":0}},{"line":228,"address":[],"length":0,"stats":{"Line":0}},{"line":229,"address":[],"length":0,"stats":{"Line":0}},{"line":235,"address":[],"length":0,"stats":{"Line":0}},{"line":236,"address":[],"length":0,"stats":{"Line":0}},{"line":246,"address":[],"length":0,"stats":{"Line":0}},{"line":248,"address":[],"length":0,"stats":{"Line":0}},{"line":252,"address":[],"length":0,"stats":{"Line":0}},{"line":253,"address":[],"length":0,"stats":{"Line":0}},{"line":254,"address":[],"length":0,"stats":{"Line":0}},{"line":255,"address":[],"length":0,"stats":{"Line":0}},{"line":257,"address":[],"length":0,"stats":{"Line":0}},{"line":260,"address":[],"length":0,"stats":{"Line":0}},{"line":261,"address":[],"length":0,"stats":{"Line":0}},{"line":264,"address":[],"length":0,"stats":{"Line":0}},{"line":265,"address":[],"length":0,"stats":{"Line":0}},{"line":268,"address":[],"length":0,"stats":{"Line":0}},{"line":269,"address":[],"length":0,"stats":{"Line":0}},{"line":270,"address":[],"length":0,"stats":{"Line":0}},{"line":280,"address":[],"length":0,"stats":{"Line":0}},{"line":281,"address":[],"length":0,"stats":{"Line":0}},{"line":290,"address":[],"length":0,"stats":{"Line":0}},{"line":292,"address":[],"length":0,"stats":{"Line":0}},{"line":296,"address":[],"length":0,"stats":{"Line":0}},{"line":297,"address":[],"length":0,"stats":{"Line":0}},{"line":298,"address":[],"length":0,"stats":{"Line":0}},{"line":299,"address":[],"length":0,"stats":{"Line":0}},{"line":300,"address":[],"length":0,"stats":{"Line":0}},{"line":301,"address":[],"length":0,"stats":{"Line":0}},{"line":302,"address":[],"length":0,"stats":{"Line":0}},{"line":303,"address":[],"length":0,"stats":{"Line":0}},{"line":307,"address":[],"length":0,"stats":{"Line":0}},{"line":308,"address":[],"length":0,"stats":{"Line":0}},{"line":309,"address":[],"length":0,"stats":{"Line":0}},{"line":310,"address":[],"length":0,"stats":{"Line":0}},{"line":311,"address":[],"length":0,"stats":{"Line":0}},{"line":312,"address":[],"length":0,"stats":{"Line":0}},{"line":313,"address":[],"length":0,"stats":{"Line":0}},{"line":314,"address":[],"length":0,"stats":{"Line":0}},{"line":318,"address":[],"length":0,"stats":{"Line":0}},{"line":319,"address":[],"length":0,"stats":{"Line":0}},{"line":320,"address":[],"length":0,"stats":{"Line":0}},{"line":321,"address":[],"length":0,"stats":{"Line":0}},{"line":322,"address":[],"length":0,"stats":{"Line":0}},{"line":323,"address":[],"length":0,"stats":{"Line":0}},{"line":324,"address":[],"length":0,"stats":{"Line":0}},{"line":325,"address":[],"length":0,"stats":{"Line":0}},{"line":329,"address":[],"length":0,"stats":{"Line":0}},{"line":332,"address":[],"length":0,"stats":{"Line":0}},{"line":333,"address":[],"length":0,"stats":{"Line":0}},{"line":336,"address":[],"length":0,"stats":{"Line":0}},{"line":337,"address":[],"length":0,"stats":{"Line":0}},{"line":340,"address":[],"length":0,"stats":{"Line":0}},{"line":341,"address":[],"length":0,"stats":{"Line":0}},{"line":342,"address":[],"length":0,"stats":{"Line":0}},{"line":343,"address":[],"length":0,"stats":{"Line":0}},{"line":344,"address":[],"length":0,"stats":{"Line":0}},{"line":345,"address":[],"length":0,"stats":{"Line":0}},{"line":346,"address":[],"length":0,"stats":{"Line":0}},{"line":347,"address":[],"length":0,"stats":{"Line":0}},{"line":348,"address":[],"length":0,"stats":{"Line":0}},{"line":349,"address":[],"length":0,"stats":{"Line":0}},{"line":360,"address":[],"length":0,"stats":{"Line":0}},{"line":361,"address":[],"length":0,"stats":{"Line":0}},{"line":365,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":372,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":374,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":375,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":376,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":377,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":378,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":381,"address":[],"length":0,"stats":{"Line":432345564227567616}}],"covered":54,"coverable":150},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_produk","produk","repository.rs"],"content":"// use rocket_db_pools::Connection;\r\nuse rocket_db_pools::sqlx::{self, PgConnection, Error, Row};\r\n// use crate::BuildingStoreDB;\r\nuse super::model::Produk;\r\n\r\npub struct ProdukRepository;\r\n\r\nimpl ProdukRepository {\r\n    pub async fn tambah_produk(db: \u0026mut PgConnection, produk: \u0026Produk) -\u003e Result\u003ci64, Error\u003e {\r\n        let result = sqlx::query(\r\n            \"INSERT INTO produk (nama, kategori, harga, stok, deskripsi) VALUES ($1, $2, $3, $4, $5) RETURNING id\"\r\n        )\r\n        .bind(\u0026produk.nama)\r\n        .bind(\u0026produk.kategori)\r\n        .bind(produk.harga)\r\n        .bind(produk.stok as i32)  // Cast to i32\r\n        .bind(\u0026produk.deskripsi)\r\n        .fetch_one(db)\r\n        .await?;\r\n    \r\n        Ok(result.get(\"id\"))\r\n    }\r\n    \r\n    pub async fn ambil_semua_produk(db: \u0026mut PgConnection) -\u003e Result\u003cVec\u003cProduk\u003e, Error\u003e {\r\n        let rows = sqlx::query(\r\n            \"SELECT id, nama, kategori, harga, stok, deskripsi FROM produk\"\r\n        )\r\n        .fetch_all(db)\r\n        .await?;\r\n        \r\n        let produk_list = rows.iter().map(|row| {\r\n            Produk::with_id(\r\n                row.get(\"id\"),\r\n                row.get(\"nama\"),\r\n                row.get(\"kategori\"),\r\n                row.get(\"harga\"),\r\n                row.get::\u003ci32, _\u003e(\"stok\") as u32,  // Convert i32 to u32\r\n                row.get(\"deskripsi\"),\r\n            )\r\n        }).collect();\r\n        \r\n        Ok(produk_list)\r\n    }\r\n    \r\n    pub async fn ambil_produk_by_id(db: \u0026mut PgConnection, id: i64) -\u003e Result\u003cOption\u003cProduk\u003e, Error\u003e {\r\n        let maybe_row = sqlx::query(\r\n            \"SELECT id, nama, kategori, harga, stok, deskripsi FROM produk WHERE id = $1\"\r\n        )\r\n        .bind(id)\r\n        .fetch_optional(db)\r\n        .await?;\r\n        \r\n        match maybe_row {\r\n            Some(row) =\u003e Ok(Some(Produk::with_id(\r\n                row.get(\"id\"),\r\n                row.get(\"nama\"),\r\n                row.get(\"kategori\"),\r\n                row.get(\"harga\"),\r\n                row.get::\u003ci32, _\u003e(\"stok\") as u32,  // Convert i32 to u32\r\n                row.get(\"deskripsi\"),\r\n            ))),\r\n            None =\u003e Ok(None)\r\n        }\r\n    }\r\n    \r\n    pub async fn filter_produk_by_kategori(db: \u0026mut PgConnection, kategori: \u0026str) -\u003e Result\u003cVec\u003cProduk\u003e, Error\u003e {\r\n        let rows = sqlx::query(\r\n            \"SELECT id, nama, kategori, harga, stok, deskripsi FROM produk WHERE kategori = $1\"\r\n        )\r\n        .bind(kategori)\r\n        .fetch_all(db)\r\n        .await?;\r\n        \r\n        let produk_list = rows.iter().map(|row| {\r\n            Produk::with_id(\r\n                row.get(\"id\"),\r\n                row.get(\"nama\"),\r\n                row.get(\"kategori\"),\r\n                row.get(\"harga\"),\r\n                row.get::\u003ci32, _\u003e(\"stok\") as u32,  // Convert i32 to u32\r\n                row.get(\"deskripsi\"),\r\n            )\r\n        }).collect();\r\n        \r\n        Ok(produk_list)\r\n    }\r\n    \r\n    pub async fn update_produk(db: \u0026mut PgConnection, id: i64, produk: \u0026Produk) -\u003e Result\u003cbool, Error\u003e {\r\n        let result = sqlx::query(\r\n            \"UPDATE produk SET nama = $1, kategori = $2, harga = $3, stok = $4, deskripsi = $5 WHERE id = $6\"\r\n        )\r\n        .bind(\u0026produk.nama)\r\n        .bind(\u0026produk.kategori)\r\n        .bind(produk.harga)\r\n        .bind(produk.stok as i32)  // Cast to i32\r\n        .bind(\u0026produk.deskripsi)\r\n        .bind(id)\r\n        .execute(db)\r\n        .await?;\r\n        \r\n        Ok(result.rows_affected() \u003e 0)\r\n    }\r\n    \r\n    pub async fn hapus_produk(db: \u0026mut PgConnection, id: i64) -\u003e Result\u003cbool, Error\u003e {\r\n        let result = sqlx::query(\"DELETE FROM produk WHERE id = $1\")\r\n            .bind(id)\r\n            .execute(db)\r\n            .await?;\r\n            \r\n        Ok(result.rows_affected() \u003e 0)\r\n    }\r\n    \r\n    // Tambahan: Metode untuk mencari produk berdasarkan harga\r\n    pub async fn filter_produk_by_price_range(\r\n        db: \u0026mut PgConnection, \r\n        min_price: f64, \r\n        max_price: f64\r\n    ) -\u003e Result\u003cVec\u003cProduk\u003e, Error\u003e {\r\n        let rows = sqlx::query(\r\n            \"SELECT id, nama, kategori, harga, stok, deskripsi FROM produk WHERE harga \u003e= $1 AND harga \u003c= $2\"\r\n        )\r\n        .bind(min_price)\r\n        .bind(max_price)\r\n        .fetch_all(db)\r\n        .await?;\r\n        \r\n        let produk_list = rows.iter().map(|row| {\r\n            Produk::with_id(\r\n                row.get(\"id\"),\r\n                row.get(\"nama\"),\r\n                row.get(\"kategori\"),\r\n                row.get(\"harga\"),\r\n                row.get::\u003ci32, _\u003e(\"stok\") as u32,  // Convert i32 to u32\r\n                row.get(\"deskripsi\"),\r\n            )\r\n        }).collect();\r\n        \r\n        Ok(produk_list)\r\n    }\r\n    \r\n    // Tambahan: Metode untuk mencari produk berdasarkan stok\r\n    pub async fn filter_produk_by_stock_availability(db: \u0026mut PgConnection, min_stock: u32) -\u003e Result\u003cVec\u003cProduk\u003e, Error\u003e {\r\n        let rows = sqlx::query(\r\n            \"SELECT id, nama, kategori, harga, stok, deskripsi FROM produk WHERE stok \u003e= $1\"\r\n        )\r\n        .bind(min_stock as i32)  // Cast to i32\r\n        .fetch_all(db)\r\n        .await?;\r\n        \r\n        let produk_list = rows.iter().map(|row| {\r\n            Produk::with_id(\r\n                row.get(\"id\"),\r\n                row.get(\"nama\"),\r\n                row.get(\"kategori\"),\r\n                row.get(\"harga\"),\r\n                row.get::\u003ci32, _\u003e(\"stok\") as u32,  // Convert i32 to u32\r\n                row.get(\"deskripsi\"),\r\n            )\r\n        }).collect();\r\n        \r\n        Ok(produk_list)\r\n    }\r\n}","traces":[{"line":9,"address":[],"length":0,"stats":{"Line":0}},{"line":13,"address":[],"length":0,"stats":{"Line":0}},{"line":14,"address":[],"length":0,"stats":{"Line":0}},{"line":15,"address":[],"length":0,"stats":{"Line":0}},{"line":16,"address":[],"length":0,"stats":{"Line":0}},{"line":17,"address":[],"length":0,"stats":{"Line":0}},{"line":18,"address":[],"length":0,"stats":{"Line":0}},{"line":19,"address":[],"length":0,"stats":{"Line":0}},{"line":21,"address":[],"length":0,"stats":{"Line":0}},{"line":24,"address":[],"length":0,"stats":{"Line":0}},{"line":28,"address":[],"length":0,"stats":{"Line":0}},{"line":29,"address":[],"length":0,"stats":{"Line":0}},{"line":31,"address":[],"length":0,"stats":{"Line":0}},{"line":32,"address":[],"length":0,"stats":{"Line":0}},{"line":33,"address":[],"length":0,"stats":{"Line":0}},{"line":34,"address":[],"length":0,"stats":{"Line":0}},{"line":35,"address":[],"length":0,"stats":{"Line":0}},{"line":36,"address":[],"length":0,"stats":{"Line":0}},{"line":37,"address":[],"length":0,"stats":{"Line":0}},{"line":38,"address":[],"length":0,"stats":{"Line":0}},{"line":40,"address":[],"length":0,"stats":{"Line":0}},{"line":42,"address":[],"length":0,"stats":{"Line":0}},{"line":45,"address":[],"length":0,"stats":{"Line":0}},{"line":49,"address":[],"length":0,"stats":{"Line":0}},{"line":50,"address":[],"length":0,"stats":{"Line":0}},{"line":51,"address":[],"length":0,"stats":{"Line":0}},{"line":53,"address":[],"length":0,"stats":{"Line":0}},{"line":54,"address":[],"length":0,"stats":{"Line":0}},{"line":55,"address":[],"length":0,"stats":{"Line":0}},{"line":56,"address":[],"length":0,"stats":{"Line":0}},{"line":57,"address":[],"length":0,"stats":{"Line":0}},{"line":58,"address":[],"length":0,"stats":{"Line":0}},{"line":59,"address":[],"length":0,"stats":{"Line":0}},{"line":60,"address":[],"length":0,"stats":{"Line":0}},{"line":62,"address":[],"length":0,"stats":{"Line":0}},{"line":66,"address":[],"length":0,"stats":{"Line":0}},{"line":70,"address":[],"length":0,"stats":{"Line":0}},{"line":71,"address":[],"length":0,"stats":{"Line":0}},{"line":72,"address":[],"length":0,"stats":{"Line":0}},{"line":74,"address":[],"length":0,"stats":{"Line":0}},{"line":75,"address":[],"length":0,"stats":{"Line":0}},{"line":76,"address":[],"length":0,"stats":{"Line":0}},{"line":77,"address":[],"length":0,"stats":{"Line":0}},{"line":78,"address":[],"length":0,"stats":{"Line":0}},{"line":79,"address":[],"length":0,"stats":{"Line":0}},{"line":80,"address":[],"length":0,"stats":{"Line":0}},{"line":81,"address":[],"length":0,"stats":{"Line":0}},{"line":83,"address":[],"length":0,"stats":{"Line":0}},{"line":85,"address":[],"length":0,"stats":{"Line":0}},{"line":88,"address":[],"length":0,"stats":{"Line":0}},{"line":92,"address":[],"length":0,"stats":{"Line":0}},{"line":93,"address":[],"length":0,"stats":{"Line":0}},{"line":94,"address":[],"length":0,"stats":{"Line":0}},{"line":95,"address":[],"length":0,"stats":{"Line":0}},{"line":96,"address":[],"length":0,"stats":{"Line":0}},{"line":97,"address":[],"length":0,"stats":{"Line":0}},{"line":98,"address":[],"length":0,"stats":{"Line":0}},{"line":99,"address":[],"length":0,"stats":{"Line":0}},{"line":101,"address":[],"length":0,"stats":{"Line":0}},{"line":104,"address":[],"length":0,"stats":{"Line":0}},{"line":105,"address":[],"length":0,"stats":{"Line":0}},{"line":106,"address":[],"length":0,"stats":{"Line":0}},{"line":107,"address":[],"length":0,"stats":{"Line":0}},{"line":108,"address":[],"length":0,"stats":{"Line":0}},{"line":110,"address":[],"length":0,"stats":{"Line":0}},{"line":114,"address":[],"length":0,"stats":{"Line":0}},{"line":122,"address":[],"length":0,"stats":{"Line":0}},{"line":123,"address":[],"length":0,"stats":{"Line":0}},{"line":124,"address":[],"length":0,"stats":{"Line":0}},{"line":125,"address":[],"length":0,"stats":{"Line":0}},{"line":127,"address":[],"length":0,"stats":{"Line":0}},{"line":128,"address":[],"length":0,"stats":{"Line":0}},{"line":129,"address":[],"length":0,"stats":{"Line":0}},{"line":130,"address":[],"length":0,"stats":{"Line":0}},{"line":131,"address":[],"length":0,"stats":{"Line":0}},{"line":132,"address":[],"length":0,"stats":{"Line":0}},{"line":133,"address":[],"length":0,"stats":{"Line":0}},{"line":134,"address":[],"length":0,"stats":{"Line":0}},{"line":136,"address":[],"length":0,"stats":{"Line":0}},{"line":138,"address":[],"length":0,"stats":{"Line":0}},{"line":142,"address":[],"length":0,"stats":{"Line":0}},{"line":146,"address":[],"length":0,"stats":{"Line":0}},{"line":147,"address":[],"length":0,"stats":{"Line":0}},{"line":148,"address":[],"length":0,"stats":{"Line":0}},{"line":150,"address":[],"length":0,"stats":{"Line":0}},{"line":151,"address":[],"length":0,"stats":{"Line":0}},{"line":152,"address":[],"length":0,"stats":{"Line":0}},{"line":153,"address":[],"length":0,"stats":{"Line":0}},{"line":154,"address":[],"length":0,"stats":{"Line":0}},{"line":155,"address":[],"length":0,"stats":{"Line":0}},{"line":156,"address":[],"length":0,"stats":{"Line":0}},{"line":157,"address":[],"length":0,"stats":{"Line":0}},{"line":159,"address":[],"length":0,"stats":{"Line":0}},{"line":161,"address":[],"length":0,"stats":{"Line":0}}],"covered":0,"coverable":94},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_produk","produk","tests","controller_test.rs"],"content":"#[cfg(test)]\r\nmod tests {\r\n    use super::*;\r\n    use rocket::local::blocking::Client;\r\n    use rocket::http::{Status, ContentType};\r\n    use rocket::serde::json;\r\n    use crate::BuildingStoreDB;\r\n    use std::collections::HashMap;\r\n    use std::sync::{Arc, Mutex};\r\n\r\n    // Mock database implementation\r\n    struct MockProdukRepository;\r\n    \r\n    impl ProdukRepository for MockProdukRepository {\r\n        // Implement all repository methods with mock responses\r\n    }\r\n\r\n    // Test setup\r\n    fn setup_rocket() -\u003e rocket::Rocket\u003crocket::Build\u003e {\r\n        rocket::build()\r\n            .manage(Arc::new(Mutex::new(MockProdukRepository)))\r\n            .mount(\"/\", routes())\r\n    }\r\n\r\n    #[test]\r\n    fn test_list_produk_success() {\r\n        let client = Client::tracked(setup_rocket()).unwrap();\r\n        let response = client.get(\"/produk\").dispatch();\r\n        \r\n        assert_eq!(response.status(), Status::Ok);\r\n        let api_response = response.into_json::\u003cApiResponse\u003cVec\u003cProdukResponse\u003e\u003e\u003e();\r\n        assert!(api_response.success);\r\n        assert!(!api_response.data.unwrap().is_empty());\r\n    }\r\n\r\n    #[test]\r\n    fn test_detail_produk_found() {\r\n        let client = Client::tracked(setup_rocket()).unwrap();\r\n        let response = client.get(\"/produk/1\").dispatch();\r\n        \r\n        assert_eq!(response.status(), Status::Ok);\r\n        let api_response = response.into_json::\u003cApiResponse\u003cProdukResponse\u003e\u003e();\r\n        assert!(api_response.success);\r\n        assert_eq!(api_response.data.unwrap().id, Some(1));\r\n    }\r\n\r\n    #[test]\r\n    fn test_tambah_produk_success() {\r\n        let client = Client::tracked(setup_rocket()).unwrap();\r\n        let produk_request = ProdukRequest {\r\n            nama: \"New Product\".into(),\r\n            kategori: \"Test\".into(),\r\n            harga: 100.0,\r\n            stok: 10,\r\n            deskripsi: None\r\n        };\r\n\r\n        let response = client.post(\"/produk\")\r\n            .header(ContentType::JSON)\r\n            .body(json::to_string(\u0026produk_request).unwrap())\r\n            .dispatch();\r\n\r\n        assert_eq!(response.status(), Status::Created);\r\n        let api_response = response.into_json::\u003cApiResponse\u003cProdukResponse\u003e\u003e();\r\n        assert!(api_response.success);\r\n    }\r\n\r\n    #[test]\r\n    fn test_update_produk_invalid() {\r\n        let client = Client::tracked(setup_rocket()).unwrap();\r\n        let invalid_request = ProdukRequest {\r\n            nama: \"\".into(),  // Invalid empty name\r\n            kategori: \"Test\".into(),\r\n            harga: -50.0,     // Invalid negative price\r\n            stok: 5,\r\n            deskripsi: None\r\n        };\r\n\r\n        let response = client.put(\"/produk/1\")\r\n            .header(ContentType::JSON)\r\n            .body(json::to_string(\u0026invalid_request).unwrap())\r\n            .dispatch();\r\n\r\n        assert_eq!(response.status(), Status::BadRequest);\r\n        let api_response = response.into_json::\u003cApiResponse\u003cProdukResponse\u003e\u003e();\r\n        assert!(!api_response.success);\r\n        assert!(api_response.message.unwrap().contains(\"Validasi gagal\"));\r\n    }\r\n\r\n    #[test]\r\n    fn test_filter_by_price() {\r\n        let client = Client::tracked(setup_rocket()).unwrap();\r\n        let response = client.get(\"/produk/harga?min=100\u0026max=500\").dispatch();\r\n        \r\n        assert_eq!(response.status(), Status::Ok);\r\n        let api_response = response.into_json::\u003cApiResponse\u003cVec\u003cProdukResponse\u003e\u003e\u003e();\r\n        assert!(api_response.success);\r\n        assert_eq!(api_response.data.unwrap().len(), 3);\r\n    }\r\n\r\n    #[test]\r\n    fn test_clone_produk_with_price() {\r\n        let client = Client::tracked(setup_rocket()).unwrap();\r\n        let request = ProdukRequest {\r\n            nama: \"Cloned Product\".into(),\r\n            kategori: \"Test\".into(),\r\n            harga: 150.0,\r\n            stok: 5,\r\n            deskripsi: None\r\n        };\r\n\r\n        let response = client.post(\"/produk/1/clone_with_price\")\r\n            .header(ContentType::JSON)\r\n            .body(json::to_string(\u0026request).unwrap())\r\n            .dispatch();\r\n\r\n        assert_eq!(response.status(), Status::Created);\r\n        let api_response = response.into_json::\u003cApiResponse\u003cProdukResponse\u003e\u003e();\r\n        assert!(api_response.success);\r\n        assert_eq!(api_response.data.unwrap().harga, 150.0);\r\n    }\r\n\r\n    #[test]\r\n    fn test_update_stock_with_observer() {\r\n        let client = Client::tracked(setup_rocket()).unwrap();\r\n        let response = client.post(\"/produk/1/update_stock\")\r\n            .header(ContentType::JSON)\r\n            .body(json::to_string(\u002625).unwrap())\r\n            .dispatch();\r\n\r\n        assert_eq!(response.status(), Status::Ok);\r\n        let api_response = response.into_json::\u003cApiResponse\u003c()\u003e\u003e();\r\n        assert!(api_response.success);\r\n        \r\n        // Verify observer was called through mock implementation\r\n    }\r\n}","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_produk","produk","tests","create.rs"],"content":"use super::super::model::{Produk, validate_produk};\r\nuse crate::manajemen_produk::produk::model::ProdukBuilder;\r\n\r\n#[test]\r\nfn test_create_produk_baru() {\r\n    let produk = Produk::new(\r\n        \"Laptop Gaming\".to_string(),\r\n        \"Elektronik\".to_string(),\r\n        15_000_000.0,\r\n        10,\r\n        Some(\"Laptop dengan RTX 4060\".to_string()),\r\n    );\r\n\r\n    assert_eq!(produk.nama, \"Laptop Gaming\");\r\n    assert_eq!(produk.kategori, \"Elektronik\");\r\n    assert_eq!(produk.harga, 15_000_000.0);\r\n    assert_eq!(produk.stok, 10);\r\n    assert_eq!(produk.deskripsi, Some(\"Laptop dengan RTX 4060\".to_string()));\r\n}\r\n\r\n#[test]\r\nfn test_create_produk_without_deskripsi() {\r\n    let produk = Produk::new(\r\n        \"Cat Tembok\".to_string(),\r\n        \"Material\".to_string(),\r\n        150_000.0,\r\n        50,\r\n        None,\r\n    );\r\n\r\n    assert_eq!(produk.nama, \"Cat Tembok\");\r\n    assert_eq!(produk.kategori, \"Material\");\r\n    assert_eq!(produk.harga, 150_000.0);\r\n    assert_eq!(produk.stok, 50);\r\n    assert_eq!(produk.deskripsi, None);\r\n}\r\n\r\n#[test]\r\nfn test_validasi_produk() {\r\n    // Testing valid product\r\n    let result = validate_produk(\r\n        \u0026\"Laptop Gaming\".to_string(),  // Add reference\r\n        \u0026\"Elektronik\".to_string(),     // Add reference\r\n        15_000_000.0,\r\n        10,\r\n        \u0026Some(\"Laptop dengan RTX 4060\".to_string()),  // Add reference\r\n    );\r\n    assert!(result.is_ok());\r\n    \r\n    // Testing invalid product (empty name)\r\n    let result = validate_produk(\r\n        \u0026\"\".to_string(),               // Add reference\r\n        \u0026\"Elektronik\".to_string(),     // Add reference\r\n        15_000_000.0,\r\n        10,\r\n        \u0026Some(\"Laptop dengan RTX 4060\".to_string()),  // Add reference\r\n    );\r\n    assert!(result.is_err());\r\n    assert_eq!(result.unwrap_err(), vec![\"Nama produk tidak boleh kosong\"]);\r\n    \r\n    // Testing invalid product (negative price)\r\n    let result = validate_produk(\r\n        \u0026\"Laptop Gaming\".to_string(),  // Add reference\r\n        \u0026\"Elektronik\".to_string(),     // Add reference\r\n        -5000.0,\r\n        10,\r\n        \u0026Some(\"Laptop dengan RTX 4060\".to_string()),  // Add reference\r\n    );\r\n    assert!(result.is_err());\r\n    assert_eq!(result.unwrap_err(), vec![\"Harga tidak boleh negatif\"]);\r\n}\r\n\r\n#[test]\r\nfn test_create_with_validation() {\r\n    // Testing valid product creation\r\n    let result = Produk::create_with_validation(\r\n        \"Laptop Gaming\".to_string(),\r\n        \"Elektronik\".to_string(),\r\n        15_000_000.0,\r\n        10,\r\n        Some(\"Laptop dengan RTX 4060\".to_string()),\r\n    );\r\n    assert!(result.is_ok());\r\n    \r\n    // Testing invalid product creation (empty name)\r\n    let result = Produk::create_with_validation(\r\n        \"\".to_string(),\r\n        \"Elektronik\".to_string(),\r\n        15_000_000.0,\r\n        10,\r\n        Some(\"Laptop dengan RTX 4060\".to_string()),\r\n    );\r\n    assert!(result.is_err());\r\n    assert_eq!(result.unwrap_err(), vec![\"Nama produk tidak boleh kosong\"]);\r\n}\r\n\r\n#[test]\r\nfn test_produk_builder() {\r\n    // Using the builder pattern\r\n    let produk_result = ProdukBuilder::new(\"Laptop Gaming\".to_string(), \"Elektronik\".to_string())\r\n        .harga(15_000_000.0)\r\n        .stok(10)\r\n        .deskripsi(\"Laptop dengan RTX 4060\".to_string())\r\n        .build();\r\n    \r\n    assert!(produk_result.is_ok());\r\n    let produk = produk_result.unwrap();\r\n    \r\n    assert_eq!(produk.nama, \"Laptop Gaming\");\r\n    assert_eq!(produk.kategori, \"Elektronik\");\r\n    assert_eq!(produk.harga, 15_000_000.0);\r\n    assert_eq!(produk.stok, 10);\r\n    assert_eq!(produk.deskripsi, Some(\"Laptop dengan RTX 4060\".to_string()));\r\n}\r\n\r\n#[test]\r\nfn test_builder_validation() {\r\n    // Test validation with empty name\r\n    let produk_result = ProdukBuilder::new(\"\".to_string(), \"Elektronik\".to_string())\r\n        .harga(15_000_000.0)\r\n        .stok(10)\r\n        .build();\r\n    \r\n    assert!(produk_result.is_err());\r\n    assert_eq!(produk_result.unwrap_err(), vec![\"Nama produk tidak boleh kosong\"]);\r\n    \r\n    // Test validation with negative price\r\n    let produk_result = ProdukBuilder::new(\"Laptop Gaming\".to_string(), \"Elektronik\".to_string())\r\n        .harga(-5000.0)\r\n        .stok(10)\r\n        .build();\r\n    \r\n    assert!(produk_result.is_err());\r\n    assert_eq!(produk_result.unwrap_err(), vec![\"Harga tidak boleh negatif\"]);\r\n}\r\n\r\n#[test]\r\nfn test_produk_factory_methods() {\r\n    // Using the factory method for laptops\r\n    let laptop = Produk::create_laptop(\r\n        \"Gaming Laptop\".to_string(),\r\n        12_000_000.0,\r\n        5,\r\n        Some(\"High-performance gaming laptop\".to_string())\r\n    );\r\n    \r\n    assert_eq!(laptop.nama, \"Gaming Laptop\");\r\n    assert_eq!(laptop.kategori, \"Elektronik\");\r\n    assert_eq!(laptop.harga, 12_000_000.0);\r\n    assert_eq!(laptop.stok, 5);\r\n    \r\n    // Using the factory method for building materials\r\n    let material = Produk::create_building_material(\r\n        \"Semen\".to_string(),\r\n        75_000.0,\r\n        100,\r\n        Some(\"Semen tahan air\".to_string())\r\n    );\r\n    \r\n    assert_eq!(material.nama, \"Semen\");\r\n    assert_eq!(material.kategori, \"Material\");\r\n    assert_eq!(material.harga, 75_000.0);\r\n    assert_eq!(material.stok, 100);\r\n}","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_produk","produk","tests","delete.rs"],"content":"use super::super::model::Produk;\r\n\r\n#[test]\r\nfn test_remove_produk_from_list() {\r\n    let produk1 = Produk::new(\r\n        \"Laptop Gaming\".to_string(),\r\n        \"Elektronik\".to_string(),\r\n        15_000_000.0,\r\n        10,\r\n        Some(\"Laptop dengan RTX 4060\".to_string()),\r\n    );\r\n    \r\n    let produk2 = Produk::new(\r\n        \"Cat Tembok\".to_string(),\r\n        \"Material\".to_string(),\r\n        150_000.0,\r\n        50,\r\n        Some(\"Cat tembok anti air\".to_string()),\r\n    );\r\n    \r\n    let produk3 = Produk::new(\r\n        \"Smartphone\".to_string(),\r\n        \"Elektronik\".to_string(),\r\n        8_000_000.0,\r\n        20,\r\n        Some(\"Smartphone dengan kamera 108MP\".to_string()),\r\n    );\r\n    \r\n    let mut produk_list = vec![produk1, produk2, produk3];\r\n    \r\n    // Remove produk dari list (misalnya berdasarkan nama)\r\n    produk_list.retain(|p| p.nama != \"Cat Tembok\");\r\n    \r\n    assert_eq!(produk_list.len(), 2);\r\n    assert_eq!(produk_list[0].nama, \"Laptop Gaming\");\r\n    assert_eq!(produk_list[1].nama, \"Smartphone\");\r\n}","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_produk","produk","tests","event_observer.rs"],"content":"use crate::manajemen_produk::produk::events::ProdukObserver;\r\nuse crate::manajemen_produk::produk::model::Produk;\r\nuse std::sync::{Arc, Mutex};\r\n\r\n#[derive(Debug)]\r\nstruct MockObserver {\r\n    notified: Arc\u003cMutex\u003cu32\u003e\u003e,\r\n}\r\n\r\nimpl MockObserver {\r\n    fn new() -\u003e Self {\r\n        Self {\r\n            notified: Arc::new(Mutex::new(0)),\r\n        }\r\n    }\r\n\r\n    fn count(\u0026self) -\u003e u32 {\r\n        *self.notified.lock().unwrap()\r\n    }\r\n}\r\n\r\nimpl ProdukObserver for MockObserver {\r\n    fn on_stock_changed(\u0026self, _produk: \u0026Produk, _old_stock: u32) {\r\n        let mut count = self.notified.lock().unwrap();\r\n        *count += 1;\r\n    }\r\n}\r\n\r\n#[test]\r\nfn test_stock_updated_event() {\r\n    let mut produk = Produk::new(\r\n        \"Laptop\".to_string(),\r\n        \"Elektronik\".to_string(),\r\n        1000.0,\r\n        10,\r\n        None,\r\n    );\r\n\r\n    let observer = Arc::new(MockObserver::new());\r\n\r\n    produk.add_observer(observer.clone());\r\n    produk.set_stok(5); // Should trigger observer\r\n\r\n    assert_eq!(observer.count(), 1);\r\n}","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_produk","produk","tests","mod.rs"],"content":"pub mod create;\r\npub mod read;\r\npub mod update;\r\npub mod delete;\r\npub mod event_observer;\r\npub mod validation_strategy;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_produk","produk","tests","read.rs"],"content":"use super::super::model::Produk;\r\n\r\nfn setup_test_products() -\u003e Vec\u003cProduk\u003e {\r\n    vec![\r\n        Produk::new(\r\n            \"Laptop Gaming\".to_string(),\r\n            \"Elektronik\".to_string(),\r\n            15_000_000.0,\r\n            10,\r\n            Some(\"Laptop dengan RTX 4060\".to_string()),\r\n        ),\r\n        Produk::new(\r\n            \"Cat Tembok\".to_string(),\r\n            \"Material\".to_string(),\r\n            150_000.0,\r\n            50,\r\n            Some(\"Cat tembok anti air\".to_string()),\r\n        ),\r\n        Produk::new(\r\n            \"Smartphone\".to_string(),\r\n            \"Elektronik\".to_string(),\r\n            8_000_000.0,\r\n            20,\r\n            Some(\"Smartphone dengan kamera 108MP\".to_string()),\r\n        ),\r\n    ]\r\n}\r\n\r\n#[test]\r\nfn test_filter_produk_by_kategori() {\r\n    let produk_list = setup_test_products();\r\n    \r\n    // Filter produk elektronik\r\n    let elektronik_list: Vec\u003c\u0026Produk\u003e = produk_list.iter()\r\n        .filter(|p| p.kategori == \"Elektronik\")\r\n        .collect();\r\n    \r\n    assert_eq!(elektronik_list.len(), 2);\r\n    assert_eq!(elektronik_list[0].nama, \"Laptop Gaming\");\r\n    assert_eq!(elektronik_list[1].nama, \"Smartphone\");\r\n}\r\n\r\n#[test]\r\nfn test_sort_produk_by_harga() {\r\n    let mut produk_list = setup_test_products();\r\n    \r\n    // Sort by harga (ascending)\r\n    produk_list.sort_by(|a, b| a.harga.partial_cmp(\u0026b.harga).unwrap());\r\n    \r\n    assert_eq!(produk_list[0].nama, \"Cat Tembok\");\r\n    assert_eq!(produk_list[1].nama, \"Smartphone\");\r\n    assert_eq!(produk_list[2].nama, \"Laptop Gaming\");\r\n}\r\n\r\n#[test]\r\nfn test_find_produk_by_nama() {\r\n    let produk_list = setup_test_products();\r\n    \r\n    let found_produk = produk_list.iter()\r\n        .find(|p| p.nama == \"Smartphone\");\r\n    \r\n    assert!(found_produk.is_some());\r\n    let produk = found_produk.unwrap();\r\n    assert_eq!(produk.kategori, \"Elektronik\");\r\n    assert_eq!(produk.harga, 8_000_000.0);\r\n}","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_produk","produk","tests","update.rs"],"content":"use super::super::model::Produk;\r\n\r\n#[test]\r\nfn test_update_produk_harga() {\r\n    let mut produk = Produk::new(\r\n        \"Laptop Gaming\".to_string(),\r\n        \"Elektronik\".to_string(),\r\n        15_000_000.0,\r\n        10,\r\n        Some(\"Laptop dengan RTX 4060\".to_string()),\r\n    );\r\n    \r\n    // Update harga\r\n    produk.set_harga(14_500_000.0).unwrap();\r\n    \r\n    assert_eq!(produk.harga, 14_500_000.0);\r\n}\r\n\r\n#[test]\r\nfn test_update_produk_stok() {\r\n    let mut produk = Produk::new(\r\n        \"Laptop Gaming\".to_string(),\r\n        \"Elektronik\".to_string(),\r\n        15_000_000.0,\r\n        10,\r\n        Some(\"Laptop dengan RTX 4060\".to_string()),\r\n    );\r\n    \r\n    // Update stok\r\n    produk.set_stok(5);\r\n    \r\n    assert_eq!(produk.stok, 5);\r\n}\r\n\r\n#[test]\r\nfn test_update_produk_deskripsi() {\r\n    let mut produk = Produk::new(\r\n        \"Laptop Gaming\".to_string(),\r\n        \"Elektronik\".to_string(),\r\n        15_000_000.0,\r\n        10,\r\n        Some(\"Laptop dengan RTX 4060\".to_string()),\r\n    );\r\n    \r\n    // Update deskripsi\r\n    produk.deskripsi = Some(\"Laptop Gaming dengan RTX 4060 dan RAM 32GB\".to_string());\r\n    \r\n    assert_eq!(produk.deskripsi, Some(\"Laptop Gaming dengan RTX 4060 dan RAM 32GB\".to_string()));\r\n}","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_produk","produk","tests","validation_strategy.rs"],"content":"use crate::manajemen_produk::produk::model::Produk;\r\nuse crate::manajemen_produk::produk::validation::{ValidationRule, NamaNotEmpty, HargaNonNegatif};\r\n\r\n#[test]\r\nfn test_nama_not_empty_strategy() {\r\n    let strategy = NamaNotEmpty;\r\n    let mut produk = Produk::new(\"\".into(), \"Elektronik\".into(), 1000.0, 10, None);\r\n    assert!(strategy.validate(\u0026produk).is_err());\r\n\r\n    produk.nama = \"Laptop\".into();\r\n    assert!(strategy.validate(\u0026produk).is_ok());\r\n}\r\n\r\n#[test]\r\nfn test_harga_non_negatif_strategy() {\r\n    let strategy = HargaNonNegatif;\r\n    let mut produk = Produk::new(\"Laptop\".into(), \"Elektronik\".into(), -1000.0, 10, None);\r\n    assert!(strategy.validate(\u0026produk).is_err());\r\n\r\n    produk.harga = 1000.0;\r\n    assert!(strategy.validate(\u0026produk).is_ok());\r\n}","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_produk","produk","validation.rs"],"content":"use super::model::Produk;\r\n\r\npub trait ValidationRule {\r\n    fn validate(\u0026self, produk: \u0026Produk) -\u003e Result\u003c(), String\u003e;\r\n}\r\n\r\npub struct NamaNotEmpty;\r\nimpl ValidationRule for NamaNotEmpty {\r\n    fn validate(\u0026self, produk: \u0026Produk) -\u003e Result\u003c(), String\u003e {\r\n        if produk.nama.trim().is_empty() {\r\n            Err(\"Nama produk tidak boleh kosong\".to_string())\r\n        } else {\r\n            Ok(())\r\n        }\r\n    }\r\n}\r\n\r\npub struct HargaNonNegatif;\r\nimpl ValidationRule for HargaNonNegatif {\r\n    fn validate(\u0026self, produk: \u0026Produk) -\u003e Result\u003c(), String\u003e {\r\n        if produk.harga \u003c 0.0 {\r\n            Err(\"Harga tidak boleh negatif\".to_string())\r\n        } else {\r\n            Ok(())\r\n        }\r\n    }\r\n}\r\n\r\npub struct ProdukValidator {\r\n    rules: Vec\u003cBox\u003cdyn ValidationRule\u003e\u003e,\r\n}\r\n\r\nimpl ProdukValidator {\r\n    pub fn default() -\u003e Self {\r\n        Self {\r\n            rules: vec![\r\n                Box::new(NamaNotEmpty),\r\n                Box::new(HargaNonNegatif),\r\n            ],\r\n        }\r\n    }\r\n\r\n    pub fn validate(\u0026self, produk: \u0026Produk) -\u003e Result\u003c(), Vec\u003cString\u003e\u003e {\r\n        let errors = self.rules\r\n            .iter()\r\n            .filter_map(|rule| rule.validate(produk).err())\r\n            .collect::\u003cVec\u003c_\u003e\u003e();\r\n\r\n        if errors.is_empty() {\r\n            Ok(())\r\n        } else {\r\n            Err(errors)\r\n        }\r\n    }\r\n}\r\n","traces":[{"line":9,"address":[],"length":0,"stats":{"Line":1441151880758558720}},{"line":10,"address":[],"length":0,"stats":{"Line":1441151880758558720}},{"line":11,"address":[],"length":0,"stats":{"Line":576460752303423488}},{"line":13,"address":[],"length":0,"stats":{"Line":864691128455135232}},{"line":20,"address":[],"length":0,"stats":{"Line":1441151880758558720}},{"line":21,"address":[],"length":0,"stats":{"Line":1441151880758558720}},{"line":22,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":24,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":34,"address":[],"length":0,"stats":{"Line":1152921504606846976}},{"line":36,"address":[],"length":0,"stats":{"Line":1152921504606846976}},{"line":43,"address":[],"length":0,"stats":{"Line":1152921504606846976}},{"line":44,"address":[],"length":0,"stats":{"Line":1152921504606846976}},{"line":46,"address":[],"length":0,"stats":{"Line":4611686018427387904}},{"line":49,"address":[],"length":0,"stats":{"Line":1152921504606846976}},{"line":50,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":52,"address":[],"length":0,"stats":{"Line":720575940379279360}}],"covered":16,"coverable":16},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","main","controller","mod.rs"],"content":"pub mod supplier_controller;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","main","controller","supplier_controller.rs"],"content":"use std::sync::Arc;\r\n\r\nuse crate::manajemen_supplier::main::model::supplier::Supplier;\r\nuse crate::manajemen_supplier::main::service::supplier_service::SupplierService;\r\n\r\npub struct SupplierController {\r\n    supplier_service: Arc\u003cdyn SupplierService\u003e,\r\n}\r\n\r\nimpl SupplierController {\r\n    pub fn new(supplier_service: Arc\u003cdyn SupplierService\u003e) -\u003e Self {\r\n        Self { supplier_service }\r\n    }\r\n\r\n    pub fn save_supplier(\u0026self, supplier: Supplier) -\u003e Result\u003cSupplier, String\u003e {\r\n        self.supplier_service.save_supplier(supplier)\r\n    }\r\n\r\n    pub fn update_supplier(\u0026self, supplier: Supplier) -\u003e Result\u003c(), String\u003e {\r\n        self.supplier_service.update_supplier(supplier)\r\n    }\r\n\r\n    pub fn delete_supplier(\u0026self, id: \u0026str) -\u003e Result\u003c(), String\u003e {\r\n        self.supplier_service.delete_supplier(id)\r\n    }\r\n\r\n    pub fn get_supplier(\u0026self, id: \u0026str) -\u003e Option\u003cSupplier\u003e {\r\n        self.supplier_service.get_supplier(id)\r\n    }\r\n}","traces":[{"line":11,"address":[],"length":0,"stats":{"Line":504403158265495552}},{"line":15,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":16,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":19,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":20,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":23,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":24,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":27,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":28,"address":[],"length":0,"stats":{"Line":288230376151711744}}],"covered":9,"coverable":9},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","main","mod.rs"],"content":"pub mod model;\r\npub mod repository;\r\npub mod patterns;\r\npub mod controller;\r\npub mod service;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","main","model","mod.rs"],"content":"pub mod supplier;\r\npub mod supplier_transaction;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","main","model","supplier.rs"],"content":"use chrono::{DateTime, Utc};\r\n\r\n//sruct untuk supplier\r\n#[derive(Debug, Clone, PartialEq)]\r\npub struct Supplier {\r\n    pub id: String,\r\n    pub name: String,\r\n    pub jenis_barang: String,\r\n    pub jumlah_barang: i32,\r\n    pub resi: String,\r\n    pub updated_at: DateTime\u003cUtc\u003e\r\n}","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","main","model","supplier_transaction.rs"],"content":"use chrono::{DateTime, Utc};\r\n#[derive(Debug, Clone, PartialEq)]\r\npub struct SupplierTransaction {\r\n    pub id: String,\r\n    pub supplier_id: String,\r\n    pub supplier_name: String,\r\n    pub jenis_barang: String,\r\n    pub jumlah_barang: i32,\r\n    pub pengiriman_info: String,\r\n    pub tanggal_transaksi: DateTime\u003cUtc\u003e,\r\n}","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","main","patterns","factory.rs"],"content":"use chrono::Utc;\r\nuse uuid::Uuid;\r\n\r\nuse crate::manajemen_supplier::main::model::{supplier::Supplier, supplier_transaction::SupplierTransaction};\r\n\r\npub struct SupplierTransactionFactory;\r\n\r\nimpl SupplierTransactionFactory {\r\n    pub fn create_from_supplier(supplier: \u0026Supplier) -\u003e SupplierTransaction {\r\n        SupplierTransaction {\r\n            id: format!(\"TRX-{}\", Uuid::new_v4()),\r\n            supplier_id: supplier.id.clone(),\r\n            supplier_name: supplier.name.clone(),\r\n            jenis_barang: supplier.jenis_barang.clone(),\r\n            jumlah_barang: supplier.jumlah_barang,\r\n            pengiriman_info: supplier.resi.clone(),\r\n            tanggal_transaksi: Utc::now(),\r\n        }\r\n    }\r\n}","traces":[{"line":9,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":11,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":12,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":13,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":14,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":15,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":16,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":17,"address":[],"length":0,"stats":{"Line":216172782113783808}}],"covered":8,"coverable":8},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","main","patterns","mod.rs"],"content":"pub mod factory;\r\npub mod observer;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","main","patterns","observer.rs"],"content":"use std::sync::{Arc, Mutex};\r\n\r\nuse crate::manajemen_supplier::main::model::supplier::Supplier;\r\nuse crate::manajemen_supplier::main::repository::supplier_transaction_repository::SupplierTransactionRepository;\r\nuse crate::manajemen_supplier::main::patterns::factory::SupplierTransactionFactory;\r\nuse crate::manajemen_supplier::main::repository::supplier_transaction_repository_impl::SupplierTransactionRepositoryImpl;\r\n\r\npub trait SupplierObserver: Send + Sync {\r\n    fn on_supplier_saved(\u0026self, supplier: \u0026Supplier);\r\n}\r\n\r\n#[derive(Clone)]\r\npub struct SupplierEventDispatcher {\r\n    observers: Arc\u003cMutex\u003cVec\u003cArc\u003cdyn SupplierObserver\u003e\u003e\u003e\u003e,\r\n}\r\n\r\nimpl SupplierEventDispatcher {\r\n    pub fn new() -\u003e Self {\r\n        SupplierEventDispatcher {\r\n            observers: Arc::new(Mutex::new(Vec::new())),\r\n        }\r\n    }\r\n\r\n    pub fn register(\u0026self, observer: Arc\u003cdyn SupplierObserver\u003e) {\r\n        self.observers.lock().unwrap().push(observer);\r\n    }\r\n\r\n    pub fn notify_supplier_saved(\u0026self, supplier: \u0026Supplier) {\r\n        let observers = self.observers.lock().unwrap();\r\n        for obs in observers.iter() {\r\n            obs.on_supplier_saved(supplier);\r\n        }\r\n    }\r\n}\r\n\r\n#[derive(Clone)]\r\npub struct SupplierTransactionLogger {\r\n    pub trx_repo: Arc\u003cSupplierTransactionRepositoryImpl\u003e,\r\n}\r\n\r\nimpl SupplierObserver for SupplierTransactionLogger {\r\n    fn on_supplier_saved(\u0026self, supplier: \u0026Supplier) {\r\n        let trx = SupplierTransactionFactory::create_from_supplier(supplier);\r\n        let _ = self.trx_repo.save(trx);\r\n    }\r\n}\r\n","traces":[{"line":18,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":20,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":24,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":25,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":28,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":29,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":30,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":31,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":42,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":43,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":44,"address":[],"length":0,"stats":{"Line":72057594037927936}}],"covered":11,"coverable":11},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","main","repository","mod.rs"],"content":"pub mod supplier_repository;\r\npub mod supplier_repository_impl;\r\npub mod supplier_transaction_repository;\r\npub mod supplier_transaction_repository_impl;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","main","repository","supplier_repository.rs"],"content":"use crate::manajemen_supplier::main::model::supplier::Supplier;\r\npub trait SupplierRepository: Send + Sync {\r\n    fn save(\u0026self, supplier: Supplier) -\u003e Result\u003cSupplier, String\u003e;\r\n    fn find_by_id(\u0026self, id: \u0026str) -\u003e Option\u003cSupplier\u003e;\r\n    fn update(\u0026self, supplier: Supplier) -\u003e Result\u003c(), String\u003e;\r\n    fn delete(\u0026self, id: \u0026str) -\u003e Result\u003c(), String\u003e;\r\n}\r\n","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","main","repository","supplier_repository_impl.rs"],"content":"use std::collections::HashMap;\r\nuse std::sync::{Arc, Mutex};\r\n\r\nuse crate::manajemen_supplier::main::model::supplier::Supplier;\r\nuse crate::manajemen_supplier::main::repository::supplier_repository::SupplierRepository;\r\n\r\n#[derive(Clone, Default)]\r\npub struct SupplierRepositoryImpl {\r\n    store: Arc\u003cMutex\u003cHashMap\u003cString, Supplier\u003e\u003e\u003e,\r\n}\r\n\r\nimpl SupplierRepositoryImpl {\r\n    pub fn new() -\u003e Self {\r\n        SupplierRepositoryImpl {\r\n            store: Arc::new(Mutex::new(HashMap::new())),\r\n        }\r\n    }\r\n}\r\n\r\nimpl SupplierRepository for SupplierRepositoryImpl {\r\n    fn save(\u0026self, supplier: Supplier) -\u003e Result\u003cSupplier, String\u003e {\r\n        let mut store = self.store.lock().unwrap();\r\n        store.insert(supplier.id.clone(), supplier.clone());\r\n        Ok(supplier)\r\n    }\r\n\r\n    fn find_by_id(\u0026self, id: \u0026str) -\u003e Option\u003cSupplier\u003e {\r\n        let store = self.store.lock().unwrap();\r\n        store.get(id).cloned()\r\n    }\r\n\r\n    fn update(\u0026self, supplier: Supplier) -\u003e Result\u003c(), String\u003e {\r\n        let mut store = self.store.lock().unwrap();\r\n        if store.contains_key(\u0026supplier.id) {\r\n            store.insert(supplier.id.clone(), supplier);\r\n            Ok(())\r\n        } else {\r\n            Err(\"Supplier not found\".to_string())\r\n        }\r\n    }\r\n\r\n    fn delete(\u0026self, id: \u0026str) -\u003e Result\u003c(), String\u003e {\r\n        let mut store = self.store.lock().unwrap();\r\n        if store.remove(id).is_some() {\r\n            Ok(())\r\n        } else {\r\n            Err(\"Supplier not found\".to_string())\r\n        }\r\n    }\r\n}\r\n","traces":[{"line":13,"address":[],"length":0,"stats":{"Line":1297036692682702848}},{"line":15,"address":[],"length":0,"stats":{"Line":1297036692682702848}},{"line":21,"address":[],"length":0,"stats":{"Line":864691128455135232}},{"line":22,"address":[],"length":0,"stats":{"Line":864691128455135232}},{"line":23,"address":[],"length":0,"stats":{"Line":864691128455135232}},{"line":24,"address":[],"length":0,"stats":{"Line":864691128455135232}},{"line":27,"address":[],"length":0,"stats":{"Line":864691128455135232}},{"line":28,"address":[],"length":0,"stats":{"Line":864691128455135232}},{"line":29,"address":[],"length":0,"stats":{"Line":864691128455135232}},{"line":32,"address":[],"length":0,"stats":{"Line":360287970189639680}},{"line":33,"address":[],"length":0,"stats":{"Line":360287970189639680}},{"line":34,"address":[],"length":0,"stats":{"Line":360287970189639680}},{"line":35,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":36,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":38,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":42,"address":[],"length":0,"stats":{"Line":360287970189639680}},{"line":43,"address":[],"length":0,"stats":{"Line":360287970189639680}},{"line":44,"address":[],"length":0,"stats":{"Line":360287970189639680}},{"line":45,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":47,"address":[],"length":0,"stats":{"Line":144115188075855872}}],"covered":20,"coverable":20},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","main","repository","supplier_transaction_repository.rs"],"content":"use crate::manajemen_supplier::main::model::supplier_transaction::SupplierTransaction;\r\n\r\npub trait SupplierTransactionRepository: Send + Sync {\r\n    fn save(\u0026self, transaction: SupplierTransaction) -\u003e Result\u003cSupplierTransaction, String\u003e;\r\n    fn find_by_id(\u0026self, id: \u0026str) -\u003e Option\u003cSupplierTransaction\u003e;\r\n    fn find_by_supplier_id(\u0026self, supplier_id: \u0026str) -\u003e Vec\u003cSupplierTransaction\u003e;\r\n}\r\n","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","main","repository","supplier_transaction_repository_impl.rs"],"content":"use std::collections::HashMap;\r\nuse std::sync::{Arc, Mutex};\r\n\r\nuse crate::manajemen_supplier::main::model::supplier_transaction::SupplierTransaction;\r\nuse crate::manajemen_supplier::main::repository::supplier_transaction_repository::SupplierTransactionRepository;\r\n\r\n#[derive(Clone)]\r\npub struct SupplierTransactionRepositoryImpl {\r\n    pub storage: Arc\u003cMutex\u003cHashMap\u003cString, SupplierTransaction\u003e\u003e\u003e,\r\n}\r\n\r\nimpl SupplierTransactionRepositoryImpl {\r\n    pub fn new() -\u003e Self {\r\n        SupplierTransactionRepositoryImpl {\r\n            storage: Arc::new(Mutex::new(HashMap::new())),\r\n        }\r\n    }\r\n}\r\n\r\nimpl SupplierTransactionRepository for SupplierTransactionRepositoryImpl {\r\n    fn save(\u0026self, transaction: SupplierTransaction) -\u003e Result\u003cSupplierTransaction, String\u003e {\r\n        match self.storage.lock() {\r\n            Ok(mut store) =\u003e {\r\n                store.insert(transaction.id.clone(), transaction.clone());\r\n                Ok(transaction)\r\n            }\r\n            Err(_) =\u003e Err(\"Failed to acquire lock\".to_string()),\r\n        }\r\n    }\r\n\r\n    fn find_by_id(\u0026self, id: \u0026str) -\u003e Option\u003cSupplierTransaction\u003e {\r\n        match self.storage.lock() {\r\n            Ok(store) =\u003e store.get(id).cloned(),\r\n            Err(_) =\u003e None,\r\n        }\r\n    }\r\n\r\n    fn find_by_supplier_id(\u0026self, supplier_id: \u0026str) -\u003e Vec\u003cSupplierTransaction\u003e {\r\n        match self.storage.lock() {\r\n            Ok(store) =\u003e store\r\n                .values()\r\n                .filter(|trx| trx.supplier_id == supplier_id)\r\n                .cloned()\r\n                .collect(),\r\n            Err(_) =\u003e vec![],\r\n        }\r\n    }\r\n}\r\n","traces":[{"line":13,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":15,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":21,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":22,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":23,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":24,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":25,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":27,"address":[],"length":0,"stats":{"Line":0}},{"line":31,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":32,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":33,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":34,"address":[],"length":0,"stats":{"Line":0}},{"line":38,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":39,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":40,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":42,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":45,"address":[],"length":0,"stats":{"Line":0}}],"covered":14,"coverable":17},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","main","service","mod.rs"],"content":"pub mod supplier_service;\r\npub mod supplier_service_impl;\r\npub mod supplier_dispatcher;\r\npub mod supplier_transaction_logger;\r\npub mod supplier_observer;\r\npub mod supplier_notifier;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","main","service","supplier_dispatcher.rs"],"content":"use std::sync::{Arc, Mutex};\r\n\r\nuse crate::manajemen_supplier::main::model::supplier::Supplier;\r\nuse crate::manajemen_supplier::main::service::supplier_notifier::SupplierNotifier;\r\nuse crate::manajemen_supplier::main::service::supplier_observer::SupplierObserver;\r\n\r\n\r\nimpl SupplierNotifier for SupplierDispatcher {\r\n    fn notify_supplier_saved(\u0026self, supplier: \u0026Supplier) {\r\n        self.notify_supplier_saved(supplier);\r\n    }\r\n}\r\n\r\n\r\n#[derive(Clone)]\r\npub struct SupplierDispatcher {\r\n    observers: Arc\u003cMutex\u003cVec\u003cArc\u003cdyn SupplierObserver\u003e\u003e\u003e\u003e,\r\n}\r\n\r\nimpl SupplierDispatcher {\r\n    pub fn new() -\u003e Self {\r\n        Self {\r\n            observers: Arc::new(Mutex::new(Vec::new())),\r\n        }\r\n    }\r\n\r\n    pub fn register(\u0026self, observer: Arc\u003cdyn SupplierObserver\u003e) {\r\n        self.observers.lock().unwrap().push(observer);\r\n    }\r\n\r\n    pub fn notify_supplier_saved(\u0026self, supplier: \u0026Supplier) {\r\n        let observers = self.observers.lock().unwrap();\r\n        for obs in observers.iter() {\r\n            obs.on_supplier_saved(supplier);\r\n        }\r\n    }\r\n}","traces":[{"line":9,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":10,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":21,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":23,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":27,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":28,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":31,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":32,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":33,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":34,"address":[],"length":0,"stats":{"Line":144115188075855872}}],"covered":10,"coverable":10},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","main","service","supplier_notifier.rs"],"content":"use crate::manajemen_supplier::main::model::supplier::Supplier;\r\n\r\npub trait SupplierNotifier: Send + Sync {\r\n    fn notify_supplier_saved(\u0026self, supplier: \u0026Supplier);\r\n}","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","main","service","supplier_observer.rs"],"content":"use crate::manajemen_supplier::main::model::supplier::Supplier;\r\npub trait SupplierObserver: Send + Sync {\r\n    fn on_supplier_saved(\u0026self, supplier: \u0026Supplier);\r\n}","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","main","service","supplier_service.rs"],"content":"use crate::manajemen_supplier::main::model::supplier::Supplier;\r\n\r\npub trait SupplierService: Send + Sync {\r\n    fn save_supplier(\u0026self, supplier: Supplier) -\u003e Result\u003cSupplier, String\u003e;\r\n    fn update_supplier(\u0026self, supplier: Supplier) -\u003e Result\u003c(), String\u003e;\r\n    fn delete_supplier(\u0026self, id: \u0026str) -\u003e Result\u003c(), String\u003e;\r\n    fn get_supplier(\u0026self, id: \u0026str) -\u003e Option\u003cSupplier\u003e;\r\n}\r\n","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","main","service","supplier_service_impl.rs"],"content":"use std::sync::Arc;\r\n\r\nuse crate::manajemen_supplier::main::model::supplier::Supplier;\r\nuse crate::manajemen_supplier::main::repository::supplier_repository::SupplierRepository;\r\nuse crate::manajemen_supplier::main::service::supplier_notifier::SupplierNotifier;\r\nuse crate::manajemen_supplier::main::service::supplier_service::SupplierService;\r\n\r\npub struct SupplierServiceImpl {\r\n    pub supplier_repo: Arc\u003cdyn SupplierRepository\u003e,\r\n    pub dispatcher: Arc\u003cdyn SupplierNotifier\u003e,\r\n}\r\n\r\nimpl SupplierServiceImpl {\r\n    pub fn new(\r\n        supplier_repo: Arc\u003cdyn SupplierRepository\u003e,\r\n        dispatcher: Arc\u003cdyn SupplierNotifier\u003e,\r\n    ) -\u003e Self {\r\n        SupplierServiceImpl {\r\n            supplier_repo,\r\n            dispatcher,\r\n        }\r\n    }\r\n}\r\n\r\nimpl SupplierService for SupplierServiceImpl {\r\n    fn save_supplier(\u0026self, supplier: Supplier) -\u003e Result\u003cSupplier, String\u003e {\r\n        let saved = self.supplier_repo.save(supplier.clone())?;\r\n        self.dispatcher.notify_supplier_saved(\u0026supplier);\r\n        Ok(saved)\r\n    }\r\n\r\n    fn update_supplier(\u0026self, supplier: Supplier) -\u003e Result\u003c(), String\u003e {\r\n        self.supplier_repo.update(supplier)\r\n    }\r\n\r\n    fn delete_supplier(\u0026self, id: \u0026str) -\u003e Result\u003c(), String\u003e {\r\n        self.supplier_repo.delete(id)\r\n    }\r\n\r\n    fn get_supplier(\u0026self, id: \u0026str) -\u003e Option\u003cSupplier\u003e {\r\n        self.supplier_repo.find_by_id(id)\r\n    }\r\n}","traces":[{"line":14,"address":[],"length":0,"stats":{"Line":1008806316530991104}},{"line":26,"address":[],"length":0,"stats":{"Line":576460752303423488}},{"line":27,"address":[],"length":0,"stats":{"Line":1152921504606846976}},{"line":32,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":33,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":36,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":37,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":40,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":41,"address":[],"length":0,"stats":{"Line":432345564227567616}}],"covered":9,"coverable":9},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","main","service","supplier_transaction_logger.rs"],"content":"use std::sync::Arc;\r\n\r\nuse crate::manajemen_supplier::main::model::supplier::Supplier;\r\nuse crate::manajemen_supplier::main::patterns::factory::SupplierTransactionFactory;\r\nuse crate::manajemen_supplier::main::patterns::observer::SupplierObserver;\r\nuse crate::manajemen_supplier::main::repository::supplier_transaction_repository::SupplierTransactionRepository;\r\n\r\n#[derive(Clone)]\r\npub struct SupplierTransactionLogger {\r\n    pub trx_repo: Arc\u003cdyn SupplierTransactionRepository + Send + Sync\u003e,\r\n}\r\n\r\nimpl SupplierTransactionLogger {\r\n    pub fn new(trx_repo: Arc\u003cdyn SupplierTransactionRepository + Send + Sync\u003e) -\u003e Self {\r\n        Self { trx_repo }\r\n    }\r\n}\r\n\r\nimpl SupplierObserver for SupplierTransactionLogger {\r\n    fn on_supplier_saved(\u0026self, supplier: \u0026Supplier) {\r\n        let trx = SupplierTransactionFactory::create_from_supplier(supplier);\r\n        if let Err(err) = self.trx_repo.save(trx) {\r\n            eprintln!(\"Failed to log transaction: {}\", err);\r\n        }\r\n    }\r\n}\r\n","traces":[{"line":14,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":20,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":21,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":22,"address":[],"length":0,"stats":{"Line":72057594037927936}}],"covered":4,"coverable":4},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","mod.rs"],"content":"pub mod main; \r\n\r\n#[cfg(test)]\r\npub mod test;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","test","controller","mod.rs"],"content":"pub mod supplier_controller_test;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","test","controller","supplier_controller_test.rs"],"content":"#[cfg(test)]\r\nmod supplier_controller_test {\r\n    use std::sync::Arc;\r\n    use crate::manajemen_supplier::main::controller::supplier_controller::SupplierController;\r\n    use crate::manajemen_supplier::main::repository::supplier_repository_impl::SupplierRepositoryImpl;\r\n    use crate::manajemen_supplier::main::service::supplier_notifier::SupplierNotifier;\r\n    use crate::manajemen_supplier::main::model::supplier::Supplier;\r\n    use crate::manajemen_supplier::main::service::supplier_service_impl::SupplierServiceImpl;\r\n    use chrono::Utc;\r\n\r\n    struct MockNotifier;\r\n\r\n    impl SupplierNotifier for MockNotifier {\r\n        fn notify_supplier_saved(\u0026self, _supplier: \u0026Supplier) {\r\n            // No-op for testing\r\n        }\r\n    }\r\n\r\n    fn setup_controller() -\u003e SupplierController {\r\n        let repo = Arc::new(SupplierRepositoryImpl::new());\r\n        let notifier = Arc::new(MockNotifier);\r\n        let service = Arc::new(SupplierServiceImpl::new(repo.clone(), notifier));\r\n        SupplierController::new(service)\r\n    }\r\n\r\n    fn sample_supplier(id: \u0026str) -\u003e Supplier {\r\n        Supplier {\r\n            id: id.to_string(),\r\n            name: \"PT. Pt\".to_string(),\r\n            jenis_barang: \"Ayam\".to_string(),\r\n            jumlah_barang: 10,\r\n            resi: \"RESI123\".to_string(),\r\n            updated_at: Utc::now(),\r\n        }\r\n    }\r\n\r\n    #[test]\r\n    fn test_save_supplier_success() {\r\n        let controller = setup_controller();\r\n        let supplier = sample_supplier(\"SUP1\");\r\n\r\n        let result = controller.save_supplier(supplier.clone());\r\n\r\n        assert!(result.is_ok());\r\n        assert_eq!(result.unwrap().id, \"SUP1\");\r\n    }\r\n\r\n    #[test]\r\n    fn test_get_supplier_existing() {\r\n        let controller = setup_controller();\r\n        let supplier = sample_supplier(\"SUP2\");\r\n        controller.save_supplier(supplier.clone()).unwrap();\r\n\r\n        let fetched = controller.get_supplier(\"SUP2\");\r\n\r\n        assert!(fetched.is_some());\r\n        assert_eq!(fetched.unwrap().name, \"PT. Pt\");\r\n    }\r\n\r\n    #[test]\r\n    fn test_get_supplier_non_existing() {\r\n        let controller = setup_controller();\r\n        let fetched = controller.get_supplier(\"NON_EXISTENT\");\r\n        assert!(fetched.is_none());\r\n    }\r\n\r\n    #[test]\r\n    fn test_update_supplier_success() {\r\n        let controller = setup_controller();\r\n        let mut supplier = sample_supplier(\"SUP3\");\r\n        controller.save_supplier(supplier.clone()).unwrap();\r\n\r\n        supplier.name = \"Updated Supplier\".to_string();\r\n        let result = controller.update_supplier(supplier.clone());\r\n\r\n        assert!(result.is_ok());\r\n\r\n        let updated = controller.get_supplier(\"SUP3\").unwrap();\r\n        assert_eq!(updated.name, \"Updated Supplier\");\r\n    }\r\n\r\n    #[test]\r\n    fn test_update_supplier_fail_not_found() {\r\n        let controller = setup_controller();\r\n        let supplier = sample_supplier(\"SUP-UNKNOWN\");\r\n\r\n        let result = controller.update_supplier(supplier);\r\n\r\n        assert!(result.is_err());\r\n    }\r\n\r\n    #[test]\r\n    fn test_delete_supplier_success() {\r\n        let controller = setup_controller();\r\n        let supplier = sample_supplier(\"SUP4\");\r\n        controller.save_supplier(supplier.clone()).unwrap();\r\n\r\n        let result = controller.delete_supplier(\"SUP4\");\r\n        assert!(result.is_ok());\r\n\r\n        let after_delete = controller.get_supplier(\"SUP4\");\r\n        assert!(after_delete.is_none());\r\n    }\r\n\r\n    #[test]\r\n    fn test_delete_supplier_fail_not_found() {\r\n        let controller = setup_controller();\r\n        let result = controller.delete_supplier(\"SUP-UNKNOWN\");\r\n        assert!(result.is_err());\r\n    }\r\n}","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","test","mod.rs"],"content":"pub mod model;\r\npub mod repository;\r\npub mod patterns;\r\npub mod service;\r\npub mod controller;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","test","model","mod.rs"],"content":"pub mod supplier_test;\r\npub mod supplier_transaction_test;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","test","model","supplier_test.rs"],"content":"#[cfg(test)]\r\nmod tests {\r\n    use uuid::Uuid;\r\n    use chrono::Utc;\r\n    use crate::manajemen_supplier::main::model::supplier::Supplier;\r\n\r\n    #[test]\r\n    fn test_create_supplier() {\r\n        let supplier_id = format!(\"SUP-{}\", Uuid::new_v4());\r\n\r\n        let supplier = Supplier {\r\n            id: supplier_id.clone(),\r\n            name: \"PT. Ayam\".to_string(),\r\n            jenis_barang: \"ayam\".to_string(),\r\n            jumlah_barang: 1000,\r\n            resi: \"2306206282\".to_string(),\r\n            updated_at: Utc::now(),\r\n        };\r\n\r\n        assert_eq!(supplier.name, \"PT. Ayam\");\r\n        assert_eq!(supplier.jenis_barang, \"ayam\");\r\n        assert_eq!(supplier.jumlah_barang, 1000);\r\n        assert_eq!(supplier.resi, \"2306206282\");\r\n    }\r\n}\r\n","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","test","model","supplier_transaction_test.rs"],"content":"#[cfg(test)]\r\nmod tests {\r\n    use crate::manajemen_supplier::main::model::{supplier::Supplier, supplier_transaction::SupplierTransaction};\r\n    use chrono::Utc;\r\n    \r\n\r\n    #[test]\r\n    fn test_supplier_to_transaction() {\r\n        let now = Utc::now();\r\n\r\n        let supplier = Supplier {\r\n            id: \"SUP-001\".to_string(),\r\n            name: \"PT. Ayam\".to_string(),\r\n            jenis_barang: \"Ayam\".to_string(),\r\n            jumlah_barang: 100,\r\n            resi: \"2306206282\".to_string(),\r\n            updated_at: now,\r\n        };\r\n\r\n        let transaksi = SupplierTransaction {\r\n            id: \"STRX-001\".to_string(),\r\n            supplier_id: supplier.id.clone(),\r\n            supplier_name: supplier.name.clone(),\r\n            jenis_barang: supplier.jenis_barang.clone(),\r\n            jumlah_barang: supplier.jumlah_barang,\r\n            pengiriman_info: supplier.resi.clone(),\r\n            tanggal_transaksi: supplier.updated_at,\r\n        };\r\n\r\n        assert_eq!(transaksi.supplier_id, \"SUP-001\");\r\n        assert_eq!(transaksi.supplier_name, \"PT. Ayam\");\r\n        assert_eq!(transaksi.jenis_barang, \"Ayam\");\r\n        assert_eq!(transaksi.jumlah_barang, 100);\r\n        assert_eq!(transaksi.pengiriman_info, \"2306206282\");\r\n        assert_eq!(transaksi.tanggal_transaksi, now);\r\n    }\r\n}\r\n","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","test","patterns","factory.rs"],"content":"#[cfg(test)]\r\nmod tests {\r\n    use chrono::Utc;\r\n    use uuid::Uuid;\r\n\r\n    use crate::manajemen_supplier::main::patterns::factory::SupplierTransactionFactory;\r\n    use crate::manajemen_supplier::main::model::supplier::Supplier;\r\n\r\n    #[test]\r\n    fn test_create_transaction_from_supplier() {\r\n        let supplier_id = format!(\"SUP-{}\", Uuid::new_v4());\r\n        let now = Utc::now();\r\n\r\n        let supplier = Supplier {\r\n            id: supplier_id.clone(),\r\n            name: \"PT. Ayam\".to_string(),\r\n            jenis_barang: \"Ayam\".to_string(),\r\n            jumlah_barang: 1000,\r\n            resi: \"2306206282\".to_string(),\r\n            updated_at: now,\r\n        };\r\n\r\n        let transaction = SupplierTransactionFactory::create_from_supplier(\u0026supplier);\r\n\r\n        assert_eq!(transaction.supplier_id, supplier.id);\r\n        assert_eq!(transaction.supplier_name, supplier.name);\r\n        assert_eq!(transaction.jenis_barang, supplier.jenis_barang);\r\n        assert_eq!(transaction.jumlah_barang, supplier.jumlah_barang);\r\n        assert_eq!(transaction.pengiriman_info, supplier.resi);\r\n    }\r\n}\r\n","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","test","patterns","mod.rs"],"content":"pub mod factory;\r\npub mod observer;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","test","patterns","observer.rs"],"content":"#[cfg(test)]\r\nmod tests {\r\n    use std::sync::Arc;\r\n\r\n    use chrono::Utc;\r\n    use uuid::Uuid;\r\n\r\n    use crate::manajemen_supplier::main::model::supplier::Supplier;\r\n    use crate::manajemen_supplier::main::repository::supplier_transaction_repository::SupplierTransactionRepository;\r\n    use crate::manajemen_supplier::main::repository::supplier_transaction_repository_impl::SupplierTransactionRepositoryImpl;\r\n    use crate::manajemen_supplier::main::patterns::observer::{SupplierEventDispatcher, SupplierTransactionLogger};\r\n\r\n    #[test]\r\n    fn test_supplier_observer_logs_transaction_on_save() {\r\n        // Arrange\r\n        let trx_repo = Arc::new(SupplierTransactionRepositoryImpl::new());\r\n        let logger = Arc::new(SupplierTransactionLogger {\r\n            trx_repo: trx_repo.clone(),\r\n        });\r\n\r\n        let dispatcher = SupplierEventDispatcher::new();\r\n        dispatcher.register(logger);\r\n\r\n        let supplier_id = format!(\"SUP-{}\", Uuid::new_v4());\r\n        let supplier = Supplier {\r\n            id: supplier_id.clone(),\r\n            name: \"PT. Ayam\".to_string(),\r\n            jenis_barang: \"Ayam\".to_string(),\r\n            jumlah_barang: 100,\r\n            resi: \"123ABC\".to_string(),\r\n            updated_at: Utc::now(),\r\n        };\r\n\r\n        dispatcher.notify_supplier_saved(\u0026supplier);\r\n\r\n        let transactions = trx_repo.find_by_supplier_id(\u0026supplier_id);\r\n        assert_eq!(transactions.len(), 1);\r\n\r\n        let trx = \u0026transactions[0];\r\n        assert_eq!(trx.supplier_id, supplier.id);\r\n        assert_eq!(trx.supplier_name, supplier.name);\r\n        assert_eq!(trx.jenis_barang, supplier.jenis_barang);\r\n        assert_eq!(trx.jumlah_barang, supplier.jumlah_barang);\r\n        assert_eq!(trx.pengiriman_info, supplier.resi);\r\n    }\r\n}\r\n","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","test","repository","mod.rs"],"content":"pub mod supplier_repository_impl_test;\r\npub mod supplier_transaction_repository_impl_test;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","test","repository","supplier_repository_impl_test.rs"],"content":"#[cfg(test)]\r\nmod tests {\r\n    use chrono::Utc;\r\n    use uuid::Uuid;\r\n\r\n    use crate::manajemen_supplier::main::model::supplier::Supplier;\r\n    use crate::manajemen_supplier::main::repository::supplier_repository::SupplierRepository;\r\n    use crate::manajemen_supplier::main::repository::supplier_repository_impl::SupplierRepositoryImpl;\r\n     \r\n\r\n    #[test]\r\n    fn test_save_supplier(){\r\n        let repository = SupplierRepositoryImpl::new();\r\n        let supplier_id = format!(\"SUP-{}\", Uuid::new_v4());\r\n\r\n        let supplier = Supplier {\r\n            id: supplier_id.clone(),\r\n            name: \"PT. Ayam\".to_string(),\r\n            jenis_barang: \"ayam\".to_string(),\r\n            jumlah_barang: 1000,\r\n            resi: \"2306206282\".to_string(),\r\n            updated_at: Utc::now(),\r\n        };\r\n\r\n        let result = repository.save(supplier.clone());\r\n        let saved_supplier = result.unwrap();\r\n\r\n        assert_eq!(saved_supplier.id, supplier_id);\r\n        assert_eq!(saved_supplier.name, \"PT. Ayam\");\r\n        assert_eq!(saved_supplier.jenis_barang, \"ayam\");\r\n        assert_eq!(saved_supplier.jumlah_barang, 1000);\r\n        assert_eq!(saved_supplier.resi, \"2306206282\");\r\n    }\r\n    \r\n    #[test]\r\n    fn test_find_supplier_by_id(){\r\n        let repository = SupplierRepositoryImpl::new();\r\n        let supplier_id = format!(\"SUP-{}\", Uuid::new_v4());\r\n        \r\n        let supplier = Supplier {\r\n            id: supplier_id.clone(),\r\n            name: \"PT. Ayam\".to_string(),\r\n            jenis_barang: \"ayam\".to_string(),\r\n            jumlah_barang: 1000,\r\n            resi: \"2306206282\".to_string(),\r\n            updated_at: Utc::now(),\r\n        };\r\n        \r\n        repository.save(supplier.clone()).unwrap();\r\n        \r\n        let result = repository.find_by_id(\u0026supplier_id);\r\n        \r\n        assert!(result.is_some());\r\n        let found_supplier = result.unwrap();\r\n        assert_eq!(found_supplier.id, supplier_id);\r\n    }\r\n\r\n    #[test]\r\n    fn test_update_supplier(){\r\n        let repository = SupplierRepositoryImpl::new();\r\n        let supplier_id = format!(\"SUP-{}\", Uuid::new_v4());\r\n        \r\n        let supplier = Supplier {\r\n            id: supplier_id.clone(),\r\n            name: \"PT. Ayam\".to_string(),\r\n            jenis_barang: \"ayam\".to_string(),\r\n            jumlah_barang: 1000,\r\n            resi: \"2306206282\".to_string(),\r\n            updated_at: Utc::now(),\r\n        };\r\n        \r\n        repository.save(supplier.clone()).unwrap();\r\n        \r\n        let mut updated_supplier = supplier.clone();\r\n        updated_supplier.jumlah_barang = 1;\r\n        let result = repository.update(updated_supplier);\r\n        \r\n        assert!(result.is_ok());\r\n        let found_supplier = repository.find_by_id(\u0026supplier_id).unwrap();\r\n        assert_eq!(found_supplier.jumlah_barang, 1);\r\n    }\r\n\r\n    #[test]\r\n    fn test_delete_supplier(){\r\n        let repository = SupplierRepositoryImpl::new();\r\n        let supplier_id = format!(\"SUP-{}\", Uuid::new_v4());\r\n        \r\n        let supplier = Supplier {\r\n            id: supplier_id.clone(),\r\n            name: \"PT. Ayam\".to_string(),\r\n            jenis_barang: \"ayam\".to_string(),\r\n            jumlah_barang: 1000,\r\n            resi: \"2306206282\".to_string(),\r\n            updated_at: Utc::now(),\r\n        };\r\n        \r\n        repository.save(supplier.clone()).unwrap();\r\n\r\n        let result = repository.delete(\u0026supplier_id);\r\n    \r\n        assert!(result.is_ok());\r\n        assert!(repository.find_by_id(\u0026supplier_id).is_none());\r\n    }\r\n}\r\n","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","test","repository","supplier_transaction_repository_impl_test.rs"],"content":"use chrono::Utc;\r\nuse uuid::Uuid;\r\n\r\nuse crate::manajemen_supplier::main::model::supplier::Supplier;\r\nuse crate::manajemen_supplier::main::model::supplier_transaction::SupplierTransaction;\r\nuse crate::manajemen_supplier::main::repository::supplier_transaction_repository::SupplierTransactionRepository;\r\nuse crate::manajemen_supplier::main::repository::supplier_transaction_repository_impl::SupplierTransactionRepositoryImpl;\r\n\r\n#[test]\r\nfn save_supplier_transaction() {\r\n    let repository = SupplierTransactionRepositoryImpl::new();\r\n    let supplier_id = format!(\"SUP-{}\", Uuid::new_v4());\r\n\r\n    let supplier = Supplier {\r\n        id: supplier_id.clone(),\r\n        name: \"PT. Ayam\".to_string(),\r\n        jenis_barang: \"ayam\".to_string(),\r\n        jumlah_barang: 1000,\r\n        resi: \"2306206282\".to_string(),\r\n        updated_at: Utc::now(),\r\n    };\r\n\r\n    let transaksi = SupplierTransaction {\r\n        id: format!(\"TRX-{}\", Uuid::new_v4()),\r\n        supplier_id: supplier.id.clone(),\r\n        supplier_name: supplier.name.clone(),\r\n        jenis_barang: supplier.jenis_barang.clone(),\r\n        jumlah_barang: supplier.jumlah_barang,\r\n        pengiriman_info: supplier.resi.clone(),\r\n        tanggal_transaksi: Utc::now(),\r\n    };\r\n\r\n    let result = repository.save(transaksi.clone());\r\n    assert!(result.is_ok());\r\n    let saved = result.unwrap();\r\n    assert_eq!(saved.supplier_id, supplier.id);\r\n    assert_eq!(saved.supplier_name, supplier.name);\r\n}\r\n\r\n#[test]\r\nfn test_find_supplier_transaction_by_id() {\r\n    let repository = SupplierTransactionRepositoryImpl::new();\r\n    let supplier_id = format!(\"SUP-{}\", Uuid::new_v4());\r\n\r\n    let supplier = Supplier {\r\n        id: supplier_id.clone(),\r\n        name: \"PT. Ayam\".to_string(),\r\n        jenis_barang: \"ayam\".to_string(),\r\n        jumlah_barang: 1000,\r\n        resi: \"2306206282\".to_string(),\r\n        updated_at: Utc::now(),\r\n    };\r\n\r\n    let transaksi = SupplierTransaction {\r\n        id: format!(\"TRX-{}\", Uuid::new_v4()),\r\n        supplier_id: supplier.id.clone(),\r\n        supplier_name: supplier.name.clone(),\r\n        jenis_barang: supplier.jenis_barang.clone(),\r\n        jumlah_barang: supplier.jumlah_barang,\r\n        pengiriman_info: supplier.resi.clone(),\r\n        tanggal_transaksi: Utc::now(),\r\n    };\r\n\r\n    repository.save(transaksi.clone()).unwrap();\r\n    let found = repository.find_by_id(\u0026transaksi.id);\r\n    assert!(found.is_some());\r\n    assert_eq!(found.unwrap().id, transaksi.id);\r\n}\r\n\r\n#[test]\r\nfn test_find_supplier_transaction_by_supplier_id() {\r\n    let repository = SupplierTransactionRepositoryImpl::new();\r\n    let supplier_id = format!(\"SUP-{}\", Uuid::new_v4());\r\n\r\n    let supplier = Supplier {\r\n        id: supplier_id.clone(),\r\n        name: \"PT. Ayam\".to_string(),\r\n        jenis_barang: \"ayam\".to_string(),\r\n        jumlah_barang: 1000,\r\n        resi: \"2306206282\".to_string(),\r\n        updated_at: Utc::now(),\r\n    };\r\n\r\n    let transaksi = SupplierTransaction {\r\n        id: format!(\"TRX-{}\", Uuid::new_v4()),\r\n        supplier_id: supplier.id.clone(),\r\n        supplier_name: supplier.name.clone(),\r\n        jenis_barang: supplier.jenis_barang.clone(),\r\n        jumlah_barang: supplier.jumlah_barang,\r\n        pengiriman_info: supplier.resi.clone(),\r\n        tanggal_transaksi: Utc::now(),\r\n    };\r\n\r\n    repository.save(transaksi.clone()).unwrap();\r\n    let results = repository.find_by_supplier_id(\u0026supplier.id);\r\n    assert!(!results.is_empty());\r\n    assert_eq!(results[0].supplier_id, supplier.id);\r\n}","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","test","service","mod.rs"],"content":"pub mod supplier_service_impl_test;\r\npub mod supplier_dispatcher_test;\r\npub mod supplier_transaction_logger_test;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","test","service","supplier_dispatcher_test.rs"],"content":"#[cfg(test)]\r\nmod tests {\r\n    use std::sync::{Arc, Mutex};\r\n    use chrono::Utc;\r\n    use crate::manajemen_supplier::main::model::supplier::Supplier;\r\n    use crate::manajemen_supplier::main::service::supplier_dispatcher::SupplierDispatcher;\r\n    use crate::manajemen_supplier::main::service::supplier_notifier::SupplierNotifier;\r\n    use crate::manajemen_supplier::main::service::supplier_observer::SupplierObserver;\r\n\r\n    struct MockObserver {\r\n        pub called: Arc\u003cMutex\u003cbool\u003e\u003e,\r\n        pub last_supplier_name: Arc\u003cMutex\u003cOption\u003cString\u003e\u003e\u003e,\r\n    }\r\n\r\n    impl SupplierObserver for MockObserver {\r\n        fn on_supplier_saved(\u0026self, supplier: \u0026Supplier) {\r\n            let mut called = self.called.lock().unwrap();\r\n            let mut name = self.last_supplier_name.lock().unwrap();\r\n            *called = true;\r\n            *name = Some(supplier.name.clone());\r\n        }\r\n    }\r\n\r\n    fn sample_supplier() -\u003e Supplier {\r\n        Supplier {\r\n            id: \"SUP-001\".to_string(),\r\n            name: \"Test Supplier\".to_string(),\r\n            jenis_barang: \"Elektronik\".to_string(),\r\n            jumlah_barang: 100,\r\n            resi: \"RESI123\".to_string(),\r\n            updated_at: Utc::now(),\r\n        }\r\n    }\r\n\r\n    #[test]\r\n    fn test_register_and_notify_observer() {\r\n        let dispatcher = SupplierDispatcher::new();\r\n\r\n        let called_flag = Arc::new(Mutex::new(false));\r\n        let last_name = Arc::new(Mutex::new(None));\r\n\r\n        let observer = Arc::new(MockObserver {\r\n            called: called_flag.clone(),\r\n            last_supplier_name: last_name.clone(),\r\n        });\r\n\r\n        dispatcher.register(observer.clone());\r\n        let supplier = sample_supplier();\r\n        dispatcher.notify_supplier_saved(\u0026supplier);\r\n\r\n        assert_eq!(*called_flag.lock().unwrap(), true);\r\n        assert_eq!(last_name.lock().unwrap().as_deref(), Some(\"Test Supplier\"));\r\n    }\r\n\r\n    #[test]\r\n    fn test_supplier_notifier_trait_works() {\r\n        let dispatcher = SupplierDispatcher::new();\r\n        let notifier: Arc\u003cdyn SupplierNotifier\u003e = Arc::new(dispatcher.clone());\r\n\r\n        let called_flag = Arc::new(Mutex::new(false));\r\n        let last_name = Arc::new(Mutex::new(None));\r\n\r\n        let observer = Arc::new(MockObserver {\r\n            called: called_flag.clone(),\r\n            last_supplier_name: last_name.clone(),\r\n        });\r\n\r\n        dispatcher.register(observer);\r\n        let supplier = sample_supplier();\r\n\r\n        notifier.notify_supplier_saved(\u0026supplier);\r\n\r\n        assert_eq!(*called_flag.lock().unwrap(), true);\r\n        assert_eq!(last_name.lock().unwrap().as_deref(), Some(\"Test Supplier\"));\r\n    }\r\n}\r\n","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","test","service","supplier_service_impl_test.rs"],"content":"#[cfg(test)]\r\nmod tests {\r\n    use std::sync::Arc;\r\n    use chrono::Utc;\r\n\r\n    use crate::manajemen_supplier::main::model::supplier::Supplier;\r\n    use crate::manajemen_supplier::main::repository::supplier_repository_impl::SupplierRepositoryImpl;\r\n    use crate::manajemen_supplier::main::repository::supplier_repository::SupplierRepository;\r\n    use crate::manajemen_supplier::main::service::supplier_service_impl::SupplierServiceImpl;\r\n    use crate::manajemen_supplier::main::service::supplier_service::SupplierService;\r\n    use crate::manajemen_supplier::main::service::supplier_notifier::SupplierNotifier;\r\n\r\n    struct MockNotifier;\r\n\r\n    impl SupplierNotifier for MockNotifier {\r\n        fn notify_supplier_saved(\u0026self, _supplier: \u0026Supplier) {\r\n            // Do nothing for tests\r\n        }\r\n    }\r\n\r\n    fn create_sample_supplier() -\u003e Supplier {\r\n        Supplier {\r\n            id: \"SUP-123\".to_string(),\r\n            name: \"PT. pt\".to_string(),\r\n            jenis_barang: \"Ayam\".to_string(),\r\n            jumlah_barang: 10,\r\n            resi: \"2306206282\".to_string(),\r\n            updated_at: Utc::now(),\r\n        }\r\n    }\r\n\r\n    #[test]\r\n    fn test_save_supplier_success() {\r\n        let repo = Arc::new(SupplierRepositoryImpl::new());\r\n        let notifier = Arc::new(MockNotifier);\r\n        let service = SupplierServiceImpl::new(repo.clone(), notifier);\r\n\r\n        let supplier = create_sample_supplier();\r\n        let result = service.save_supplier(supplier.clone());\r\n\r\n        assert!(result.is_ok());\r\n        let stored = repo.find_by_id(\"SUP-123\").unwrap();\r\n        assert_eq!(stored.name, supplier.name);\r\n    }\r\n\r\n    #[test]\r\n    fn test_update_supplier_success() {\r\n        let repo = Arc::new(SupplierRepositoryImpl::new());\r\n        let notifier = Arc::new(MockNotifier);\r\n        let service = SupplierServiceImpl::new(repo.clone(), notifier);\r\n\r\n        let mut supplier = create_sample_supplier();\r\n        service.save_supplier(supplier.clone()).unwrap();\r\n\r\n        supplier.name = \"Updated Supplier\".to_string();\r\n        let update_result = service.update_supplier(supplier.clone());\r\n\r\n        assert!(update_result.is_ok());\r\n        let updated = repo.find_by_id(\"SUP-123\").unwrap();\r\n        assert_eq!(updated.name, \"Updated Supplier\");\r\n    }\r\n\r\n    #[test]\r\n    fn test_update_supplier_failure() {\r\n        let repo = Arc::new(SupplierRepositoryImpl::new());\r\n        let notifier = Arc::new(MockNotifier);\r\n        let service = SupplierServiceImpl::new(repo.clone(), notifier);\r\n\r\n        let supplier = create_sample_supplier();\r\n        let result = service.update_supplier(supplier);\r\n\r\n        assert!(result.is_err());\r\n        assert_eq!(result.unwrap_err(), \"Supplier not found\".to_string());\r\n    }\r\n\r\n    #[test]\r\n    fn test_delete_supplier_success() {\r\n        let repo = Arc::new(SupplierRepositoryImpl::new());\r\n        let notifier = Arc::new(MockNotifier);\r\n        let service = SupplierServiceImpl::new(repo.clone(), notifier);\r\n\r\n        let supplier = create_sample_supplier();\r\n        service.save_supplier(supplier.clone()).unwrap();\r\n\r\n        let delete_result = service.delete_supplier(\u0026supplier.id);\r\n        assert!(delete_result.is_ok());\r\n\r\n        let found = repo.find_by_id(\u0026supplier.id);\r\n        assert!(found.is_none());\r\n    }\r\n\r\n    #[test]\r\n    fn test_delete_supplier_failure() {\r\n        let repo = Arc::new(SupplierRepositoryImpl::new());\r\n        let notifier = Arc::new(MockNotifier);\r\n        let service = SupplierServiceImpl::new(repo.clone(), notifier);\r\n\r\n        let result = service.delete_supplier(\"UNKNOWN-ID\");\r\n        assert!(result.is_err());\r\n        assert_eq!(result.unwrap_err(), \"Supplier not found\".to_string());\r\n    }\r\n\r\n    #[test]\r\n    fn test_get_supplier_success() {\r\n        let repo = Arc::new(SupplierRepositoryImpl::new());\r\n        let notifier = Arc::new(MockNotifier);\r\n        let service = SupplierServiceImpl::new(repo.clone(), notifier);\r\n\r\n        let supplier = create_sample_supplier();\r\n        service.save_supplier(supplier.clone()).unwrap();\r\n\r\n        let result = service.get_supplier(\u0026supplier.id);\r\n        assert!(result.is_some());\r\n        assert_eq!(result.unwrap().name, supplier.name);\r\n    }\r\n\r\n    #[test]\r\n    fn test_get_supplier_not_found() {\r\n        let repo = Arc::new(SupplierRepositoryImpl::new());\r\n        let notifier = Arc::new(MockNotifier);\r\n        let service = SupplierServiceImpl::new(repo.clone(), notifier);\r\n\r\n        let result = service.get_supplier(\"UNKNOWN\");\r\n        assert!(result.is_none());\r\n    }\r\n}\r\n","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","manajemen_supplier","test","service","supplier_transaction_logger_test.rs"],"content":"#[cfg(test)]\r\nmod tests {\r\n    use std::sync::{Arc, Mutex};\r\n\r\n    use chrono::Utc;\r\n\r\n    use crate::manajemen_supplier::main::model::supplier::Supplier;\r\n    use crate::manajemen_supplier::main::model::supplier_transaction::SupplierTransaction;\r\n    use crate::manajemen_supplier::main::repository::supplier_transaction_repository::SupplierTransactionRepository;\r\n    use crate::manajemen_supplier::main::patterns::observer::SupplierObserver;\r\n    use crate::manajemen_supplier::main::service::supplier_transaction_logger::SupplierTransactionLogger;\r\n\r\n    struct MockSupplierTransactionRepository {\r\n        pub saved_transaction: Arc\u003cMutex\u003cOption\u003cSupplierTransaction\u003e\u003e\u003e,\r\n    }\r\n\r\n    impl SupplierTransactionRepository for MockSupplierTransactionRepository {\r\n        fn save(\u0026self, trx: SupplierTransaction) -\u003e Result\u003cSupplierTransaction, std::string::String\u003e {\r\n            let mut lock = self.saved_transaction.lock().unwrap();\r\n            *lock = Some(trx.clone());\r\n            Ok(trx)\r\n        }\r\n\r\n        fn find_by_id(\u0026self, _id: \u0026str) -\u003e Option\u003cSupplierTransaction\u003e {\r\n            None\r\n        }\r\n    \r\n        fn find_by_supplier_id(\u0026self, _supplier_id: \u0026str) -\u003e Vec\u003cSupplierTransaction\u003e {\r\n            vec![]\r\n        }\r\n    }\r\n\r\n    fn sample_supplier() -\u003e Supplier {\r\n        Supplier {\r\n            id: \"SUP-123\".to_string(),\r\n            name: \"PT. Pt\".to_string(),\r\n            jenis_barang: \"Ayam\".to_string(),\r\n            jumlah_barang: 10,\r\n            resi: \"RESI123\".to_string(),\r\n            updated_at: Utc::now(),\r\n        }\r\n    }\r\n\r\n    #[test]\r\n    fn test_on_supplier_saved_logs_transaction() {\r\n        let saved_trx = Arc::new(Mutex::new(None));\r\n\r\n        let mock_repo = Arc::new(MockSupplierTransactionRepository {\r\n            saved_transaction: saved_trx.clone(),\r\n        });\r\n\r\n        let logger = SupplierTransactionLogger::new(mock_repo);\r\n        let supplier = sample_supplier();\r\n        logger.on_supplier_saved(\u0026supplier);\r\n\r\n        let logged = saved_trx.lock().unwrap();\r\n        assert!(logged.is_some());\r\n        let trx = logged.as_ref().unwrap();\r\n\r\n        assert_eq!(trx.supplier_id, \"SUP-123\");\r\n        assert_eq!(trx.supplier_name, \"PT. Pt\");\r\n        assert_eq!(trx.jenis_barang, \"Ayam\");\r\n        assert_eq!(trx.jumlah_barang, 10);\r\n        assert_eq!(trx.pengiriman_info, \"RESI123\");\r\n    }\r\n}\r\n","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","main","controller","mod.rs"],"content":"pub mod transaksi_controller;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","main","controller","transaksi_controller.rs"],"content":"use crate::transaksi_penjualan::main::model::transaksi::Transaksi;\r\nuse crate::transaksi_penjualan::main::service::transaksi_service::TransaksiService;\r\nuse std::collections::HashMap;\r\nuse std::sync::Arc;\r\n\r\npub struct TransaksiController {\r\n    pub service: Arc\u003cTransaksiService\u003e,\r\n}\r\n\r\nimpl TransaksiController {\r\n    pub fn buat_transaksi(\u0026self, kasir_id: String, pelanggan_id: String, produk: Vec\u003c(String, String, u32, f64)\u003e) -\u003e Result\u003cTransaksi, String\u003e {\r\n        self.service.buat_transaksi(kasir_id, pelanggan_id, produk)\r\n    }\r\n\r\n    pub fn lihat_transaksi(\u0026self, filters: Option\u003cHashMap\u003cString, String\u003e\u003e) -\u003e Vec\u003cTransaksi\u003e {\r\n        self.service.lihat_transaksi(filters)\r\n    }\r\n\r\n    pub fn update_transaksi(\u0026self, transaksi_id: \u0026str, produk_baru: Vec\u003c(String, String, u32, f64)\u003e) -\u003e Result\u003cTransaksi, String\u003e {\r\n        self.service.update_transaksi(transaksi_id, produk_baru)\r\n    }\r\n\r\n    pub fn batalkan_transaksi(\u0026self, transaksi_id: \u0026str) -\u003e Result\u003c(), String\u003e {\r\n        self.service.batalkan_transaksi(transaksi_id)\r\n    }\r\n}","traces":[{"line":11,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":12,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":15,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":16,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":19,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":20,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":23,"address":[],"length":0,"stats":{"Line":0}},{"line":24,"address":[],"length":0,"stats":{"Line":0}}],"covered":6,"coverable":8},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","main","enums","mod.rs"],"content":"pub mod status_transaksi;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","main","enums","status_transaksi.rs"],"content":"#[derive(Debug, Clone, PartialEq)]\r\npub enum StatusTransaksi {\r\n    MasihDiproses,\r\n    Selesai,\r\n    Dibatalkan,\r\n}\r\n\r\nimpl StatusTransaksi {\r\n    pub fn from_string(input: \u0026str) -\u003e Option\u003cSelf\u003e {\r\n        match input.to_uppercase().as_str() {\r\n            \"MASIHDIPROSES\" =\u003e Some(StatusTransaksi::MasihDiproses),\r\n            \"SELESAI\" =\u003e Some(StatusTransaksi::Selesai),\r\n            \"DIBATALKAN\" =\u003e Some(StatusTransaksi::Dibatalkan),\r\n            _ =\u003e None,\r\n        }\r\n    }\r\n\r\n    pub fn to_string(\u0026self) -\u003e String {\r\n        match self {\r\n            StatusTransaksi::MasihDiproses =\u003e \"MASIHDIPROSES\".to_string(),\r\n            StatusTransaksi::Selesai =\u003e \"SELESAI\".to_string(),\r\n            StatusTransaksi::Dibatalkan =\u003e \"DIBATALKAN\".to_string(),\r\n        }\r\n    }\r\n}\r\n","traces":[{"line":9,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":10,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":11,"address":[],"length":0,"stats":{"Line":360287970189639680}},{"line":12,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":13,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":14,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":18,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":19,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":20,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":21,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":22,"address":[],"length":0,"stats":{"Line":72057594037927936}}],"covered":11,"coverable":11},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","main","mod.rs"],"content":"pub mod model;\r\npub mod repository;\r\npub mod controller;\r\npub mod enums;\r\npub mod service;\r\npub mod patterns;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","main","model","mod.rs"],"content":"pub mod transaksi;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","main","model","transaksi.rs"],"content":"use chrono::{DateTime, Utc};\r\nuse uuid::Uuid;\r\n\r\nuse crate::transaksi_penjualan::main::enums::status_transaksi::StatusTransaksi;\r\n\r\n#[derive(Debug, Clone)]\r\npub struct Transaksi {\r\n    pub id: String,\r\n    pub waktu: DateTime\u003cUtc\u003e,\r\n    pub kasir_id: String,\r\n    pub pelanggan_id: String,\r\n    pub produk: Vec\u003cDetailProdukTransaksi\u003e,\r\n    pub status: StatusTransaksi,\r\n}\r\n\r\nimpl Transaksi {\r\n    pub fn buat_transaksi_baru( \r\n        kasir_id: String,\r\n        pelanggan_id: String,\r\n        produk: Vec\u003cDetailProdukTransaksi\u003e,\r\n    ) -\u003e Self {\r\n        Transaksi {\r\n            id: format!(\"TRX-{}\", Uuid::new_v4()),\r\n            waktu: Utc::now(),\r\n            kasir_id,\r\n            pelanggan_id,\r\n            produk,\r\n            status: StatusTransaksi::MasihDiproses,\r\n        }\r\n    }\r\n\r\n    pub fn total_harga(\u0026self) -\u003e f64 {\r\n        self.produk\r\n            .iter()\r\n            .map(|p| p.harga_satuan * p.jumlah as f64)\r\n            .sum()\r\n    }\r\n}\r\n\r\n#[derive(Debug, Clone)]\r\npub struct DetailProdukTransaksi {\r\n    pub produk_id: String,\r\n    pub nama_produk: String,\r\n    pub jumlah: u32,\r\n    pub harga_satuan: f64,\r\n}\r\n","traces":[{"line":17,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":23,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":24,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":32,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":33,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":35,"address":[],"length":0,"stats":{"Line":1008806316530991104}}],"covered":6,"coverable":6},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","main","patterns","mod.rs"],"content":"pub mod state;\r\npub mod observer;\r\n\r\npub use observer::{StokObserver, TransaksiObserver, TransaksiSubject};\r\n","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","main","patterns","observer.rs"],"content":"use crate::transaksi_penjualan::main::model::transaksi::Transaksi;\r\nuse crate::transaksi_penjualan::main::patterns::state::TransaksiStateContext;\r\n\r\npub trait TransaksiObserver: Send + Sync {\r\n    fn on_transaksi_selesai(\u0026self, transaksi: \u0026Transaksi);\r\n    fn on_transaksi_dibatalkan(\u0026self, transaksi: \u0026Transaksi);\r\n}\r\n\r\npub trait StokObserver: TransaksiObserver {\r\n\r\n}\r\n\r\npub struct TransaksiSubject {\r\n    state_context: TransaksiStateContext,\r\n    observers: Vec\u003cBox\u003cdyn TransaksiObserver\u003e\u003e,\r\n}\r\n\r\nimpl TransaksiSubject {\r\n    pub fn new(transaksi: Transaksi) -\u003e Self {\r\n        TransaksiSubject {\r\n            state_context: TransaksiStateContext::new(transaksi),\r\n            observers: Vec::new(),\r\n        }\r\n    }\r\n    \r\n    pub fn attach(\u0026mut self, observer: Box\u003cdyn TransaksiObserver\u003e) {\r\n        self.observers.push(observer);\r\n    }\r\n    \r\n    pub fn detach(\u0026mut self, index: usize) {\r\n        if index \u003c self.observers.len() {\r\n            self.observers.remove(index);\r\n        }\r\n    }\r\n    \r\n    pub fn update_produk(\u0026self, produk_baru: Vec\u003ccrate::transaksi_penjualan::main::model::transaksi::DetailProdukTransaksi\u003e) -\u003e Result\u003cTransaksi, String\u003e {\r\n        self.state_context.update_produk(produk_baru)\r\n    }\r\n    \r\n    pub fn selesaikan_transaksi(\u0026mut self) -\u003e Result\u003cTransaksi, String\u003e {\r\n        let result = self.state_context.selesaikan_transaksi();\r\n        if let Ok(transaksi) = \u0026result {\r\n            // Notify all observers that transaction is complete\r\n            for observer in \u0026self.observers {\r\n                observer.on_transaksi_selesai(transaksi);\r\n            }\r\n        }\r\n        result\r\n    }\r\n    \r\n    pub fn batalkan_transaksi(\u0026mut self) -\u003e Result\u003cTransaksi, String\u003e {\r\n        let result = self.state_context.batalkan_transaksi();\r\n        if let Ok(transaksi) = \u0026result {\r\n            // Notify all observers that transaction is canceled\r\n            for observer in \u0026self.observers {\r\n                observer.on_transaksi_dibatalkan(transaksi);\r\n            }\r\n        }\r\n        result\r\n    }\r\n}\r\n","traces":[{"line":19,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":21,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":22,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":26,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":27,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":30,"address":[],"length":0,"stats":{"Line":0}},{"line":31,"address":[],"length":0,"stats":{"Line":0}},{"line":32,"address":[],"length":0,"stats":{"Line":0}},{"line":36,"address":[],"length":0,"stats":{"Line":0}},{"line":37,"address":[],"length":0,"stats":{"Line":0}},{"line":40,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":41,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":42,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":44,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":45,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":48,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":51,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":52,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":53,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":55,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":56,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":59,"address":[],"length":0,"stats":{"Line":72057594037927936}}],"covered":17,"coverable":22},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","main","patterns","state.rs"],"content":"use crate::transaksi_penjualan::main::enums::status_transaksi::StatusTransaksi;\r\nuse crate::transaksi_penjualan::main::model::transaksi::{DetailProdukTransaksi, Transaksi};\r\n\r\npub trait TransaksiState {\r\n    fn update_produk(\u0026self, transaksi: \u0026Transaksi, produk_baru: Vec\u003cDetailProdukTransaksi\u003e) -\u003e Result\u003cTransaksi, String\u003e;\r\n    fn selesaikan_transaksi(\u0026self, transaksi: \u0026Transaksi) -\u003e Result\u003cTransaksi, String\u003e;\r\n    fn batalkan_transaksi(\u0026self, transaksi: \u0026Transaksi) -\u003e Result\u003cTransaksi, String\u003e;\r\n}\r\n\r\npub struct MasihDiprosesState;\r\npub struct SelesaiState;\r\npub struct DibatalkanState;\r\n\r\npub struct TransaksiStateContext {\r\n    transaksi: Transaksi,\r\n    state: Box\u003cdyn TransaksiState\u003e,\r\n}\r\n\r\nimpl TransaksiStateContext {\r\n    pub fn new(transaksi: Transaksi) -\u003e Self {\r\n        let state: Box\u003cdyn TransaksiState\u003e = match transaksi.status {\r\n            StatusTransaksi::MasihDiproses =\u003e Box::new(MasihDiprosesState),\r\n            StatusTransaksi::Selesai =\u003e Box::new(SelesaiState),\r\n            StatusTransaksi::Dibatalkan =\u003e Box::new(DibatalkanState),\r\n        };\r\n        \r\n        TransaksiStateContext { transaksi, state }\r\n    }\r\n    \r\n    pub fn update_produk(\u0026self, produk_baru: Vec\u003cDetailProdukTransaksi\u003e) -\u003e Result\u003cTransaksi, String\u003e {\r\n        self.state.update_produk(\u0026self.transaksi, produk_baru)\r\n    }\r\n    \r\n    pub fn selesaikan_transaksi(\u0026mut self) -\u003e Result\u003cTransaksi, String\u003e {\r\n        let result = self.state.selesaikan_transaksi(\u0026self.transaksi);\r\n        if let Ok(updated_transaksi) = \u0026result {\r\n            self.transaksi = updated_transaksi.clone();\r\n            self.state = Box::new(SelesaiState);\r\n        }\r\n        result\r\n    }\r\n    \r\n    pub fn batalkan_transaksi(\u0026mut self) -\u003e Result\u003cTransaksi, String\u003e {\r\n        let result = self.state.batalkan_transaksi(\u0026self.transaksi);\r\n        if let Ok(updated_transaksi) = \u0026result {\r\n            self.transaksi = updated_transaksi.clone();\r\n            self.state = Box::new(DibatalkanState);\r\n        }\r\n        result\r\n    }\r\n}\r\n\r\nimpl TransaksiState for MasihDiprosesState {\r\n    fn update_produk(\u0026self, transaksi: \u0026Transaksi, produk_baru: Vec\u003cDetailProdukTransaksi\u003e) -\u003e Result\u003cTransaksi, String\u003e {\r\n        let mut updated = transaksi.clone();\r\n        updated.produk = produk_baru;\r\n        Ok(updated)\r\n    }\r\n    \r\n    fn selesaikan_transaksi(\u0026self, transaksi: \u0026Transaksi) -\u003e Result\u003cTransaksi, String\u003e {\r\n        let mut updated = transaksi.clone();\r\n        updated.status = StatusTransaksi::Selesai;\r\n        Ok(updated)\r\n    }\r\n    \r\n    fn batalkan_transaksi(\u0026self, transaksi: \u0026Transaksi) -\u003e Result\u003cTransaksi, String\u003e {\r\n        let mut updated = transaksi.clone();\r\n        updated.status = StatusTransaksi::Dibatalkan;\r\n        Ok(updated)\r\n    }\r\n}\r\n\r\nimpl TransaksiState for SelesaiState {\r\n    fn update_produk(\u0026self, _transaksi: \u0026Transaksi, _produk_baru: Vec\u003cDetailProdukTransaksi\u003e) -\u003e Result\u003cTransaksi, String\u003e {\r\n        Err(\"Tidak dapat mengubah transaksi dengan status Selesai\".to_string())\r\n    }\r\n    \r\n    fn selesaikan_transaksi(\u0026self, transaksi: \u0026Transaksi) -\u003e Result\u003cTransaksi, String\u003e {\r\n        Ok(transaksi.clone())\r\n    }\r\n    \r\n    fn batalkan_transaksi(\u0026self, _transaksi: \u0026Transaksi) -\u003e Result\u003cTransaksi, String\u003e {\r\n        Err(\"Tidak dapat membatalkan transaksi dengan status Selesai\".to_string())\r\n    }\r\n}\r\n\r\nimpl TransaksiState for DibatalkanState {\r\n    fn update_produk(\u0026self, _transaksi: \u0026Transaksi, _produk_baru: Vec\u003cDetailProdukTransaksi\u003e) -\u003e Result\u003cTransaksi, String\u003e {\r\n        Err(\"Tidak dapat mengubah transaksi dengan status Dibatalkan\".to_string())\r\n    }\r\n    \r\n    fn selesaikan_transaksi(\u0026self, _transaksi: \u0026Transaksi) -\u003e Result\u003cTransaksi, String\u003e {\r\n        Err(\"Tidak dapat menyelesaikan transaksi dengan status Dibatalkan\".to_string())\r\n    }\r\n    \r\n    fn batalkan_transaksi(\u0026self, transaksi: \u0026Transaksi) -\u003e Result\u003cTransaksi, String\u003e {\r\n        Ok(transaksi.clone())\r\n    }\r\n}\r\n","traces":[{"line":20,"address":[],"length":0,"stats":{"Line":576460752303423488}},{"line":21,"address":[],"length":0,"stats":{"Line":1152921504606846976}},{"line":22,"address":[],"length":0,"stats":{"Line":360287970189639680}},{"line":23,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":24,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":30,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":31,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":34,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":35,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":36,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":40,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":43,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":44,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":45,"address":[],"length":0,"stats":{"Line":360287970189639680}},{"line":49,"address":[],"length":0,"stats":{"Line":216172782113783808}},{"line":54,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":55,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":56,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":57,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":60,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":61,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":62,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":63,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":66,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":67,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":68,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":69,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":74,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":75,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":78,"address":[],"length":0,"stats":{"Line":0}},{"line":79,"address":[],"length":0,"stats":{"Line":0}},{"line":82,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":83,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":88,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":89,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":92,"address":[],"length":0,"stats":{"Line":0}},{"line":93,"address":[],"length":0,"stats":{"Line":0}},{"line":96,"address":[],"length":0,"stats":{"Line":0}},{"line":97,"address":[],"length":0,"stats":{"Line":0}}],"covered":33,"coverable":39},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","main","repository","mod.rs"],"content":"pub mod transaksi_repository;\r\npub mod transaksi_repository_impl;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","main","repository","transaksi_repository.rs"],"content":"use std::collections::HashMap;\r\n\r\nuse crate::transaksi_penjualan::main::model::transaksi::Transaksi;\r\n\r\npub trait TransaksiRepository: Send + Sync {\r\n    fn save(\u0026self, transaksi: Transaksi) -\u003e Result\u003cTransaksi, String\u003e;\r\n    fn find_by_id(\u0026self, id: \u0026str) -\u003e Option\u003cTransaksi\u003e;\r\n    fn find_all(\u0026self, filters: Option\u003cHashMap\u003cString, String\u003e\u003e) -\u003e Vec\u003cTransaksi\u003e;\r\n    fn delete(\u0026self, id: \u0026str) -\u003e Result\u003c(), String\u003e;\r\n    fn update(\u0026self, transaksi: Transaksi) -\u003e Result\u003cTransaksi, String\u003e;\r\n}\r\n","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","main","repository","transaksi_repository_impl.rs"],"content":"use std::collections::HashMap;\r\nuse std::sync::{Arc, Mutex};\r\n\r\nuse crate::transaksi_penjualan::main::enums::status_transaksi::StatusTransaksi;\r\nuse crate::transaksi_penjualan::main::model::transaksi::Transaksi;\r\nuse crate::transaksi_penjualan::main::repository::transaksi_repository::TransaksiRepository;\r\n\r\npub struct TransaksiRepositoryImpl {\r\n    transaksi_map: Arc\u003cMutex\u003cHashMap\u003cString, Transaksi\u003e\u003e\u003e,\r\n}\r\n\r\nimpl TransaksiRepositoryImpl {\r\n    pub fn new() -\u003e Self {\r\n        Self {\r\n            transaksi_map: Arc::new(Mutex::new(HashMap::new())),\r\n        }\r\n    }\r\n}\r\n\r\nimpl TransaksiRepository for TransaksiRepositoryImpl {\r\n    fn save(\u0026self, transaksi: Transaksi) -\u003e Result\u003cTransaksi, String\u003e {\r\n        let mut transaksi_map = self.transaksi_map.lock().unwrap();\r\n        let transaksi_clone = transaksi.clone();\r\n        transaksi_map.insert(transaksi.id.clone(), transaksi);\r\n        Ok(transaksi_clone)\r\n    }\r\n\r\n    fn find_by_id(\u0026self, id: \u0026str) -\u003e Option\u003cTransaksi\u003e {\r\n        let transaksi_map = self.transaksi_map.lock().unwrap();\r\n        transaksi_map.get(id).cloned()\r\n    }\r\n\r\n    fn find_all(\u0026self, filters: Option\u003cHashMap\u003cString, String\u003e\u003e) -\u003e Vec\u003cTransaksi\u003e {\r\n        let transaksi_map = self.transaksi_map.lock().unwrap();\r\n        let mut result: Vec\u003cTransaksi\u003e = transaksi_map.values().cloned().collect();\r\n\r\n        if let Some(filter_map) = filters {\r\n            if let Some(status_str) = filter_map.get(\"status\") {\r\n                if let Some(status_enum) = StatusTransaksi::from_string(status_str) {\r\n                    result = result\r\n                        .into_iter()\r\n                        .filter(|trx| trx.status == status_enum)\r\n                        .collect();\r\n                }\r\n            }\r\n\r\n            if let Some(pelanggan_id) = filter_map.get(\"pelanggan_id\") {\r\n                result = result\r\n                    .into_iter()\r\n                    .filter(|trx| trx.pelanggan_id == *pelanggan_id)\r\n                    .collect();\r\n            }\r\n\r\n            if let Some(kasir_id) = filter_map.get(\"kasir_id\") {\r\n                result = result\r\n                    .into_iter()\r\n                    .filter(|trx| trx.kasir_id == *kasir_id)\r\n                    .collect();\r\n            }\r\n        }\r\n\r\n        result\r\n    }\r\n\r\n    fn update(\u0026self, transaksi: Transaksi) -\u003e Result\u003cTransaksi, String\u003e {\r\n        let mut transaksi_map = self.transaksi_map.lock().unwrap();\r\n        if !transaksi_map.contains_key(\u0026transaksi.id) {\r\n            return Err(format!(\"Transaksi dengan ID {} tidak ditemukan\", transaksi.id));\r\n        }\r\n        let transaksi_clone = transaksi.clone();\r\n        transaksi_map.insert(transaksi.id.clone(), transaksi);\r\n        Ok(transaksi_clone)\r\n    }\r\n\r\n    fn delete(\u0026self, id: \u0026str) -\u003e Result\u003c(), String\u003e {\r\n        let mut transaksi_map = self.transaksi_map.lock().unwrap();\r\n        if transaksi_map.remove(id).is_none() {\r\n            return Err(format!(\"Transaksi dengan ID {} tidak ditemukan\", id));\r\n        }\r\n        Ok(())\r\n    }\r\n}\r\n","traces":[{"line":13,"address":[],"length":0,"stats":{"Line":720575940379279360}},{"line":15,"address":[],"length":0,"stats":{"Line":720575940379279360}},{"line":21,"address":[],"length":0,"stats":{"Line":648518346341351424}},{"line":22,"address":[],"length":0,"stats":{"Line":648518346341351424}},{"line":23,"address":[],"length":0,"stats":{"Line":648518346341351424}},{"line":24,"address":[],"length":0,"stats":{"Line":648518346341351424}},{"line":25,"address":[],"length":0,"stats":{"Line":648518346341351424}},{"line":28,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":29,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":30,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":33,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":34,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":35,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":37,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":38,"address":[],"length":0,"stats":{"Line":0}},{"line":39,"address":[],"length":0,"stats":{"Line":0}},{"line":42,"address":[],"length":0,"stats":{"Line":0}},{"line":47,"address":[],"length":0,"stats":{"Line":0}},{"line":50,"address":[],"length":0,"stats":{"Line":0}},{"line":54,"address":[],"length":0,"stats":{"Line":0}},{"line":57,"address":[],"length":0,"stats":{"Line":0}},{"line":62,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":65,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":66,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":67,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":68,"address":[],"length":0,"stats":{"Line":0}},{"line":70,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":71,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":72,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":75,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":76,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":77,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":78,"address":[],"length":0,"stats":{"Line":0}},{"line":80,"address":[],"length":0,"stats":{"Line":72057594037927936}}],"covered":25,"coverable":34},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","main","service","mod.rs"],"content":"pub mod transaksi_service;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","main","service","transaksi_service.rs"],"content":"use crate::transaksi_penjualan::main::enums::status_transaksi::StatusTransaksi;\r\nuse crate::transaksi_penjualan::main::model::transaksi::{DetailProdukTransaksi, Transaksi};\r\nuse crate::transaksi_penjualan::main::repository::transaksi_repository::TransaksiRepository;\r\nuse std::collections::HashMap;\r\nuse std::sync::Arc;\r\n\r\npub struct TransaksiService {\r\n    pub repo: Arc\u003cdyn TransaksiRepository\u003e,\r\n}\r\n\r\nimpl TransaksiService {\r\n    pub fn buat_transaksi(\u0026self, kasir_id: String, pelanggan_id: String, produk_data: Vec\u003c(String, String, u32, f64)\u003e) -\u003e Result\u003cTransaksi, String\u003e {\r\n        let produk: Vec\u003cDetailProdukTransaksi\u003e = produk_data\r\n            .into_iter()\r\n            .map(|(id, nama, jumlah, harga)| DetailProdukTransaksi {\r\n                produk_id: id,\r\n                nama_produk: nama,\r\n                jumlah,\r\n                harga_satuan: harga,\r\n            })\r\n            .collect();\r\n\r\n        let transaksi = Transaksi::buat_transaksi_baru(kasir_id, pelanggan_id, produk);\r\n        self.repo.save(transaksi)\r\n    }\r\n\r\n    pub fn lihat_transaksi(\u0026self, filters: Option\u003cHashMap\u003cString, String\u003e\u003e) -\u003e Vec\u003cTransaksi\u003e {\r\n        self.repo.find_all(filters)\r\n    }\r\n\r\n    pub fn update_transaksi(\u0026self, transaksi_id: \u0026str, produk_data: Vec\u003c(String, String, u32, f64)\u003e) -\u003e Result\u003cTransaksi, String\u003e {\r\n        let mut transaksi = self.repo.find_by_id(transaksi_id).ok_or(\"Transaksi tidak ditemukan\")?;\r\n\r\n        if transaksi.status != StatusTransaksi::MasihDiproses {\r\n            return Err(\"Transaksi sudah selesai dan tidak bisa diubah\".to_string());\r\n        }\r\n\r\n        let produk: Vec\u003cDetailProdukTransaksi\u003e = produk_data\r\n            .into_iter()\r\n            .map(|(id, nama, jumlah, harga)| DetailProdukTransaksi {\r\n                produk_id: id,\r\n                nama_produk: nama,\r\n                jumlah,\r\n                harga_satuan: harga,\r\n            })\r\n            .collect();\r\n\r\n        transaksi.produk = produk;\r\n        self.repo.update(transaksi)\r\n    }\r\n\r\n    pub fn batalkan_transaksi(\u0026self, transaksi_id: \u0026str) -\u003e Result\u003c(), String\u003e {\r\n        let mut transaksi = self.repo.find_by_id(transaksi_id).ok_or(\"Transaksi tidak ditemukan\")?;\r\n\r\n        if transaksi.status != StatusTransaksi::MasihDiproses {\r\n            return Err(\"Transaksi sudah selesai dan tidak bisa dibatalkan\".to_string());\r\n        }\r\n\r\n        transaksi.status = StatusTransaksi::Dibatalkan;\r\n        self.repo.update(transaksi)?;\r\n        Ok(())\r\n    }\r\n}\r\n","traces":[{"line":12,"address":[],"length":0,"stats":{"Line":360287970189639680}},{"line":13,"address":[],"length":0,"stats":{"Line":360287970189639680}},{"line":15,"address":[],"length":0,"stats":{"Line":792633534417207296}},{"line":16,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":17,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":18,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":19,"address":[],"length":0,"stats":{"Line":432345564227567616}},{"line":23,"address":[],"length":0,"stats":{"Line":360287970189639680}},{"line":24,"address":[],"length":0,"stats":{"Line":360287970189639680}},{"line":27,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":28,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":31,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":32,"address":[],"length":0,"stats":{"Line":288230376151711744}},{"line":35,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":38,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":40,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":41,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":42,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":43,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":44,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":52,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":53,"address":[],"length":0,"stats":{"Line":144115188075855872}},{"line":56,"address":[],"length":0,"stats":{"Line":0}},{"line":59,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":60,"address":[],"length":0,"stats":{"Line":72057594037927936}},{"line":61,"address":[],"length":0,"stats":{"Line":72057594037927936}}],"covered":25,"coverable":26},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","mod.rs"],"content":"// Modul utama dari `transaksi_penjualan`\r\npub mod main;\r\n\r\n#[cfg(test)]\r\npub mod test;\r\n","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","test","controller","mod.rs"],"content":"pub mod transaksi_controller_test;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","test","controller","transaksi_controller_test.rs"],"content":"#[cfg(test)]\r\nmod transaksi_controller_tests {\r\n    use crate::transaksi_penjualan::main::controller::transaksi_controller::TransaksiController;\r\n    use crate::transaksi_penjualan::main::repository::transaksi_repository_impl::TransaksiRepositoryImpl;\r\n    use crate::transaksi_penjualan::main::service::transaksi_service::TransaksiService;\r\n    use std::sync::Arc;\r\n\r\n    fn setup_controller() -\u003e TransaksiController {\r\n        let repo = Arc::new(TransaksiRepositoryImpl::new());\r\n        let service = Arc::new(TransaksiService { repo });\r\n        TransaksiController { service }\r\n    }\r\n\r\n    #[test]\r\n    fn test_controller_buat_transaksi() {\r\n        let controller = setup_controller();\r\n        let result = controller.buat_transaksi(\r\n            \"kasirX\".to_string(),\r\n            \"pelangganX\".to_string(),\r\n            vec![(\"p1\".to_string(), \"produkX\".to_string(), 3, 123.45)],\r\n        );\r\n\r\n        assert!(result.is_ok());\r\n        let transaksi = result.unwrap();\r\n        assert_eq!(transaksi.kasir_id, \"kasirX\");\r\n        assert_eq!(transaksi.produk.len(), 1);\r\n        assert_eq!(transaksi.total_harga(), 370.35);\r\n    }\r\n\r\n    #[test]\r\n    fn test_controller_lihat_transaksi_kosong() {\r\n        let controller = setup_controller();\r\n        let result = controller.lihat_transaksi(None);\r\n        assert!(result.is_empty());\r\n    }\r\n\r\n    #[test]\r\n    fn test_controller_update_transaksi() {\r\n        let controller = setup_controller();\r\n        let transaksi = controller\r\n            .buat_transaksi(\r\n                \"kasirY\".to_string(),\r\n                \"pelangganY\".to_string(),\r\n                vec![(\"p1\".to_string(), \"produkY\".to_string(), 1, 50.0)],\r\n            )\r\n            .unwrap();\r\n\r\n        let update_result = controller.update_transaksi(\r\n            \u0026transaksi.id,\r\n            vec![(\"p2\".to_string(), \"produkZ\".to_string(), 2, 25.0)],\r\n        );\r\n\r\n        assert!(update_result.is_ok());\r\n        let updated = update_result.unwrap();\r\n        assert_eq!(updated.total_harga(), 50.0);\r\n        assert_eq!(updated.produk.len(), 1);\r\n        assert_eq!(updated.produk[0].nama_produk, \"produkZ\");\r\n    }\r\n}\r\n","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","test","enums","mod.rs"],"content":"pub mod status_transaksi_test;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","test","enums","status_transaksi_test.rs"],"content":"#[cfg(test)]\r\nmod tests {\r\n    use crate::transaksi_penjualan::main::enums::status_transaksi::StatusTransaksi;\r\n\r\n    #[test]\r\n    fn test_status_transaksi_from_string() {\r\n        assert_eq!(\r\n            StatusTransaksi::from_string(\"masihdiproses\"),\r\n            Some(StatusTransaksi::MasihDiproses)\r\n        );\r\n        assert_eq!(\r\n            StatusTransaksi::from_string(\"SELESAI\"),\r\n            Some(StatusTransaksi::Selesai)\r\n        );\r\n        assert_eq!(\r\n            StatusTransaksi::from_string(\"dibatalkan\"),\r\n            Some(StatusTransaksi::Dibatalkan)\r\n        );\r\n        assert_eq!(StatusTransaksi::from_string(\"invalid\"), None);\r\n    }\r\n\r\n    #[test]\r\n    fn test_status_transaksi_to_string() {\r\n        assert_eq!(StatusTransaksi::MasihDiproses.to_string(), \"MASIHDIPROSES\");\r\n        assert_eq!(StatusTransaksi::Selesai.to_string(), \"SELESAI\");\r\n        assert_eq!(StatusTransaksi::Dibatalkan.to_string(), \"DIBATALKAN\");\r\n    }\r\n}\r\n","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","test","mod.rs"],"content":"pub mod model;\r\npub mod repository;\r\npub mod controller;\r\npub mod enums;\r\npub mod service;\r\npub mod patterns;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","test","model","mod.rs"],"content":"pub mod transaksi_test;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","test","model","transaksi_test.rs"],"content":"#[cfg(test)]\r\nmod tests {\r\n    use crate::transaksi_penjualan::main::enums::status_transaksi::StatusTransaksi;\r\n    use crate::transaksi_penjualan::main::model::transaksi::{Transaksi, DetailProdukTransaksi};\r\n\r\n    #[test]\r\n    fn test_buat_transaksi_baru() {\r\n        let transaksi = Transaksi::buat_transaksi_baru(\r\n            \"kasir123\".to_string(),\r\n            \"pelanggan123\".to_string(),\r\n            vec![\r\n                DetailProdukTransaksi {\r\n                    produk_id: \"produk1\".to_string(),\r\n                    nama_produk: \"Kopi\".to_string(),\r\n                    jumlah: 2,\r\n                    harga_satuan: 10000.0,\r\n                },\r\n                DetailProdukTransaksi {\r\n                    produk_id: \"produk2\".to_string(),\r\n                    nama_produk: \"Roti\".to_string(),\r\n                    jumlah: 1,\r\n                    harga_satuan: 5000.0,\r\n                },\r\n            ],\r\n        );\r\n\r\n        assert_eq!(transaksi.kasir_id, \"kasir123\");\r\n        assert_eq!(transaksi.pelanggan_id, \"pelanggan123\");\r\n        assert_eq!(transaksi.status, StatusTransaksi::MasihDiproses);\r\n        assert_eq!(transaksi.total_harga(), 25000.0);\r\n    }\r\n}","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","test","patterns","mod.rs"],"content":"pub mod state_test;\r\npub mod observer_test;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","test","patterns","observer_test.rs"],"content":"#[cfg(test)]\r\nmod tests { \r\n    use chrono::Utc;\r\n    use std::sync::{Arc, Mutex};\r\n\r\n    use crate::transaksi_penjualan::main::enums::status_transaksi::StatusTransaksi;\r\n    use crate::transaksi_penjualan::main::model::transaksi::{DetailProdukTransaksi, Transaksi};\r\n    use crate::transaksi_penjualan::main::patterns::{StokObserver, TransaksiObserver, TransaksiSubject};\r\n\r\n    struct MockStokManager {\r\n        stok_dikurangi: Arc\u003cMutex\u003cbool\u003e\u003e,\r\n        stok_dikembalikan: Arc\u003cMutex\u003cbool\u003e\u003e,\r\n    }\r\n\r\n    impl TransaksiObserver for MockStokManager {\r\n        fn on_transaksi_selesai(\u0026self, _transaksi: \u0026Transaksi) {\r\n            *self.stok_dikurangi.lock().unwrap() = true;\r\n        }\r\n        \r\n        fn on_transaksi_dibatalkan(\u0026self, _transaksi: \u0026Transaksi) {\r\n            *self.stok_dikembalikan.lock().unwrap() = true;\r\n        }\r\n    }\r\n\r\n    impl StokObserver for MockStokManager {}\r\n\r\n    #[test]\r\n    fn test_notify_observers_when_transaksi_selesai() {\r\n        let stok_dikurangi = Arc::new(Mutex::new(false));\r\n        let stok_dikembalikan = Arc::new(Mutex::new(false));\r\n        \r\n        let mock_stok_manager = MockStokManager {\r\n            stok_dikurangi: stok_dikurangi.clone(),\r\n            stok_dikembalikan: stok_dikembalikan.clone(),\r\n        };\r\n        \r\n        let detail_produk = DetailProdukTransaksi {\r\n            produk_id: \"P-001\".to_string(),\r\n            nama_produk: \"Produk A\".to_string(),\r\n            jumlah: 2,\r\n            harga_satuan: 10000.0,\r\n        };\r\n        \r\n        let transaksi = Transaksi {\r\n            id: \"TRX-001\".to_string(),\r\n            waktu: Utc::now(),\r\n            kasir_id: \"KSR-001\".to_string(),\r\n            pelanggan_id: \"PLG-001\".to_string(),\r\n            produk: vec![detail_produk],\r\n            status: StatusTransaksi::MasihDiproses,\r\n        };\r\n        \r\n        let mut transaksi_subject = TransaksiSubject::new(transaksi);\r\n        transaksi_subject.attach(Box::new(mock_stok_manager));\r\n        \r\n        let updated_transaksi = transaksi_subject.selesaikan_transaksi().unwrap();\r\n        \r\n        assert_eq!(updated_transaksi.status, StatusTransaksi::Selesai);\r\n        assert_eq!(*stok_dikurangi.lock().unwrap(), true);\r\n        assert_eq!(*stok_dikembalikan.lock().unwrap(), false);\r\n    }\r\n\r\n    #[test]\r\n    fn test_notify_observers_when_transaksi_dibatalkan() {\r\n        let stok_dikurangi = Arc::new(Mutex::new(false));\r\n        let stok_dikembalikan = Arc::new(Mutex::new(false));\r\n        \r\n        let mock_stok_manager = MockStokManager {\r\n            stok_dikurangi: stok_dikurangi.clone(),\r\n            stok_dikembalikan: stok_dikembalikan.clone(),\r\n        };\r\n        \r\n        let detail_produk = DetailProdukTransaksi {\r\n            produk_id: \"P-001\".to_string(),\r\n            nama_produk: \"Produk A\".to_string(),\r\n            jumlah: 2,\r\n            harga_satuan: 10000.0,\r\n        };\r\n        \r\n        let transaksi = Transaksi {\r\n            id: \"TRX-001\".to_string(),\r\n            waktu: Utc::now(),\r\n            kasir_id: \"KSR-001\".to_string(),\r\n            pelanggan_id: \"PLG-001\".to_string(),\r\n            produk: vec![detail_produk],\r\n            status: StatusTransaksi::MasihDiproses,\r\n        };\r\n        \r\n        let mut transaksi_subject = TransaksiSubject::new(transaksi);\r\n        transaksi_subject.attach(Box::new(mock_stok_manager));\r\n        \r\n        let updated_transaksi = transaksi_subject.batalkan_transaksi().unwrap();\r\n        \r\n        assert_eq!(updated_transaksi.status, StatusTransaksi::Dibatalkan);\r\n        assert_eq!(*stok_dikurangi.lock().unwrap(), false);\r\n        assert_eq!(*stok_dikembalikan.lock().unwrap(), true);\r\n    }\r\n}\r\n","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","test","patterns","state_test.rs"],"content":"#[cfg(test)]\r\nmod tests {\r\n    use chrono::Utc;\r\n    use std::vec;\r\n\r\n    use crate::transaksi_penjualan::main::enums::status_transaksi::StatusTransaksi;\r\n    use crate::transaksi_penjualan::main::model::transaksi::{DetailProdukTransaksi, Transaksi};\r\n    use crate::transaksi_penjualan::main::patterns::state::TransaksiStateContext;\r\n\r\n    #[test]\r\n    fn test_masih_diproses_state_can_update() {\r\n        let detail_produk = DetailProdukTransaksi {\r\n            produk_id: \"P-001\".to_string(),\r\n            nama_produk: \"Produk A\".to_string(),\r\n            jumlah: 2,\r\n            harga_satuan: 10000.0,\r\n        };\r\n        \r\n        let transaksi = Transaksi {\r\n            id: \"TRX-001\".to_string(),\r\n            waktu: Utc::now(),\r\n            kasir_id: \"KSR-001\".to_string(),\r\n            pelanggan_id: \"PLG-001\".to_string(),\r\n            produk: vec![detail_produk],\r\n            status: StatusTransaksi::MasihDiproses,\r\n        };\r\n        \r\n        let state_context = TransaksiStateContext::new(transaksi);\r\n        \r\n        let new_detail_produk = DetailProdukTransaksi {\r\n            produk_id: \"P-002\".to_string(),\r\n            nama_produk: \"Produk B\".to_string(),\r\n            jumlah: 1,\r\n            harga_satuan: 5000.0,\r\n        };\r\n        \r\n        let result = state_context.update_produk(vec![new_detail_produk]);\r\n        \r\n        assert!(result.is_ok());\r\n        let updated_transaksi = result.unwrap();\r\n        assert_eq!(updated_transaksi.produk.len(), 1);\r\n        assert_eq!(updated_transaksi.produk[0].produk_id, \"P-002\");\r\n    }\r\n\r\n    #[test]\r\n    fn test_selesai_state_cannot_update() {\r\n        let detail_produk = DetailProdukTransaksi {\r\n            produk_id: \"P-001\".to_string(),\r\n            nama_produk: \"Produk A\".to_string(),\r\n            jumlah: 2,\r\n            harga_satuan: 10000.0,\r\n        };\r\n        \r\n        let transaksi = Transaksi {\r\n            id: \"TRX-001\".to_string(),\r\n            waktu: Utc::now(),\r\n            kasir_id: \"KSR-001\".to_string(),\r\n            pelanggan_id: \"PLG-001\".to_string(),\r\n            produk: vec![detail_produk],\r\n            status: StatusTransaksi::Selesai,\r\n        };\r\n        \r\n        let state_context = TransaksiStateContext::new(transaksi);\r\n        \r\n        let new_detail_produk = DetailProdukTransaksi {\r\n            produk_id: \"P-002\".to_string(),\r\n            nama_produk: \"Produk B\".to_string(),\r\n            jumlah: 1,\r\n            harga_satuan: 5000.0,\r\n        };\r\n        \r\n        let result = state_context.update_produk(vec![new_detail_produk]);\r\n        \r\n        assert!(result.is_err());\r\n        assert_eq!(\r\n            result.unwrap_err(),\r\n            \"Tidak dapat mengubah transaksi dengan status Selesai\"\r\n        );\r\n    }\r\n\r\n    #[test]\r\n    fn test_dibatalkan_state_cannot_update() {\r\n        let detail_produk = DetailProdukTransaksi {\r\n            produk_id: \"P-001\".to_string(),\r\n            nama_produk: \"Produk A\".to_string(),\r\n            jumlah: 2,\r\n            harga_satuan: 10000.0,\r\n        };\r\n        \r\n        let transaksi = Transaksi {\r\n            id: \"TRX-001\".to_string(),\r\n            waktu: Utc::now(),\r\n            kasir_id: \"KSR-001\".to_string(),\r\n            pelanggan_id: \"PLG-001\".to_string(),\r\n            produk: vec![detail_produk],\r\n            status: StatusTransaksi::Dibatalkan,\r\n        };\r\n        \r\n        let state_context = TransaksiStateContext::new(transaksi);\r\n        \r\n        let new_detail_produk = DetailProdukTransaksi {\r\n            produk_id: \"P-002\".to_string(),\r\n            nama_produk: \"Produk B\".to_string(),\r\n            jumlah: 1,\r\n            harga_satuan: 5000.0,\r\n        };\r\n        \r\n        let result = state_context.update_produk(vec![new_detail_produk]);\r\n        \r\n        assert!(result.is_err());\r\n        assert_eq!(\r\n            result.unwrap_err(),\r\n            \"Tidak dapat mengubah transaksi dengan status Dibatalkan\"\r\n        );\r\n    }\r\n\r\n    #[test]\r\n    fn test_change_status_from_masih_diproses_to_selesai() {\r\n        let detail_produk = DetailProdukTransaksi {\r\n            produk_id: \"P-001\".to_string(),\r\n            nama_produk: \"Produk A\".to_string(),\r\n            jumlah: 2,\r\n            harga_satuan: 10000.0,\r\n        };\r\n        \r\n        let transaksi = Transaksi {\r\n            id: \"TRX-001\".to_string(),\r\n            waktu: Utc::now(),\r\n            kasir_id: \"KSR-001\".to_string(),\r\n            pelanggan_id: \"PLG-001\".to_string(),\r\n            produk: vec![detail_produk],\r\n            status: StatusTransaksi::MasihDiproses,\r\n        };\r\n        \r\n        let mut state_context = TransaksiStateContext::new(transaksi);\r\n        \r\n        let result = state_context.selesaikan_transaksi();\r\n        \r\n        assert!(result.is_ok());\r\n        let updated_transaksi = result.unwrap();\r\n        assert_eq!(updated_transaksi.status, StatusTransaksi::Selesai);\r\n    }\r\n\r\n    #[test]\r\n    fn test_change_status_from_masih_diproses_to_dibatalkan() {\r\n        let detail_produk = DetailProdukTransaksi {\r\n            produk_id: \"P-001\".to_string(),\r\n            nama_produk: \"Produk A\".to_string(),\r\n            jumlah: 2,\r\n            harga_satuan: 10000.0,\r\n        };\r\n        \r\n        let transaksi = Transaksi {\r\n            id: \"TRX-001\".to_string(),\r\n            waktu: Utc::now(),\r\n            kasir_id: \"KSR-001\".to_string(),\r\n            pelanggan_id: \"PLG-001\".to_string(),\r\n            produk: vec![detail_produk],\r\n            status: StatusTransaksi::MasihDiproses,\r\n        };\r\n        \r\n        let mut state_context = TransaksiStateContext::new(transaksi);\r\n        \r\n        let result = state_context.batalkan_transaksi();\r\n        \r\n        assert!(result.is_ok());\r\n        let updated_transaksi = result.unwrap();\r\n        assert_eq!(updated_transaksi.status, StatusTransaksi::Dibatalkan);\r\n    }\r\n\r\n    #[test]\r\n    fn test_cannot_change_status_from_selesai_to_dibatalkan() {\r\n        let detail_produk = DetailProdukTransaksi {\r\n            produk_id: \"P-001\".to_string(),\r\n            nama_produk: \"Produk A\".to_string(),\r\n            jumlah: 2,\r\n            harga_satuan: 10000.0,\r\n        };\r\n        \r\n        let transaksi = Transaksi {\r\n            id: \"TRX-001\".to_string(),\r\n            waktu: Utc::now(),\r\n            kasir_id: \"KSR-001\".to_string(),\r\n            pelanggan_id: \"PLG-001\".to_string(),\r\n            produk: vec![detail_produk],\r\n            status: StatusTransaksi::Selesai,\r\n        };\r\n        \r\n        let mut state_context = TransaksiStateContext::new(transaksi);\r\n        \r\n        let result = state_context.batalkan_transaksi();\r\n        \r\n        assert!(result.is_err());\r\n        assert_eq!(\r\n            result.unwrap_err(),\r\n            \"Tidak dapat membatalkan transaksi dengan status Selesai\"\r\n        );\r\n    }\r\n}\r\n","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","test","repository","mod.rs"],"content":"pub mod transaksi_repository_test;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","test","repository","transaksi_repository_test.rs"],"content":"#[cfg(test)]\r\nmod tests {\r\n    use chrono::Utc;\r\n    use uuid::Uuid;\r\n\r\n    use crate::transaksi_penjualan::main::model::transaksi::{DetailProdukTransaksi, Transaksi};\r\n    use crate::transaksi_penjualan::main::enums::status_transaksi::StatusTransaksi;\r\n    use crate::transaksi_penjualan::main::repository::transaksi_repository::TransaksiRepository;\r\n    use crate::transaksi_penjualan::main::repository::transaksi_repository_impl::TransaksiRepositoryImpl;\r\n\r\n    #[test]\r\n    fn test_simpan_transaksi() {\r\n        let repo = TransaksiRepositoryImpl::new();\r\n        let detail = DetailProdukTransaksi {\r\n            produk_id: \"PRD-001\".to_string(),\r\n            nama_produk: \"Produk A\".to_string(),\r\n            jumlah: 3,\r\n            harga_satuan: 15000.0,\r\n        };\r\n\r\n        let transaksi = Transaksi {\r\n            id: format!(\"TRX-{}\", Uuid::new_v4()),\r\n            pelanggan_id: \"PLG-001\".to_string(),\r\n            kasir_id: \"KSR-001\".to_string(),\r\n            waktu: Utc::now(),\r\n            produk: vec![detail.clone()],\r\n            status: StatusTransaksi::MasihDiproses,\r\n        };\r\n\r\n        let result = repo.save(transaksi.clone());\r\n        assert!(result.is_ok());\r\n        assert_eq!(result.unwrap().id, transaksi.id);\r\n    }\r\n\r\n    #[test]\r\n    fn test_cari_transaksi_berdasarkan_id() {\r\n        let repo = TransaksiRepositoryImpl::new();\r\n        let transaksi_id = format!(\"TRX-{}\", Uuid::new_v4());\r\n\r\n        let transaksi = Transaksi {\r\n            id: transaksi_id.clone(),\r\n            pelanggan_id: \"PLG-001\".to_string(),\r\n            kasir_id: \"KSR-001\".to_string(),\r\n            waktu: Utc::now(),\r\n            produk: vec![],\r\n            status: StatusTransaksi::MasihDiproses,\r\n        };\r\n\r\n        repo.save(transaksi.clone()).unwrap();\r\n        let result = repo.find_by_id(\u0026transaksi_id);\r\n\r\n        assert!(result.is_some());\r\n        assert_eq!(result.unwrap().id, transaksi_id);\r\n    }\r\n\r\n    #[test]\r\n    fn test_update_transaksi() {\r\n        let repo = TransaksiRepositoryImpl::new();\r\n        let transaksi_id = format!(\"TRX-{}\", Uuid::new_v4());\r\n\r\n        let mut transaksi = Transaksi {\r\n            id: transaksi_id.clone(),\r\n            pelanggan_id: \"PLG-001\".to_string(),\r\n            kasir_id: \"KSR-001\".to_string(),\r\n            waktu: Utc::now(),\r\n            produk: vec![],\r\n            status: StatusTransaksi::MasihDiproses,\r\n        };\r\n\r\n        repo.save(transaksi.clone()).unwrap();\r\n\r\n        transaksi.status = StatusTransaksi::Selesai;\r\n        let updated = repo.update(transaksi.clone()).unwrap();\r\n\r\n        assert_eq!(updated.status, StatusTransaksi::Selesai);\r\n    }\r\n\r\n    #[test]\r\n    fn test_hapus_transaksi() {\r\n        let repo = TransaksiRepositoryImpl::new();\r\n        let transaksi_id = format!(\"TRX-{}\", Uuid::new_v4());\r\n\r\n        let transaksi = Transaksi {\r\n            id: transaksi_id.clone(),\r\n            pelanggan_id: \"PLG-001\".to_string(),\r\n            kasir_id: \"KSR-001\".to_string(),\r\n            waktu: Utc::now(),\r\n            produk: vec![],\r\n            status: StatusTransaksi::MasihDiproses,\r\n        };\r\n\r\n        repo.save(transaksi.clone()).unwrap();\r\n        let result = repo.delete(\u0026transaksi_id);\r\n\r\n        assert!(result.is_ok());\r\n        assert!(repo.find_by_id(\u0026transaksi_id).is_none());\r\n    }\r\n}","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","test","service","mod.rs"],"content":"pub mod transaksi_service_test;","traces":[],"covered":0,"coverable":0},{"path":["D:","\\","KULIAH CADANGAN","buildingstore","buildingstore-be","src","transaksi_penjualan","test","service","transaksi_service_test.rs"],"content":"#[cfg(test)]\r\nmod transaksi_service_tests {\r\n    use crate::transaksi_penjualan::main::enums::status_transaksi::StatusTransaksi;\r\n    use crate::transaksi_penjualan::main::repository::transaksi_repository_impl::TransaksiRepositoryImpl;\r\n    use crate::transaksi_penjualan::main::service::transaksi_service::TransaksiService;\r\n    use std::sync::Arc;\r\n\r\n    fn setup_service() -\u003e TransaksiService {\r\n        let repo = Arc::new(TransaksiRepositoryImpl::new());\r\n        TransaksiService { repo }\r\n    }\r\n\r\n    #[test]\r\n    fn test_buat_transaksi() {\r\n        let service = setup_service();\r\n        let result = service.buat_transaksi(\r\n            \"kasir1\".to_string(),\r\n            \"pelanggan1\".to_string(),\r\n            vec![\r\n                (\"p1\".to_string(), \"produk1\".to_string(), 2, 100.0),\r\n                (\"p2\".to_string(), \"produk2\".to_string(), 1, 150.0),\r\n            ],\r\n        );\r\n\r\n        assert!(result.is_ok());\r\n        let transaksi = result.unwrap();\r\n        assert_eq!(transaksi.kasir_id, \"kasir1\");\r\n        assert_eq!(transaksi.pelanggan_id, \"pelanggan1\");\r\n        assert_eq!(transaksi.produk.len(), 2);\r\n        assert_eq!(transaksi.total_harga(), 350.0);\r\n    }\r\n\r\n    #[test]\r\n    fn test_update_transaksi_gagal_setelah_selesai() {\r\n        let service = setup_service();\r\n        let mut transaksi = service\r\n            .buat_transaksi(\r\n                \"kasir2\".to_string(),\r\n                \"pelanggan2\".to_string(),\r\n                vec![(\"p3\".to_string(), \"produk3\".to_string(), 1, 200.0)],\r\n            )\r\n            .unwrap();\r\n\r\n        transaksi.status = StatusTransaksi::Selesai;\r\n        let _ = service.repo.update(transaksi.clone());\r\n\r\n        let result = service.update_transaksi(\r\n            \u0026transaksi.id,\r\n            vec![(\"p4\".to_string(), \"produk4\".to_string(), 2, 50.0)],\r\n        );\r\n        assert!(result.is_err());\r\n        assert_eq!(\r\n            result.unwrap_err(),\r\n            \"Transaksi sudah selesai dan tidak bisa diubah\"\r\n        );\r\n    }\r\n\r\n    #[test]\r\n    fn test_batalkan_transaksi() {\r\n        let service = setup_service();\r\n        let transaksi = service\r\n            .buat_transaksi(\r\n                \"kasir3\".to_string(),\r\n                \"pelanggan3\".to_string(),\r\n                vec![(\"p5\".to_string(), \"produk5\".to_string(), 1, 75.0)],\r\n            )\r\n            .unwrap();\r\n\r\n        let result = service.batalkan_transaksi(\u0026transaksi.id);\r\n        assert!(result.is_ok());\r\n\r\n        let updated = service.repo.find_by_id(\u0026transaksi.id).unwrap();\r\n        assert_eq!(updated.status, StatusTransaksi::Dibatalkan);\r\n    }\r\n}\r\n","traces":[],"covered":0,"coverable":0}]};
        var previousData = null;
    </script>
    <script crossorigin>/** @license React v16.13.1
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
'use strict';(function(d,r){"object"===typeof exports&&"undefined"!==typeof module?r(exports):"function"===typeof define&&define.amd?define(["exports"],r):(d=d||self,r(d.React={}))})(this,function(d){function r(a){for(var b="https://reactjs.org/docs/error-decoder.html?invariant="+a,c=1;c<arguments.length;c++)b+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+a+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}
function w(a,b,c){this.props=a;this.context=b;this.refs=ba;this.updater=c||ca}function da(){}function L(a,b,c){this.props=a;this.context=b;this.refs=ba;this.updater=c||ca}function ea(a,b,c){var g,e={},fa=null,d=null;if(null!=b)for(g in void 0!==b.ref&&(d=b.ref),void 0!==b.key&&(fa=""+b.key),b)ha.call(b,g)&&!ia.hasOwnProperty(g)&&(e[g]=b[g]);var h=arguments.length-2;if(1===h)e.children=c;else if(1<h){for(var k=Array(h),f=0;f<h;f++)k[f]=arguments[f+2];e.children=k}if(a&&a.defaultProps)for(g in h=a.defaultProps,
h)void 0===e[g]&&(e[g]=h[g]);return{$$typeof:x,type:a,key:fa,ref:d,props:e,_owner:M.current}}function va(a,b){return{$$typeof:x,type:a.type,key:b,ref:a.ref,props:a.props,_owner:a._owner}}function N(a){return"object"===typeof a&&null!==a&&a.$$typeof===x}function wa(a){var b={"=":"=0",":":"=2"};return"$"+(""+a).replace(/[=:]/g,function(a){return b[a]})}function ja(a,b,c,g){if(C.length){var e=C.pop();e.result=a;e.keyPrefix=b;e.func=c;e.context=g;e.count=0;return e}return{result:a,keyPrefix:b,func:c,
context:g,count:0}}function ka(a){a.result=null;a.keyPrefix=null;a.func=null;a.context=null;a.count=0;10>C.length&&C.push(a)}function O(a,b,c,g){var e=typeof a;if("undefined"===e||"boolean"===e)a=null;var d=!1;if(null===a)d=!0;else switch(e){case "string":case "number":d=!0;break;case "object":switch(a.$$typeof){case x:case xa:d=!0}}if(d)return c(g,a,""===b?"."+P(a,0):b),1;d=0;b=""===b?".":b+":";if(Array.isArray(a))for(var f=0;f<a.length;f++){e=a[f];var h=b+P(e,f);d+=O(e,h,c,g)}else if(null===a||
"object"!==typeof a?h=null:(h=la&&a[la]||a["@@iterator"],h="function"===typeof h?h:null),"function"===typeof h)for(a=h.call(a),f=0;!(e=a.next()).done;)e=e.value,h=b+P(e,f++),d+=O(e,h,c,g);else if("object"===e)throw c=""+a,Error(r(31,"[object Object]"===c?"object with keys {"+Object.keys(a).join(", ")+"}":c,""));return d}function Q(a,b,c){return null==a?0:O(a,"",b,c)}function P(a,b){return"object"===typeof a&&null!==a&&null!=a.key?wa(a.key):b.toString(36)}function ya(a,b,c){a.func.call(a.context,b,
a.count++)}function za(a,b,c){var g=a.result,e=a.keyPrefix;a=a.func.call(a.context,b,a.count++);Array.isArray(a)?R(a,g,c,function(a){return a}):null!=a&&(N(a)&&(a=va(a,e+(!a.key||b&&b.key===a.key?"":(""+a.key).replace(ma,"$&/")+"/")+c)),g.push(a))}function R(a,b,c,g,e){var d="";null!=c&&(d=(""+c).replace(ma,"$&/")+"/");b=ja(b,d,g,e);Q(a,za,b);ka(b)}function t(){var a=na.current;if(null===a)throw Error(r(321));return a}function S(a,b){var c=a.length;a.push(b);a:for(;;){var g=c-1>>>1,e=a[g];if(void 0!==
e&&0<D(e,b))a[g]=b,a[c]=e,c=g;else break a}}function n(a){a=a[0];return void 0===a?null:a}function E(a){var b=a[0];if(void 0!==b){var c=a.pop();if(c!==b){a[0]=c;a:for(var g=0,e=a.length;g<e;){var d=2*(g+1)-1,f=a[d],h=d+1,k=a[h];if(void 0!==f&&0>D(f,c))void 0!==k&&0>D(k,f)?(a[g]=k,a[h]=c,g=h):(a[g]=f,a[d]=c,g=d);else if(void 0!==k&&0>D(k,c))a[g]=k,a[h]=c,g=h;else break a}}return b}return null}function D(a,b){var c=a.sortIndex-b.sortIndex;return 0!==c?c:a.id-b.id}function F(a){for(var b=n(u);null!==
b;){if(null===b.callback)E(u);else if(b.startTime<=a)E(u),b.sortIndex=b.expirationTime,S(p,b);else break;b=n(u)}}function T(a){y=!1;F(a);if(!v)if(null!==n(p))v=!0,z(U);else{var b=n(u);null!==b&&G(T,b.startTime-a)}}function U(a,b){v=!1;y&&(y=!1,V());H=!0;var c=m;try{F(b);for(l=n(p);null!==l&&(!(l.expirationTime>b)||a&&!W());){var g=l.callback;if(null!==g){l.callback=null;m=l.priorityLevel;var e=g(l.expirationTime<=b);b=q();"function"===typeof e?l.callback=e:l===n(p)&&E(p);F(b)}else E(p);l=n(p)}if(null!==
l)var d=!0;else{var f=n(u);null!==f&&G(T,f.startTime-b);d=!1}return d}finally{l=null,m=c,H=!1}}function oa(a){switch(a){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1E4;default:return 5E3}}var f="function"===typeof Symbol&&Symbol.for,x=f?Symbol.for("react.element"):60103,xa=f?Symbol.for("react.portal"):60106,Aa=f?Symbol.for("react.fragment"):60107,Ba=f?Symbol.for("react.strict_mode"):60108,Ca=f?Symbol.for("react.profiler"):60114,Da=f?Symbol.for("react.provider"):60109,
Ea=f?Symbol.for("react.context"):60110,Fa=f?Symbol.for("react.forward_ref"):60112,Ga=f?Symbol.for("react.suspense"):60113,Ha=f?Symbol.for("react.memo"):60115,Ia=f?Symbol.for("react.lazy"):60116,la="function"===typeof Symbol&&Symbol.iterator,pa=Object.getOwnPropertySymbols,Ja=Object.prototype.hasOwnProperty,Ka=Object.prototype.propertyIsEnumerable,I=function(){try{if(!Object.assign)return!1;var a=new String("abc");a[5]="de";if("5"===Object.getOwnPropertyNames(a)[0])return!1;var b={};for(a=0;10>a;a++)b["_"+
String.fromCharCode(a)]=a;if("0123456789"!==Object.getOwnPropertyNames(b).map(function(a){return b[a]}).join(""))return!1;var c={};"abcdefghijklmnopqrst".split("").forEach(function(a){c[a]=a});return"abcdefghijklmnopqrst"!==Object.keys(Object.assign({},c)).join("")?!1:!0}catch(g){return!1}}()?Object.assign:function(a,b){if(null===a||void 0===a)throw new TypeError("Object.assign cannot be called with null or undefined");var c=Object(a);for(var g,e=1;e<arguments.length;e++){var d=Object(arguments[e]);
for(var f in d)Ja.call(d,f)&&(c[f]=d[f]);if(pa){g=pa(d);for(var h=0;h<g.length;h++)Ka.call(d,g[h])&&(c[g[h]]=d[g[h]])}}return c},ca={isMounted:function(a){return!1},enqueueForceUpdate:function(a,b,c){},enqueueReplaceState:function(a,b,c,d){},enqueueSetState:function(a,b,c,d){}},ba={};w.prototype.isReactComponent={};w.prototype.setState=function(a,b){if("object"!==typeof a&&"function"!==typeof a&&null!=a)throw Error(r(85));this.updater.enqueueSetState(this,a,b,"setState")};w.prototype.forceUpdate=
function(a){this.updater.enqueueForceUpdate(this,a,"forceUpdate")};da.prototype=w.prototype;f=L.prototype=new da;f.constructor=L;I(f,w.prototype);f.isPureReactComponent=!0;var M={current:null},ha=Object.prototype.hasOwnProperty,ia={key:!0,ref:!0,__self:!0,__source:!0},ma=/\/+/g,C=[],na={current:null},X;if("undefined"===typeof window||"function"!==typeof MessageChannel){var A=null,qa=null,ra=function(){if(null!==A)try{var a=q();A(!0,a);A=null}catch(b){throw setTimeout(ra,0),b;}},La=Date.now();var q=
function(){return Date.now()-La};var z=function(a){null!==A?setTimeout(z,0,a):(A=a,setTimeout(ra,0))};var G=function(a,b){qa=setTimeout(a,b)};var V=function(){clearTimeout(qa)};var W=function(){return!1};f=X=function(){}}else{var Y=window.performance,sa=window.Date,Ma=window.setTimeout,Na=window.clearTimeout;"undefined"!==typeof console&&(f=window.cancelAnimationFrame,"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),
"function"!==typeof f&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"));if("object"===typeof Y&&"function"===typeof Y.now)q=function(){return Y.now()};else{var Oa=sa.now();q=function(){return sa.now()-Oa}}var J=!1,K=null,Z=-1,ta=5,ua=0;W=function(){return q()>=ua};f=function(){};X=function(a){0>a||125<a?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):
ta=0<a?Math.floor(1E3/a):5};var B=new MessageChannel,aa=B.port2;B.port1.onmessage=function(){if(null!==K){var a=q();ua=a+ta;try{K(!0,a)?aa.postMessage(null):(J=!1,K=null)}catch(b){throw aa.postMessage(null),b;}}else J=!1};z=function(a){K=a;J||(J=!0,aa.postMessage(null))};G=function(a,b){Z=Ma(function(){a(q())},b)};V=function(){Na(Z);Z=-1}}var p=[],u=[],Pa=1,l=null,m=3,H=!1,v=!1,y=!1,Qa=0;B={ReactCurrentDispatcher:na,ReactCurrentOwner:M,IsSomeRendererActing:{current:!1},assign:I};I(B,{Scheduler:{__proto__:null,
unstable_ImmediatePriority:1,unstable_UserBlockingPriority:2,unstable_NormalPriority:3,unstable_IdlePriority:5,unstable_LowPriority:4,unstable_runWithPriority:function(a,b){switch(a){case 1:case 2:case 3:case 4:case 5:break;default:a=3}var c=m;m=a;try{return b()}finally{m=c}},unstable_next:function(a){switch(m){case 1:case 2:case 3:var b=3;break;default:b=m}var c=m;m=b;try{return a()}finally{m=c}},unstable_scheduleCallback:function(a,b,c){var d=q();if("object"===typeof c&&null!==c){var e=c.delay;
e="number"===typeof e&&0<e?d+e:d;c="number"===typeof c.timeout?c.timeout:oa(a)}else c=oa(a),e=d;c=e+c;a={id:Pa++,callback:b,priorityLevel:a,startTime:e,expirationTime:c,sortIndex:-1};e>d?(a.sortIndex=e,S(u,a),null===n(p)&&a===n(u)&&(y?V():y=!0,G(T,e-d))):(a.sortIndex=c,S(p,a),v||H||(v=!0,z(U)));return a},unstable_cancelCallback:function(a){a.callback=null},unstable_wrapCallback:function(a){var b=m;return function(){var c=m;m=b;try{return a.apply(this,arguments)}finally{m=c}}},unstable_getCurrentPriorityLevel:function(){return m},
unstable_shouldYield:function(){var a=q();F(a);var b=n(p);return b!==l&&null!==l&&null!==b&&null!==b.callback&&b.startTime<=a&&b.expirationTime<l.expirationTime||W()},unstable_requestPaint:f,unstable_continueExecution:function(){v||H||(v=!0,z(U))},unstable_pauseExecution:function(){},unstable_getFirstCallbackNode:function(){return n(p)},get unstable_now(){return q},get unstable_forceFrameRate(){return X},unstable_Profiling:null},SchedulerTracing:{__proto__:null,__interactionsRef:null,__subscriberRef:null,
unstable_clear:function(a){return a()},unstable_getCurrent:function(){return null},unstable_getThreadID:function(){return++Qa},unstable_trace:function(a,b,c){return c()},unstable_wrap:function(a){return a},unstable_subscribe:function(a){},unstable_unsubscribe:function(a){}}});d.Children={map:function(a,b,c){if(null==a)return a;var d=[];R(a,d,null,b,c);return d},forEach:function(a,b,c){if(null==a)return a;b=ja(null,null,b,c);Q(a,ya,b);ka(b)},count:function(a){return Q(a,function(){return null},null)},
toArray:function(a){var b=[];R(a,b,null,function(a){return a});return b},only:function(a){if(!N(a))throw Error(r(143));return a}};d.Component=w;d.Fragment=Aa;d.Profiler=Ca;d.PureComponent=L;d.StrictMode=Ba;d.Suspense=Ga;d.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B;d.cloneElement=function(a,b,c){if(null===a||void 0===a)throw Error(r(267,a));var d=I({},a.props),e=a.key,f=a.ref,m=a._owner;if(null!=b){void 0!==b.ref&&(f=b.ref,m=M.current);void 0!==b.key&&(e=""+b.key);if(a.type&&a.type.defaultProps)var h=
a.type.defaultProps;for(k in b)ha.call(b,k)&&!ia.hasOwnProperty(k)&&(d[k]=void 0===b[k]&&void 0!==h?h[k]:b[k])}var k=arguments.length-2;if(1===k)d.children=c;else if(1<k){h=Array(k);for(var l=0;l<k;l++)h[l]=arguments[l+2];d.children=h}return{$$typeof:x,type:a.type,key:e,ref:f,props:d,_owner:m}};d.createContext=function(a,b){void 0===b&&(b=null);a={$$typeof:Ea,_calculateChangedBits:b,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null};a.Provider={$$typeof:Da,_context:a};return a.Consumer=
a};d.createElement=ea;d.createFactory=function(a){var b=ea.bind(null,a);b.type=a;return b};d.createRef=function(){return{current:null}};d.forwardRef=function(a){return{$$typeof:Fa,render:a}};d.isValidElement=N;d.lazy=function(a){return{$$typeof:Ia,_ctor:a,_status:-1,_result:null}};d.memo=function(a,b){return{$$typeof:Ha,type:a,compare:void 0===b?null:b}};d.useCallback=function(a,b){return t().useCallback(a,b)};d.useContext=function(a,b){return t().useContext(a,b)};d.useDebugValue=function(a,b){};
d.useEffect=function(a,b){return t().useEffect(a,b)};d.useImperativeHandle=function(a,b,c){return t().useImperativeHandle(a,b,c)};d.useLayoutEffect=function(a,b){return t().useLayoutEffect(a,b)};d.useMemo=function(a,b){return t().useMemo(a,b)};d.useReducer=function(a,b,c){return t().useReducer(a,b,c)};d.useRef=function(a){return t().useRef(a)};d.useState=function(a){return t().useState(a)};d.version="16.13.1"});
</script>
    <script crossorigin>/** @license React v16.13.1
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
/*
 Modernizr 3.0.0pre (Custom Build) | MIT
*/
'use strict';(function(I,ea){"object"===typeof exports&&"undefined"!==typeof module?ea(exports,require("react")):"function"===typeof define&&define.amd?define(["exports","react"],ea):(I=I||self,ea(I.ReactDOM={},I.React))})(this,function(I,ea){function k(a){for(var b="https://reactjs.org/docs/error-decoder.html?invariant="+a,c=1;c<arguments.length;c++)b+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+a+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}
function ji(a,b,c,d,e,f,g,h,m){yb=!1;gc=null;ki.apply(li,arguments)}function mi(a,b,c,d,e,f,g,h,m){ji.apply(this,arguments);if(yb){if(yb){var n=gc;yb=!1;gc=null}else throw Error(k(198));hc||(hc=!0,pd=n)}}function lf(a,b,c){var d=a.type||"unknown-event";a.currentTarget=mf(c);mi(d,b,void 0,a);a.currentTarget=null}function nf(){if(ic)for(var a in cb){var b=cb[a],c=ic.indexOf(a);if(!(-1<c))throw Error(k(96,a));if(!jc[c]){if(!b.extractEvents)throw Error(k(97,a));jc[c]=b;c=b.eventTypes;for(var d in c){var e=
void 0;var f=c[d],g=b,h=d;if(qd.hasOwnProperty(h))throw Error(k(99,h));qd[h]=f;var m=f.phasedRegistrationNames;if(m){for(e in m)m.hasOwnProperty(e)&&of(m[e],g,h);e=!0}else f.registrationName?(of(f.registrationName,g,h),e=!0):e=!1;if(!e)throw Error(k(98,d,a));}}}}function of(a,b,c){if(db[a])throw Error(k(100,a));db[a]=b;rd[a]=b.eventTypes[c].dependencies}function pf(a){var b=!1,c;for(c in a)if(a.hasOwnProperty(c)){var d=a[c];if(!cb.hasOwnProperty(c)||cb[c]!==d){if(cb[c])throw Error(k(102,c));cb[c]=
d;b=!0}}b&&nf()}function qf(a){if(a=rf(a)){if("function"!==typeof sd)throw Error(k(280));var b=a.stateNode;b&&(b=td(b),sd(a.stateNode,a.type,b))}}function sf(a){eb?fb?fb.push(a):fb=[a]:eb=a}function tf(){if(eb){var a=eb,b=fb;fb=eb=null;qf(a);if(b)for(a=0;a<b.length;a++)qf(b[a])}}function ud(){if(null!==eb||null!==fb)vd(),tf()}function uf(a,b,c){if(wd)return a(b,c);wd=!0;try{return vf(a,b,c)}finally{wd=!1,ud()}}function ni(a){if(wf.call(xf,a))return!0;if(wf.call(yf,a))return!1;if(oi.test(a))return xf[a]=
!0;yf[a]=!0;return!1}function pi(a,b,c,d){if(null!==c&&0===c.type)return!1;switch(typeof b){case "function":case "symbol":return!0;case "boolean":if(d)return!1;if(null!==c)return!c.acceptsBooleans;a=a.toLowerCase().slice(0,5);return"data-"!==a&&"aria-"!==a;default:return!1}}function qi(a,b,c,d){if(null===b||"undefined"===typeof b||pi(a,b,c,d))return!0;if(d)return!1;if(null!==c)switch(c.type){case 3:return!b;case 4:return!1===b;case 5:return isNaN(b);case 6:return isNaN(b)||1>b}return!1}function L(a,
b,c,d,e,f){this.acceptsBooleans=2===b||3===b||4===b;this.attributeName=d;this.attributeNamespace=e;this.mustUseProperty=c;this.propertyName=a;this.type=b;this.sanitizeURL=f}function xd(a,b,c,d){var e=E.hasOwnProperty(b)?E[b]:null;var f=null!==e?0===e.type:d?!1:!(2<b.length)||"o"!==b[0]&&"O"!==b[0]||"n"!==b[1]&&"N"!==b[1]?!1:!0;f||(qi(b,c,e,d)&&(c=null),d||null===e?ni(b)&&(null===c?a.removeAttribute(b):a.setAttribute(b,""+c)):e.mustUseProperty?a[e.propertyName]=null===c?3===e.type?!1:"":c:(b=e.attributeName,
d=e.attributeNamespace,null===c?a.removeAttribute(b):(e=e.type,c=3===e||4===e&&!0===c?"":""+c,d?a.setAttributeNS(d,b,c):a.setAttribute(b,c))))}function zb(a){if(null===a||"object"!==typeof a)return null;a=zf&&a[zf]||a["@@iterator"];return"function"===typeof a?a:null}function ri(a){if(-1===a._status){a._status=0;var b=a._ctor;b=b();a._result=b;b.then(function(b){0===a._status&&(b=b.default,a._status=1,a._result=b)},function(b){0===a._status&&(a._status=2,a._result=b)})}}function na(a){if(null==a)return null;
if("function"===typeof a)return a.displayName||a.name||null;if("string"===typeof a)return a;switch(a){case Ma:return"Fragment";case gb:return"Portal";case kc:return"Profiler";case Af:return"StrictMode";case lc:return"Suspense";case yd:return"SuspenseList"}if("object"===typeof a)switch(a.$$typeof){case Bf:return"Context.Consumer";case Cf:return"Context.Provider";case zd:var b=a.render;b=b.displayName||b.name||"";return a.displayName||(""!==b?"ForwardRef("+b+")":"ForwardRef");case Ad:return na(a.type);
case Df:return na(a.render);case Ef:if(a=1===a._status?a._result:null)return na(a)}return null}function Bd(a){var b="";do{a:switch(a.tag){case 3:case 4:case 6:case 7:case 10:case 9:var c="";break a;default:var d=a._debugOwner,e=a._debugSource,f=na(a.type);c=null;d&&(c=na(d.type));d=f;f="";e?f=" (at "+e.fileName.replace(si,"")+":"+e.lineNumber+")":c&&(f=" (created by "+c+")");c="\n    in "+(d||"Unknown")+f}b+=c;a=a.return}while(a);return b}function va(a){switch(typeof a){case "boolean":case "number":case "object":case "string":case "undefined":return a;
default:return""}}function Ff(a){var b=a.type;return(a=a.nodeName)&&"input"===a.toLowerCase()&&("checkbox"===b||"radio"===b)}function ti(a){var b=Ff(a)?"checked":"value",c=Object.getOwnPropertyDescriptor(a.constructor.prototype,b),d=""+a[b];if(!a.hasOwnProperty(b)&&"undefined"!==typeof c&&"function"===typeof c.get&&"function"===typeof c.set){var e=c.get,f=c.set;Object.defineProperty(a,b,{configurable:!0,get:function(){return e.call(this)},set:function(a){d=""+a;f.call(this,a)}});Object.defineProperty(a,
b,{enumerable:c.enumerable});return{getValue:function(){return d},setValue:function(a){d=""+a},stopTracking:function(){a._valueTracker=null;delete a[b]}}}}function mc(a){a._valueTracker||(a._valueTracker=ti(a))}function Gf(a){if(!a)return!1;var b=a._valueTracker;if(!b)return!0;var c=b.getValue();var d="";a&&(d=Ff(a)?a.checked?"true":"false":a.value);a=d;return a!==c?(b.setValue(a),!0):!1}function Cd(a,b){var c=b.checked;return M({},b,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=
c?c:a._wrapperState.initialChecked})}function Hf(a,b){var c=null==b.defaultValue?"":b.defaultValue,d=null!=b.checked?b.checked:b.defaultChecked;c=va(null!=b.value?b.value:c);a._wrapperState={initialChecked:d,initialValue:c,controlled:"checkbox"===b.type||"radio"===b.type?null!=b.checked:null!=b.value}}function If(a,b){b=b.checked;null!=b&&xd(a,"checked",b,!1)}function Dd(a,b){If(a,b);var c=va(b.value),d=b.type;if(null!=c)if("number"===d){if(0===c&&""===a.value||a.value!=c)a.value=""+c}else a.value!==
""+c&&(a.value=""+c);else if("submit"===d||"reset"===d){a.removeAttribute("value");return}b.hasOwnProperty("value")?Ed(a,b.type,c):b.hasOwnProperty("defaultValue")&&Ed(a,b.type,va(b.defaultValue));null==b.checked&&null!=b.defaultChecked&&(a.defaultChecked=!!b.defaultChecked)}function Jf(a,b,c){if(b.hasOwnProperty("value")||b.hasOwnProperty("defaultValue")){var d=b.type;if(!("submit"!==d&&"reset"!==d||void 0!==b.value&&null!==b.value))return;b=""+a._wrapperState.initialValue;c||b===a.value||(a.value=
b);a.defaultValue=b}c=a.name;""!==c&&(a.name="");a.defaultChecked=!!a._wrapperState.initialChecked;""!==c&&(a.name=c)}function Ed(a,b,c){if("number"!==b||a.ownerDocument.activeElement!==a)null==c?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+c&&(a.defaultValue=""+c)}function ui(a){var b="";ea.Children.forEach(a,function(a){null!=a&&(b+=a)});return b}function Fd(a,b){a=M({children:void 0},b);if(b=ui(b.children))a.children=b;return a}function hb(a,b,c,d){a=a.options;if(b){b={};
for(var e=0;e<c.length;e++)b["$"+c[e]]=!0;for(c=0;c<a.length;c++)e=b.hasOwnProperty("$"+a[c].value),a[c].selected!==e&&(a[c].selected=e),e&&d&&(a[c].defaultSelected=!0)}else{c=""+va(c);b=null;for(e=0;e<a.length;e++){if(a[e].value===c){a[e].selected=!0;d&&(a[e].defaultSelected=!0);return}null!==b||a[e].disabled||(b=a[e])}null!==b&&(b.selected=!0)}}function Gd(a,b){if(null!=b.dangerouslySetInnerHTML)throw Error(k(91));return M({},b,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}
function Kf(a,b){var c=b.value;if(null==c){c=b.children;b=b.defaultValue;if(null!=c){if(null!=b)throw Error(k(92));if(Array.isArray(c)){if(!(1>=c.length))throw Error(k(93));c=c[0]}b=c}null==b&&(b="");c=b}a._wrapperState={initialValue:va(c)}}function Lf(a,b){var c=va(b.value),d=va(b.defaultValue);null!=c&&(c=""+c,c!==a.value&&(a.value=c),null==b.defaultValue&&a.defaultValue!==c&&(a.defaultValue=c));null!=d&&(a.defaultValue=""+d)}function Mf(a,b){b=a.textContent;b===a._wrapperState.initialValue&&""!==
b&&null!==b&&(a.value=b)}function Nf(a){switch(a){case "svg":return"http://www.w3.org/2000/svg";case "math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Hd(a,b){return null==a||"http://www.w3.org/1999/xhtml"===a?Nf(b):"http://www.w3.org/2000/svg"===a&&"foreignObject"===b?"http://www.w3.org/1999/xhtml":a}function nc(a,b){var c={};c[a.toLowerCase()]=b.toLowerCase();c["Webkit"+a]="webkit"+b;c["Moz"+a]="moz"+b;return c}function oc(a){if(Id[a])return Id[a];
if(!ib[a])return a;var b=ib[a],c;for(c in b)if(b.hasOwnProperty(c)&&c in Of)return Id[a]=b[c];return a}function Jd(a){var b=Pf.get(a);void 0===b&&(b=new Map,Pf.set(a,b));return b}function Na(a){var b=a,c=a;if(a.alternate)for(;b.return;)b=b.return;else{a=b;do b=a,0!==(b.effectTag&1026)&&(c=b.return),a=b.return;while(a)}return 3===b.tag?c:null}function Qf(a){if(13===a.tag){var b=a.memoizedState;null===b&&(a=a.alternate,null!==a&&(b=a.memoizedState));if(null!==b)return b.dehydrated}return null}function Rf(a){if(Na(a)!==
a)throw Error(k(188));}function vi(a){var b=a.alternate;if(!b){b=Na(a);if(null===b)throw Error(k(188));return b!==a?null:a}for(var c=a,d=b;;){var e=c.return;if(null===e)break;var f=e.alternate;if(null===f){d=e.return;if(null!==d){c=d;continue}break}if(e.child===f.child){for(f=e.child;f;){if(f===c)return Rf(e),a;if(f===d)return Rf(e),b;f=f.sibling}throw Error(k(188));}if(c.return!==d.return)c=e,d=f;else{for(var g=!1,h=e.child;h;){if(h===c){g=!0;c=e;d=f;break}if(h===d){g=!0;d=e;c=f;break}h=h.sibling}if(!g){for(h=
f.child;h;){if(h===c){g=!0;c=f;d=e;break}if(h===d){g=!0;d=f;c=e;break}h=h.sibling}if(!g)throw Error(k(189));}}if(c.alternate!==d)throw Error(k(190));}if(3!==c.tag)throw Error(k(188));return c.stateNode.current===c?a:b}function Sf(a){a=vi(a);if(!a)return null;for(var b=a;;){if(5===b.tag||6===b.tag)return b;if(b.child)b.child.return=b,b=b.child;else{if(b===a)break;for(;!b.sibling;){if(!b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}}return null}function jb(a,b){if(null==
b)throw Error(k(30));if(null==a)return b;if(Array.isArray(a)){if(Array.isArray(b))return a.push.apply(a,b),a;a.push(b);return a}return Array.isArray(b)?[a].concat(b):[a,b]}function Kd(a,b,c){Array.isArray(a)?a.forEach(b,c):a&&b.call(c,a)}function pc(a){null!==a&&(Ab=jb(Ab,a));a=Ab;Ab=null;if(a){Kd(a,wi);if(Ab)throw Error(k(95));if(hc)throw a=pd,hc=!1,pd=null,a;}}function Ld(a){a=a.target||a.srcElement||window;a.correspondingUseElement&&(a=a.correspondingUseElement);return 3===a.nodeType?a.parentNode:
a}function Tf(a){if(!wa)return!1;a="on"+a;var b=a in document;b||(b=document.createElement("div"),b.setAttribute(a,"return;"),b="function"===typeof b[a]);return b}function Uf(a){a.topLevelType=null;a.nativeEvent=null;a.targetInst=null;a.ancestors.length=0;10>qc.length&&qc.push(a)}function Vf(a,b,c,d){if(qc.length){var e=qc.pop();e.topLevelType=a;e.eventSystemFlags=d;e.nativeEvent=b;e.targetInst=c;return e}return{topLevelType:a,eventSystemFlags:d,nativeEvent:b,targetInst:c,ancestors:[]}}function Wf(a){var b=
a.targetInst,c=b;do{if(!c){a.ancestors.push(c);break}var d=c;if(3===d.tag)d=d.stateNode.containerInfo;else{for(;d.return;)d=d.return;d=3!==d.tag?null:d.stateNode.containerInfo}if(!d)break;b=c.tag;5!==b&&6!==b||a.ancestors.push(c);c=Bb(d)}while(c);for(c=0;c<a.ancestors.length;c++){b=a.ancestors[c];var e=Ld(a.nativeEvent);d=a.topLevelType;var f=a.nativeEvent,g=a.eventSystemFlags;0===c&&(g|=64);for(var h=null,m=0;m<jc.length;m++){var n=jc[m];n&&(n=n.extractEvents(d,b,f,e,g))&&(h=jb(h,n))}pc(h)}}function Md(a,
b,c){if(!c.has(a)){switch(a){case "scroll":Cb(b,"scroll",!0);break;case "focus":case "blur":Cb(b,"focus",!0);Cb(b,"blur",!0);c.set("blur",null);c.set("focus",null);break;case "cancel":case "close":Tf(a)&&Cb(b,a,!0);break;case "invalid":case "submit":case "reset":break;default:-1===Db.indexOf(a)&&w(a,b)}c.set(a,null)}}function xi(a,b){var c=Jd(b);Nd.forEach(function(a){Md(a,b,c)});yi.forEach(function(a){Md(a,b,c)})}function Od(a,b,c,d,e){return{blockedOn:a,topLevelType:b,eventSystemFlags:c|32,nativeEvent:e,
container:d}}function Xf(a,b){switch(a){case "focus":case "blur":xa=null;break;case "dragenter":case "dragleave":ya=null;break;case "mouseover":case "mouseout":za=null;break;case "pointerover":case "pointerout":Eb.delete(b.pointerId);break;case "gotpointercapture":case "lostpointercapture":Fb.delete(b.pointerId)}}function Gb(a,b,c,d,e,f){if(null===a||a.nativeEvent!==f)return a=Od(b,c,d,e,f),null!==b&&(b=Hb(b),null!==b&&Yf(b)),a;a.eventSystemFlags|=d;return a}function zi(a,b,c,d,e){switch(b){case "focus":return xa=
Gb(xa,a,b,c,d,e),!0;case "dragenter":return ya=Gb(ya,a,b,c,d,e),!0;case "mouseover":return za=Gb(za,a,b,c,d,e),!0;case "pointerover":var f=e.pointerId;Eb.set(f,Gb(Eb.get(f)||null,a,b,c,d,e));return!0;case "gotpointercapture":return f=e.pointerId,Fb.set(f,Gb(Fb.get(f)||null,a,b,c,d,e)),!0}return!1}function Ai(a){var b=Bb(a.target);if(null!==b){var c=Na(b);if(null!==c)if(b=c.tag,13===b){if(b=Qf(c),null!==b){a.blockedOn=b;Pd(a.priority,function(){Bi(c)});return}}else if(3===b&&c.stateNode.hydrate){a.blockedOn=
3===c.tag?c.stateNode.containerInfo:null;return}}a.blockedOn=null}function rc(a){if(null!==a.blockedOn)return!1;var b=Qd(a.topLevelType,a.eventSystemFlags,a.container,a.nativeEvent);if(null!==b){var c=Hb(b);null!==c&&Yf(c);a.blockedOn=b;return!1}return!0}function Zf(a,b,c){rc(a)&&c.delete(b)}function Ci(){for(Rd=!1;0<fa.length;){var a=fa[0];if(null!==a.blockedOn){a=Hb(a.blockedOn);null!==a&&Di(a);break}var b=Qd(a.topLevelType,a.eventSystemFlags,a.container,a.nativeEvent);null!==b?a.blockedOn=b:fa.shift()}null!==
xa&&rc(xa)&&(xa=null);null!==ya&&rc(ya)&&(ya=null);null!==za&&rc(za)&&(za=null);Eb.forEach(Zf);Fb.forEach(Zf)}function Ib(a,b){a.blockedOn===b&&(a.blockedOn=null,Rd||(Rd=!0,$f(ag,Ci)))}function bg(a){if(0<fa.length){Ib(fa[0],a);for(var b=1;b<fa.length;b++){var c=fa[b];c.blockedOn===a&&(c.blockedOn=null)}}null!==xa&&Ib(xa,a);null!==ya&&Ib(ya,a);null!==za&&Ib(za,a);b=function(b){return Ib(b,a)};Eb.forEach(b);Fb.forEach(b);for(b=0;b<Jb.length;b++)c=Jb[b],c.blockedOn===a&&(c.blockedOn=null);for(;0<Jb.length&&
(b=Jb[0],null===b.blockedOn);)Ai(b),null===b.blockedOn&&Jb.shift()}function Sd(a,b){for(var c=0;c<a.length;c+=2){var d=a[c],e=a[c+1],f="on"+(e[0].toUpperCase()+e.slice(1));f={phasedRegistrationNames:{bubbled:f,captured:f+"Capture"},dependencies:[d],eventPriority:b};Td.set(d,b);cg.set(d,f);dg[e]=f}}function w(a,b){Cb(b,a,!1)}function Cb(a,b,c){var d=Td.get(b);switch(void 0===d?2:d){case 0:d=Ei.bind(null,b,1,a);break;case 1:d=Fi.bind(null,b,1,a);break;default:d=sc.bind(null,b,1,a)}c?a.addEventListener(b,
d,!0):a.addEventListener(b,d,!1)}function Ei(a,b,c,d){Oa||vd();var e=sc,f=Oa;Oa=!0;try{eg(e,a,b,c,d)}finally{(Oa=f)||ud()}}function Fi(a,b,c,d){Gi(Hi,sc.bind(null,a,b,c,d))}function sc(a,b,c,d){if(tc)if(0<fa.length&&-1<Nd.indexOf(a))a=Od(null,a,b,c,d),fa.push(a);else{var e=Qd(a,b,c,d);if(null===e)Xf(a,d);else if(-1<Nd.indexOf(a))a=Od(e,a,b,c,d),fa.push(a);else if(!zi(e,a,b,c,d)){Xf(a,d);a=Vf(a,d,null,b);try{uf(Wf,a)}finally{Uf(a)}}}}function Qd(a,b,c,d){c=Ld(d);c=Bb(c);if(null!==c){var e=Na(c);if(null===
e)c=null;else{var f=e.tag;if(13===f){c=Qf(e);if(null!==c)return c;c=null}else if(3===f){if(e.stateNode.hydrate)return 3===e.tag?e.stateNode.containerInfo:null;c=null}else e!==c&&(c=null)}}a=Vf(a,d,c,b);try{uf(Wf,a)}finally{Uf(a)}return null}function fg(a,b,c){return null==b||"boolean"===typeof b||""===b?"":c||"number"!==typeof b||0===b||Kb.hasOwnProperty(a)&&Kb[a]?(""+b).trim():b+"px"}function gg(a,b){a=a.style;for(var c in b)if(b.hasOwnProperty(c)){var d=0===c.indexOf("--"),e=fg(c,b[c],d);"float"===
c&&(c="cssFloat");d?a.setProperty(c,e):a[c]=e}}function Ud(a,b){if(b){if(Ii[a]&&(null!=b.children||null!=b.dangerouslySetInnerHTML))throw Error(k(137,a,""));if(null!=b.dangerouslySetInnerHTML){if(null!=b.children)throw Error(k(60));if(!("object"===typeof b.dangerouslySetInnerHTML&&"__html"in b.dangerouslySetInnerHTML))throw Error(k(61));}if(null!=b.style&&"object"!==typeof b.style)throw Error(k(62,""));}}function Vd(a,b){if(-1===a.indexOf("-"))return"string"===typeof b.is;switch(a){case "annotation-xml":case "color-profile":case "font-face":case "font-face-src":case "font-face-uri":case "font-face-format":case "font-face-name":case "missing-glyph":return!1;
default:return!0}}function oa(a,b){a=9===a.nodeType||11===a.nodeType?a:a.ownerDocument;var c=Jd(a);b=rd[b];for(var d=0;d<b.length;d++)Md(b[d],a,c)}function uc(){}function Wd(a){a=a||("undefined"!==typeof document?document:void 0);if("undefined"===typeof a)return null;try{return a.activeElement||a.body}catch(b){return a.body}}function hg(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function ig(a,b){var c=hg(a);a=0;for(var d;c;){if(3===c.nodeType){d=a+c.textContent.length;if(a<=b&&d>=b)return{node:c,
offset:b-a};a=d}a:{for(;c;){if(c.nextSibling){c=c.nextSibling;break a}c=c.parentNode}c=void 0}c=hg(c)}}function jg(a,b){return a&&b?a===b?!0:a&&3===a.nodeType?!1:b&&3===b.nodeType?jg(a,b.parentNode):"contains"in a?a.contains(b):a.compareDocumentPosition?!!(a.compareDocumentPosition(b)&16):!1:!1}function kg(){for(var a=window,b=Wd();b instanceof a.HTMLIFrameElement;){try{var c="string"===typeof b.contentWindow.location.href}catch(d){c=!1}if(c)a=b.contentWindow;else break;b=Wd(a.document)}return b}
function Xd(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return b&&("input"===b&&("text"===a.type||"search"===a.type||"tel"===a.type||"url"===a.type||"password"===a.type)||"textarea"===b||"true"===a.contentEditable)}function lg(a,b){switch(a){case "button":case "input":case "select":case "textarea":return!!b.autoFocus}return!1}function Yd(a,b){return"textarea"===a||"option"===a||"noscript"===a||"string"===typeof b.children||"number"===typeof b.children||"object"===typeof b.dangerouslySetInnerHTML&&
null!==b.dangerouslySetInnerHTML&&null!=b.dangerouslySetInnerHTML.__html}function kb(a){for(;null!=a;a=a.nextSibling){var b=a.nodeType;if(1===b||3===b)break}return a}function mg(a){a=a.previousSibling;for(var b=0;a;){if(8===a.nodeType){var c=a.data;if(c===ng||c===Zd||c===$d){if(0===b)return a;b--}else c===og&&b++}a=a.previousSibling}return null}function Bb(a){var b=a[Aa];if(b)return b;for(var c=a.parentNode;c;){if(b=c[Lb]||c[Aa]){c=b.alternate;if(null!==b.child||null!==c&&null!==c.child)for(a=mg(a);null!==
a;){if(c=a[Aa])return c;a=mg(a)}return b}a=c;c=a.parentNode}return null}function Hb(a){a=a[Aa]||a[Lb];return!a||5!==a.tag&&6!==a.tag&&13!==a.tag&&3!==a.tag?null:a}function Pa(a){if(5===a.tag||6===a.tag)return a.stateNode;throw Error(k(33));}function ae(a){return a[vc]||null}function pa(a){do a=a.return;while(a&&5!==a.tag);return a?a:null}function pg(a,b){var c=a.stateNode;if(!c)return null;var d=td(c);if(!d)return null;c=d[b];a:switch(b){case "onClick":case "onClickCapture":case "onDoubleClick":case "onDoubleClickCapture":case "onMouseDown":case "onMouseDownCapture":case "onMouseMove":case "onMouseMoveCapture":case "onMouseUp":case "onMouseUpCapture":case "onMouseEnter":(d=
!d.disabled)||(a=a.type,d=!("button"===a||"input"===a||"select"===a||"textarea"===a));a=!d;break a;default:a=!1}if(a)return null;if(c&&"function"!==typeof c)throw Error(k(231,b,typeof c));return c}function qg(a,b,c){if(b=pg(a,c.dispatchConfig.phasedRegistrationNames[b]))c._dispatchListeners=jb(c._dispatchListeners,b),c._dispatchInstances=jb(c._dispatchInstances,a)}function Ji(a){if(a&&a.dispatchConfig.phasedRegistrationNames){for(var b=a._targetInst,c=[];b;)c.push(b),b=pa(b);for(b=c.length;0<b--;)qg(c[b],
"captured",a);for(b=0;b<c.length;b++)qg(c[b],"bubbled",a)}}function be(a,b,c){a&&c&&c.dispatchConfig.registrationName&&(b=pg(a,c.dispatchConfig.registrationName))&&(c._dispatchListeners=jb(c._dispatchListeners,b),c._dispatchInstances=jb(c._dispatchInstances,a))}function Ki(a){a&&a.dispatchConfig.registrationName&&be(a._targetInst,null,a)}function lb(a){Kd(a,Ji)}function rg(){if(wc)return wc;var a,b=ce,c=b.length,d,e="value"in Ba?Ba.value:Ba.textContent,f=e.length;for(a=0;a<c&&b[a]===e[a];a++);var g=
c-a;for(d=1;d<=g&&b[c-d]===e[f-d];d++);return wc=e.slice(a,1<d?1-d:void 0)}function xc(){return!0}function yc(){return!1}function R(a,b,c,d){this.dispatchConfig=a;this._targetInst=b;this.nativeEvent=c;a=this.constructor.Interface;for(var e in a)a.hasOwnProperty(e)&&((b=a[e])?this[e]=b(c):"target"===e?this.target=d:this[e]=c[e]);this.isDefaultPrevented=(null!=c.defaultPrevented?c.defaultPrevented:!1===c.returnValue)?xc:yc;this.isPropagationStopped=yc;return this}function Li(a,b,c,d){if(this.eventPool.length){var e=
this.eventPool.pop();this.call(e,a,b,c,d);return e}return new this(a,b,c,d)}function Mi(a){if(!(a instanceof this))throw Error(k(279));a.destructor();10>this.eventPool.length&&this.eventPool.push(a)}function sg(a){a.eventPool=[];a.getPooled=Li;a.release=Mi}function tg(a,b){switch(a){case "keyup":return-1!==Ni.indexOf(b.keyCode);case "keydown":return 229!==b.keyCode;case "keypress":case "mousedown":case "blur":return!0;default:return!1}}function ug(a){a=a.detail;return"object"===typeof a&&"data"in
a?a.data:null}function Oi(a,b){switch(a){case "compositionend":return ug(b);case "keypress":if(32!==b.which)return null;vg=!0;return wg;case "textInput":return a=b.data,a===wg&&vg?null:a;default:return null}}function Pi(a,b){if(mb)return"compositionend"===a||!de&&tg(a,b)?(a=rg(),wc=ce=Ba=null,mb=!1,a):null;switch(a){case "paste":return null;case "keypress":if(!(b.ctrlKey||b.altKey||b.metaKey)||b.ctrlKey&&b.altKey){if(b.char&&1<b.char.length)return b.char;if(b.which)return String.fromCharCode(b.which)}return null;
case "compositionend":return xg&&"ko"!==b.locale?null:b.data;default:return null}}function yg(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return"input"===b?!!Qi[a.type]:"textarea"===b?!0:!1}function zg(a,b,c){a=R.getPooled(Ag.change,a,b,c);a.type="change";sf(c);lb(a);return a}function Ri(a){pc(a)}function zc(a){var b=Pa(a);if(Gf(b))return a}function Si(a,b){if("change"===a)return b}function Bg(){Mb&&(Mb.detachEvent("onpropertychange",Cg),Nb=Mb=null)}function Cg(a){if("value"===a.propertyName&&
zc(Nb))if(a=zg(Nb,a,Ld(a)),Oa)pc(a);else{Oa=!0;try{ee(Ri,a)}finally{Oa=!1,ud()}}}function Ti(a,b,c){"focus"===a?(Bg(),Mb=b,Nb=c,Mb.attachEvent("onpropertychange",Cg)):"blur"===a&&Bg()}function Ui(a,b){if("selectionchange"===a||"keyup"===a||"keydown"===a)return zc(Nb)}function Vi(a,b){if("click"===a)return zc(b)}function Wi(a,b){if("input"===a||"change"===a)return zc(b)}function Xi(a){var b=this.nativeEvent;return b.getModifierState?b.getModifierState(a):(a=Yi[a])?!!b[a]:!1}function fe(a){return Xi}
function Zi(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}function Ob(a,b){if(Qa(a,b))return!0;if("object"!==typeof a||null===a||"object"!==typeof b||null===b)return!1;var c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++)if(!$i.call(b,c[d])||!Qa(a[c[d]],b[c[d]]))return!1;return!0}function Dg(a,b){var c=b.window===b?b.document:9===b.nodeType?b:b.ownerDocument;if(ge||null==nb||nb!==Wd(c))return null;c=nb;"selectionStart"in c&&Xd(c)?c={start:c.selectionStart,
end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset});return Pb&&Ob(Pb,c)?null:(Pb=c,a=R.getPooled(Eg.select,he,a,b),a.type="select",a.target=nb,lb(a),a)}function Ac(a){var b=a.keyCode;"charCode"in a?(a=a.charCode,0===a&&13===b&&(a=13)):a=b;10===a&&(a=13);return 32<=a||13===a?a:0}function q(a,b){0>ob||(a.current=ie[ob],ie[ob]=null,ob--)}function y(a,b,c){ob++;
ie[ob]=a.current;a.current=b}function pb(a,b){var c=a.type.contextTypes;if(!c)return Ca;var d=a.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===b)return d.__reactInternalMemoizedMaskedChildContext;var e={},f;for(f in c)e[f]=b[f];d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=b,a.__reactInternalMemoizedMaskedChildContext=e);return e}function N(a){a=a.childContextTypes;return null!==a&&void 0!==a}function Fg(a,b,c){if(B.current!==Ca)throw Error(k(168));y(B,b);y(G,c)}
function Gg(a,b,c){var d=a.stateNode;a=b.childContextTypes;if("function"!==typeof d.getChildContext)return c;d=d.getChildContext();for(var e in d)if(!(e in a))throw Error(k(108,na(b)||"Unknown",e));return M({},c,{},d)}function Bc(a){a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Ca;Ra=B.current;y(B,a);y(G,G.current);return!0}function Hg(a,b,c){var d=a.stateNode;if(!d)throw Error(k(169));c?(a=Gg(a,b,Ra),d.__reactInternalMemoizedMergedChildContext=a,q(G),q(B),y(B,a)):q(G);y(G,c)}function Cc(){switch(aj()){case Dc:return 99;
case Ig:return 98;case Jg:return 97;case Kg:return 96;case Lg:return 95;default:throw Error(k(332));}}function Mg(a){switch(a){case 99:return Dc;case 98:return Ig;case 97:return Jg;case 96:return Kg;case 95:return Lg;default:throw Error(k(332));}}function Da(a,b){a=Mg(a);return bj(a,b)}function Ng(a,b,c){a=Mg(a);return je(a,b,c)}function Og(a){null===qa?(qa=[a],Ec=je(Dc,Pg)):qa.push(a);return Qg}function ha(){if(null!==Ec){var a=Ec;Ec=null;Rg(a)}Pg()}function Pg(){if(!ke&&null!==qa){ke=!0;var a=0;
try{var b=qa;Da(99,function(){for(;a<b.length;a++){var c=b[a];do c=c(!0);while(null!==c)}});qa=null}catch(c){throw null!==qa&&(qa=qa.slice(a+1)),je(Dc,ha),c;}finally{ke=!1}}}function Fc(a,b,c){c/=10;return 1073741821-(((1073741821-a+b/10)/c|0)+1)*c}function aa(a,b){if(a&&a.defaultProps){b=M({},b);a=a.defaultProps;for(var c in a)void 0===b[c]&&(b[c]=a[c])}return b}function le(){Gc=qb=Hc=null}function me(a){var b=Ic.current;q(Ic);a.type._context._currentValue=b}function Sg(a,b){for(;null!==a;){var c=
a.alternate;if(a.childExpirationTime<b)a.childExpirationTime=b,null!==c&&c.childExpirationTime<b&&(c.childExpirationTime=b);else if(null!==c&&c.childExpirationTime<b)c.childExpirationTime=b;else break;a=a.return}}function rb(a,b){Hc=a;Gc=qb=null;a=a.dependencies;null!==a&&null!==a.firstContext&&(a.expirationTime>=b&&(ia=!0),a.firstContext=null)}function W(a,b){if(Gc!==a&&!1!==b&&0!==b){if("number"!==typeof b||1073741823===b)Gc=a,b=1073741823;b={context:a,observedBits:b,next:null};if(null===qb){if(null===
Hc)throw Error(k(308));qb=b;Hc.dependencies={expirationTime:0,firstContext:b,responders:null}}else qb=qb.next=b}return a._currentValue}function ne(a){a.updateQueue={baseState:a.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function oe(a,b){a=a.updateQueue;b.updateQueue===a&&(b.updateQueue={baseState:a.baseState,baseQueue:a.baseQueue,shared:a.shared,effects:a.effects})}function Ea(a,b){a={expirationTime:a,suspenseConfig:b,tag:Tg,payload:null,callback:null,next:null};return a.next=
a}function Fa(a,b){a=a.updateQueue;if(null!==a){a=a.shared;var c=a.pending;null===c?b.next=b:(b.next=c.next,c.next=b);a.pending=b}}function Ug(a,b){var c=a.alternate;null!==c&&oe(c,a);a=a.updateQueue;c=a.baseQueue;null===c?(a.baseQueue=b.next=b,b.next=b):(b.next=c.next,c.next=b)}function Qb(a,b,c,d){var e=a.updateQueue;Ga=!1;var f=e.baseQueue,g=e.shared.pending;if(null!==g){if(null!==f){var h=f.next;f.next=g.next;g.next=h}f=g;e.shared.pending=null;h=a.alternate;null!==h&&(h=h.updateQueue,null!==h&&
(h.baseQueue=g))}if(null!==f){h=f.next;var m=e.baseState,n=0,k=null,ba=null,l=null;if(null!==h){var p=h;do{g=p.expirationTime;if(g<d){var t={expirationTime:p.expirationTime,suspenseConfig:p.suspenseConfig,tag:p.tag,payload:p.payload,callback:p.callback,next:null};null===l?(ba=l=t,k=m):l=l.next=t;g>n&&(n=g)}else{null!==l&&(l=l.next={expirationTime:1073741823,suspenseConfig:p.suspenseConfig,tag:p.tag,payload:p.payload,callback:p.callback,next:null});Vg(g,p.suspenseConfig);a:{var q=a,r=p;g=b;t=c;switch(r.tag){case 1:q=
r.payload;if("function"===typeof q){m=q.call(t,m,g);break a}m=q;break a;case 3:q.effectTag=q.effectTag&-4097|64;case Tg:q=r.payload;g="function"===typeof q?q.call(t,m,g):q;if(null===g||void 0===g)break a;m=M({},m,g);break a;case Jc:Ga=!0}}null!==p.callback&&(a.effectTag|=32,g=e.effects,null===g?e.effects=[p]:g.push(p))}p=p.next;if(null===p||p===h)if(g=e.shared.pending,null===g)break;else p=f.next=g.next,g.next=h,e.baseQueue=f=g,e.shared.pending=null}while(1)}null===l?k=m:l.next=ba;e.baseState=k;e.baseQueue=
l;Kc(n);a.expirationTime=n;a.memoizedState=m}}function Wg(a,b,c){a=b.effects;b.effects=null;if(null!==a)for(b=0;b<a.length;b++){var d=a[b],e=d.callback;if(null!==e){d.callback=null;d=e;e=c;if("function"!==typeof d)throw Error(k(191,d));d.call(e)}}}function Lc(a,b,c,d){b=a.memoizedState;c=c(d,b);c=null===c||void 0===c?b:M({},b,c);a.memoizedState=c;0===a.expirationTime&&(a.updateQueue.baseState=c)}function Xg(a,b,c,d,e,f,g){a=a.stateNode;return"function"===typeof a.shouldComponentUpdate?a.shouldComponentUpdate(d,
f,g):b.prototype&&b.prototype.isPureReactComponent?!Ob(c,d)||!Ob(e,f):!0}function Yg(a,b,c){var d=!1,e=Ca;var f=b.contextType;"object"===typeof f&&null!==f?f=W(f):(e=N(b)?Ra:B.current,d=b.contextTypes,f=(d=null!==d&&void 0!==d)?pb(a,e):Ca);b=new b(c,f);a.memoizedState=null!==b.state&&void 0!==b.state?b.state:null;b.updater=Mc;a.stateNode=b;b._reactInternalFiber=a;d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=e,a.__reactInternalMemoizedMaskedChildContext=f);return b}function Zg(a,
b,c,d){a=b.state;"function"===typeof b.componentWillReceiveProps&&b.componentWillReceiveProps(c,d);"function"===typeof b.UNSAFE_componentWillReceiveProps&&b.UNSAFE_componentWillReceiveProps(c,d);b.state!==a&&Mc.enqueueReplaceState(b,b.state,null)}function pe(a,b,c,d){var e=a.stateNode;e.props=c;e.state=a.memoizedState;e.refs=$g;ne(a);var f=b.contextType;"object"===typeof f&&null!==f?e.context=W(f):(f=N(b)?Ra:B.current,e.context=pb(a,f));Qb(a,c,e,d);e.state=a.memoizedState;f=b.getDerivedStateFromProps;
"function"===typeof f&&(Lc(a,b,f,c),e.state=a.memoizedState);"function"===typeof b.getDerivedStateFromProps||"function"===typeof e.getSnapshotBeforeUpdate||"function"!==typeof e.UNSAFE_componentWillMount&&"function"!==typeof e.componentWillMount||(b=e.state,"function"===typeof e.componentWillMount&&e.componentWillMount(),"function"===typeof e.UNSAFE_componentWillMount&&e.UNSAFE_componentWillMount(),b!==e.state&&Mc.enqueueReplaceState(e,e.state,null),Qb(a,c,e,d),e.state=a.memoizedState);"function"===
typeof e.componentDidMount&&(a.effectTag|=4)}function Rb(a,b,c){a=c.ref;if(null!==a&&"function"!==typeof a&&"object"!==typeof a){if(c._owner){c=c._owner;if(c){if(1!==c.tag)throw Error(k(309));var d=c.stateNode}if(!d)throw Error(k(147,a));var e=""+a;if(null!==b&&null!==b.ref&&"function"===typeof b.ref&&b.ref._stringRef===e)return b.ref;b=function(a){var b=d.refs;b===$g&&(b=d.refs={});null===a?delete b[e]:b[e]=a};b._stringRef=e;return b}if("string"!==typeof a)throw Error(k(284));if(!c._owner)throw Error(k(290,
a));}return a}function Nc(a,b){if("textarea"!==a.type)throw Error(k(31,"[object Object]"===Object.prototype.toString.call(b)?"object with keys {"+Object.keys(b).join(", ")+"}":b,""));}function ah(a){function b(b,c){if(a){var d=b.lastEffect;null!==d?(d.nextEffect=c,b.lastEffect=c):b.firstEffect=b.lastEffect=c;c.nextEffect=null;c.effectTag=8}}function c(c,d){if(!a)return null;for(;null!==d;)b(c,d),d=d.sibling;return null}function d(a,b){for(a=new Map;null!==b;)null!==b.key?a.set(b.key,b):a.set(b.index,
b),b=b.sibling;return a}function e(a,b){a=Sa(a,b);a.index=0;a.sibling=null;return a}function f(b,c,d){b.index=d;if(!a)return c;d=b.alternate;if(null!==d)return d=d.index,d<c?(b.effectTag=2,c):d;b.effectTag=2;return c}function g(b){a&&null===b.alternate&&(b.effectTag=2);return b}function h(a,b,c,d){if(null===b||6!==b.tag)return b=qe(c,a.mode,d),b.return=a,b;b=e(b,c);b.return=a;return b}function m(a,b,c,d){if(null!==b&&b.elementType===c.type)return d=e(b,c.props),d.ref=Rb(a,b,c),d.return=a,d;d=Oc(c.type,
c.key,c.props,null,a.mode,d);d.ref=Rb(a,b,c);d.return=a;return d}function n(a,b,c,d){if(null===b||4!==b.tag||b.stateNode.containerInfo!==c.containerInfo||b.stateNode.implementation!==c.implementation)return b=re(c,a.mode,d),b.return=a,b;b=e(b,c.children||[]);b.return=a;return b}function l(a,b,c,d,f){if(null===b||7!==b.tag)return b=Ha(c,a.mode,d,f),b.return=a,b;b=e(b,c);b.return=a;return b}function ba(a,b,c){if("string"===typeof b||"number"===typeof b)return b=qe(""+b,a.mode,c),b.return=a,b;if("object"===
typeof b&&null!==b){switch(b.$$typeof){case Pc:return c=Oc(b.type,b.key,b.props,null,a.mode,c),c.ref=Rb(a,null,b),c.return=a,c;case gb:return b=re(b,a.mode,c),b.return=a,b}if(Qc(b)||zb(b))return b=Ha(b,a.mode,c,null),b.return=a,b;Nc(a,b)}return null}function p(a,b,c,d){var e=null!==b?b.key:null;if("string"===typeof c||"number"===typeof c)return null!==e?null:h(a,b,""+c,d);if("object"===typeof c&&null!==c){switch(c.$$typeof){case Pc:return c.key===e?c.type===Ma?l(a,b,c.props.children,d,e):m(a,b,c,
d):null;case gb:return c.key===e?n(a,b,c,d):null}if(Qc(c)||zb(c))return null!==e?null:l(a,b,c,d,null);Nc(a,c)}return null}function t(a,b,c,d,e){if("string"===typeof d||"number"===typeof d)return a=a.get(c)||null,h(b,a,""+d,e);if("object"===typeof d&&null!==d){switch(d.$$typeof){case Pc:return a=a.get(null===d.key?c:d.key)||null,d.type===Ma?l(b,a,d.props.children,e,d.key):m(b,a,d,e);case gb:return a=a.get(null===d.key?c:d.key)||null,n(b,a,d,e)}if(Qc(d)||zb(d))return a=a.get(c)||null,l(b,a,d,e,null);
Nc(b,d)}return null}function q(e,g,h,m){for(var n=null,k=null,l=g,r=g=0,C=null;null!==l&&r<h.length;r++){l.index>r?(C=l,l=null):C=l.sibling;var O=p(e,l,h[r],m);if(null===O){null===l&&(l=C);break}a&&l&&null===O.alternate&&b(e,l);g=f(O,g,r);null===k?n=O:k.sibling=O;k=O;l=C}if(r===h.length)return c(e,l),n;if(null===l){for(;r<h.length;r++)l=ba(e,h[r],m),null!==l&&(g=f(l,g,r),null===k?n=l:k.sibling=l,k=l);return n}for(l=d(e,l);r<h.length;r++)C=t(l,e,r,h[r],m),null!==C&&(a&&null!==C.alternate&&l.delete(null===
C.key?r:C.key),g=f(C,g,r),null===k?n=C:k.sibling=C,k=C);a&&l.forEach(function(a){return b(e,a)});return n}function w(e,g,h,n){var m=zb(h);if("function"!==typeof m)throw Error(k(150));h=m.call(h);if(null==h)throw Error(k(151));for(var l=m=null,r=g,C=g=0,O=null,v=h.next();null!==r&&!v.done;C++,v=h.next()){r.index>C?(O=r,r=null):O=r.sibling;var q=p(e,r,v.value,n);if(null===q){null===r&&(r=O);break}a&&r&&null===q.alternate&&b(e,r);g=f(q,g,C);null===l?m=q:l.sibling=q;l=q;r=O}if(v.done)return c(e,r),m;
if(null===r){for(;!v.done;C++,v=h.next())v=ba(e,v.value,n),null!==v&&(g=f(v,g,C),null===l?m=v:l.sibling=v,l=v);return m}for(r=d(e,r);!v.done;C++,v=h.next())v=t(r,e,C,v.value,n),null!==v&&(a&&null!==v.alternate&&r.delete(null===v.key?C:v.key),g=f(v,g,C),null===l?m=v:l.sibling=v,l=v);a&&r.forEach(function(a){return b(e,a)});return m}return function(a,d,f,h){var m="object"===typeof f&&null!==f&&f.type===Ma&&null===f.key;m&&(f=f.props.children);var n="object"===typeof f&&null!==f;if(n)switch(f.$$typeof){case Pc:a:{n=
f.key;for(m=d;null!==m;){if(m.key===n){switch(m.tag){case 7:if(f.type===Ma){c(a,m.sibling);d=e(m,f.props.children);d.return=a;a=d;break a}break;default:if(m.elementType===f.type){c(a,m.sibling);d=e(m,f.props);d.ref=Rb(a,m,f);d.return=a;a=d;break a}}c(a,m);break}else b(a,m);m=m.sibling}f.type===Ma?(d=Ha(f.props.children,a.mode,h,f.key),d.return=a,a=d):(h=Oc(f.type,f.key,f.props,null,a.mode,h),h.ref=Rb(a,d,f),h.return=a,a=h)}return g(a);case gb:a:{for(m=f.key;null!==d;){if(d.key===m)if(4===d.tag&&d.stateNode.containerInfo===
f.containerInfo&&d.stateNode.implementation===f.implementation){c(a,d.sibling);d=e(d,f.children||[]);d.return=a;a=d;break a}else{c(a,d);break}else b(a,d);d=d.sibling}d=re(f,a.mode,h);d.return=a;a=d}return g(a)}if("string"===typeof f||"number"===typeof f)return f=""+f,null!==d&&6===d.tag?(c(a,d.sibling),d=e(d,f),d.return=a,a=d):(c(a,d),d=qe(f,a.mode,h),d.return=a,a=d),g(a);if(Qc(f))return q(a,d,f,h);if(zb(f))return w(a,d,f,h);n&&Nc(a,f);if("undefined"===typeof f&&!m)switch(a.tag){case 1:case 0:throw a=
a.type,Error(k(152,a.displayName||a.name||"Component"));}return c(a,d)}}function Ta(a){if(a===Sb)throw Error(k(174));return a}function se(a,b){y(Tb,b);y(Ub,a);y(ja,Sb);a=b.nodeType;switch(a){case 9:case 11:b=(b=b.documentElement)?b.namespaceURI:Hd(null,"");break;default:a=8===a?b.parentNode:b,b=a.namespaceURI||null,a=a.tagName,b=Hd(b,a)}q(ja);y(ja,b)}function tb(a){q(ja);q(Ub);q(Tb)}function bh(a){Ta(Tb.current);var b=Ta(ja.current);var c=Hd(b,a.type);b!==c&&(y(Ub,a),y(ja,c))}function te(a){Ub.current===
a&&(q(ja),q(Ub))}function Rc(a){for(var b=a;null!==b;){if(13===b.tag){var c=b.memoizedState;if(null!==c&&(c=c.dehydrated,null===c||c.data===$d||c.data===Zd))return b}else if(19===b.tag&&void 0!==b.memoizedProps.revealOrder){if(0!==(b.effectTag&64))return b}else if(null!==b.child){b.child.return=b;b=b.child;continue}if(b===a)break;for(;null===b.sibling;){if(null===b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}return null}function ue(a,b){return{responder:a,props:b}}
function S(){throw Error(k(321));}function ve(a,b){if(null===b)return!1;for(var c=0;c<b.length&&c<a.length;c++)if(!Qa(a[c],b[c]))return!1;return!0}function we(a,b,c,d,e,f){Ia=f;z=b;b.memoizedState=null;b.updateQueue=null;b.expirationTime=0;Sc.current=null===a||null===a.memoizedState?dj:ej;a=c(d,e);if(b.expirationTime===Ia){f=0;do{b.expirationTime=0;if(!(25>f))throw Error(k(301));f+=1;J=K=null;b.updateQueue=null;Sc.current=fj;a=c(d,e)}while(b.expirationTime===Ia)}Sc.current=Tc;b=null!==K&&null!==K.next;
Ia=0;J=K=z=null;Uc=!1;if(b)throw Error(k(300));return a}function ub(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};null===J?z.memoizedState=J=a:J=J.next=a;return J}function vb(){if(null===K){var a=z.alternate;a=null!==a?a.memoizedState:null}else a=K.next;var b=null===J?z.memoizedState:J.next;if(null!==b)J=b,K=a;else{if(null===a)throw Error(k(310));K=a;a={memoizedState:K.memoizedState,baseState:K.baseState,baseQueue:K.baseQueue,queue:K.queue,next:null};null===J?z.memoizedState=
J=a:J=J.next=a}return J}function Ua(a,b){return"function"===typeof b?b(a):b}function Vc(a,b,c){b=vb();c=b.queue;if(null===c)throw Error(k(311));c.lastRenderedReducer=a;var d=K,e=d.baseQueue,f=c.pending;if(null!==f){if(null!==e){var g=e.next;e.next=f.next;f.next=g}d.baseQueue=e=f;c.pending=null}if(null!==e){e=e.next;d=d.baseState;var h=g=f=null,m=e;do{var n=m.expirationTime;if(n<Ia){var l={expirationTime:m.expirationTime,suspenseConfig:m.suspenseConfig,action:m.action,eagerReducer:m.eagerReducer,eagerState:m.eagerState,
next:null};null===h?(g=h=l,f=d):h=h.next=l;n>z.expirationTime&&(z.expirationTime=n,Kc(n))}else null!==h&&(h=h.next={expirationTime:1073741823,suspenseConfig:m.suspenseConfig,action:m.action,eagerReducer:m.eagerReducer,eagerState:m.eagerState,next:null}),Vg(n,m.suspenseConfig),d=m.eagerReducer===a?m.eagerState:a(d,m.action);m=m.next}while(null!==m&&m!==e);null===h?f=d:h.next=g;Qa(d,b.memoizedState)||(ia=!0);b.memoizedState=d;b.baseState=f;b.baseQueue=h;c.lastRenderedState=d}return[b.memoizedState,
c.dispatch]}function Wc(a,b,c){b=vb();c=b.queue;if(null===c)throw Error(k(311));c.lastRenderedReducer=a;var d=c.dispatch,e=c.pending,f=b.memoizedState;if(null!==e){c.pending=null;var g=e=e.next;do f=a(f,g.action),g=g.next;while(g!==e);Qa(f,b.memoizedState)||(ia=!0);b.memoizedState=f;null===b.baseQueue&&(b.baseState=f);c.lastRenderedState=f}return[f,d]}function xe(a){var b=ub();"function"===typeof a&&(a=a());b.memoizedState=b.baseState=a;a=b.queue={pending:null,dispatch:null,lastRenderedReducer:Ua,
lastRenderedState:a};a=a.dispatch=ch.bind(null,z,a);return[b.memoizedState,a]}function ye(a,b,c,d){a={tag:a,create:b,destroy:c,deps:d,next:null};b=z.updateQueue;null===b?(b={lastEffect:null},z.updateQueue=b,b.lastEffect=a.next=a):(c=b.lastEffect,null===c?b.lastEffect=a.next=a:(d=c.next,c.next=a,a.next=d,b.lastEffect=a));return a}function dh(a){return vb().memoizedState}function ze(a,b,c,d){var e=ub();z.effectTag|=a;e.memoizedState=ye(1|b,c,void 0,void 0===d?null:d)}function Ae(a,b,c,d){var e=vb();
d=void 0===d?null:d;var f=void 0;if(null!==K){var g=K.memoizedState;f=g.destroy;if(null!==d&&ve(d,g.deps)){ye(b,c,f,d);return}}z.effectTag|=a;e.memoizedState=ye(1|b,c,f,d)}function eh(a,b){return ze(516,4,a,b)}function Xc(a,b){return Ae(516,4,a,b)}function fh(a,b){return Ae(4,2,a,b)}function gh(a,b){if("function"===typeof b)return a=a(),b(a),function(){b(null)};if(null!==b&&void 0!==b)return a=a(),b.current=a,function(){b.current=null}}function hh(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;
return Ae(4,2,gh.bind(null,b,a),c)}function Be(a,b){}function ih(a,b){ub().memoizedState=[a,void 0===b?null:b];return a}function Yc(a,b){var c=vb();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&ve(b,d[1]))return d[0];c.memoizedState=[a,b];return a}function jh(a,b){var c=vb();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&ve(b,d[1]))return d[0];a=a();c.memoizedState=[a,b];return a}function Ce(a,b,c){var d=Cc();Da(98>d?98:d,function(){a(!0)});Da(97<d?97:d,function(){var d=
X.suspense;X.suspense=void 0===b?null:b;try{a(!1),c()}finally{X.suspense=d}})}function ch(a,b,c){var d=ka(),e=Vb.suspense;d=Va(d,a,e);e={expirationTime:d,suspenseConfig:e,action:c,eagerReducer:null,eagerState:null,next:null};var f=b.pending;null===f?e.next=e:(e.next=f.next,f.next=e);b.pending=e;f=a.alternate;if(a===z||null!==f&&f===z)Uc=!0,e.expirationTime=Ia,z.expirationTime=Ia;else{if(0===a.expirationTime&&(null===f||0===f.expirationTime)&&(f=b.lastRenderedReducer,null!==f))try{var g=b.lastRenderedState,
h=f(g,c);e.eagerReducer=f;e.eagerState=h;if(Qa(h,g))return}catch(m){}finally{}Ja(a,d)}}function kh(a,b){var c=la(5,null,null,0);c.elementType="DELETED";c.type="DELETED";c.stateNode=b;c.return=a;c.effectTag=8;null!==a.lastEffect?(a.lastEffect.nextEffect=c,a.lastEffect=c):a.firstEffect=a.lastEffect=c}function lh(a,b){switch(a.tag){case 5:var c=a.type;b=1!==b.nodeType||c.toLowerCase()!==b.nodeName.toLowerCase()?null:b;return null!==b?(a.stateNode=b,!0):!1;case 6:return b=""===a.pendingProps||3!==b.nodeType?
null:b,null!==b?(a.stateNode=b,!0):!1;case 13:return!1;default:return!1}}function De(a){if(Wa){var b=Ka;if(b){var c=b;if(!lh(a,b)){b=kb(c.nextSibling);if(!b||!lh(a,b)){a.effectTag=a.effectTag&-1025|2;Wa=!1;ra=a;return}kh(ra,c)}ra=a;Ka=kb(b.firstChild)}else a.effectTag=a.effectTag&-1025|2,Wa=!1,ra=a}}function mh(a){for(a=a.return;null!==a&&5!==a.tag&&3!==a.tag&&13!==a.tag;)a=a.return;ra=a}function Zc(a){if(a!==ra)return!1;if(!Wa)return mh(a),Wa=!0,!1;var b=a.type;if(5!==a.tag||"head"!==b&&"body"!==
b&&!Yd(b,a.memoizedProps))for(b=Ka;b;)kh(a,b),b=kb(b.nextSibling);mh(a);if(13===a.tag){a=a.memoizedState;a=null!==a?a.dehydrated:null;if(!a)throw Error(k(317));a:{a=a.nextSibling;for(b=0;a;){if(8===a.nodeType){var c=a.data;if(c===og){if(0===b){Ka=kb(a.nextSibling);break a}b--}else c!==ng&&c!==Zd&&c!==$d||b++}a=a.nextSibling}Ka=null}}else Ka=ra?kb(a.stateNode.nextSibling):null;return!0}function Ee(){Ka=ra=null;Wa=!1}function T(a,b,c,d){b.child=null===a?Fe(b,null,c,d):wb(b,a.child,c,d)}function nh(a,
b,c,d,e){c=c.render;var f=b.ref;rb(b,e);d=we(a,b,c,d,f,e);if(null!==a&&!ia)return b.updateQueue=a.updateQueue,b.effectTag&=-517,a.expirationTime<=e&&(a.expirationTime=0),sa(a,b,e);b.effectTag|=1;T(a,b,d,e);return b.child}function oh(a,b,c,d,e,f){if(null===a){var g=c.type;if("function"===typeof g&&!Ge(g)&&void 0===g.defaultProps&&null===c.compare&&void 0===c.defaultProps)return b.tag=15,b.type=g,ph(a,b,g,d,e,f);a=Oc(c.type,null,d,null,b.mode,f);a.ref=b.ref;a.return=b;return b.child=a}g=a.child;if(e<
f&&(e=g.memoizedProps,c=c.compare,c=null!==c?c:Ob,c(e,d)&&a.ref===b.ref))return sa(a,b,f);b.effectTag|=1;a=Sa(g,d);a.ref=b.ref;a.return=b;return b.child=a}function ph(a,b,c,d,e,f){return null!==a&&Ob(a.memoizedProps,d)&&a.ref===b.ref&&(ia=!1,e<f)?(b.expirationTime=a.expirationTime,sa(a,b,f)):He(a,b,c,d,f)}function qh(a,b){var c=b.ref;if(null===a&&null!==c||null!==a&&a.ref!==c)b.effectTag|=128}function He(a,b,c,d,e){var f=N(c)?Ra:B.current;f=pb(b,f);rb(b,e);c=we(a,b,c,d,f,e);if(null!==a&&!ia)return b.updateQueue=
a.updateQueue,b.effectTag&=-517,a.expirationTime<=e&&(a.expirationTime=0),sa(a,b,e);b.effectTag|=1;T(a,b,c,e);return b.child}function rh(a,b,c,d,e){if(N(c)){var f=!0;Bc(b)}else f=!1;rb(b,e);if(null===b.stateNode)null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2),Yg(b,c,d),pe(b,c,d,e),d=!0;else if(null===a){var g=b.stateNode,h=b.memoizedProps;g.props=h;var m=g.context,n=c.contextType;"object"===typeof n&&null!==n?n=W(n):(n=N(c)?Ra:B.current,n=pb(b,n));var l=c.getDerivedStateFromProps,k="function"===
typeof l||"function"===typeof g.getSnapshotBeforeUpdate;k||"function"!==typeof g.UNSAFE_componentWillReceiveProps&&"function"!==typeof g.componentWillReceiveProps||(h!==d||m!==n)&&Zg(b,g,d,n);Ga=!1;var p=b.memoizedState;g.state=p;Qb(b,d,g,e);m=b.memoizedState;h!==d||p!==m||G.current||Ga?("function"===typeof l&&(Lc(b,c,l,d),m=b.memoizedState),(h=Ga||Xg(b,c,h,d,p,m,n))?(k||"function"!==typeof g.UNSAFE_componentWillMount&&"function"!==typeof g.componentWillMount||("function"===typeof g.componentWillMount&&
g.componentWillMount(),"function"===typeof g.UNSAFE_componentWillMount&&g.UNSAFE_componentWillMount()),"function"===typeof g.componentDidMount&&(b.effectTag|=4)):("function"===typeof g.componentDidMount&&(b.effectTag|=4),b.memoizedProps=d,b.memoizedState=m),g.props=d,g.state=m,g.context=n,d=h):("function"===typeof g.componentDidMount&&(b.effectTag|=4),d=!1)}else g=b.stateNode,oe(a,b),h=b.memoizedProps,g.props=b.type===b.elementType?h:aa(b.type,h),m=g.context,n=c.contextType,"object"===typeof n&&null!==
n?n=W(n):(n=N(c)?Ra:B.current,n=pb(b,n)),l=c.getDerivedStateFromProps,(k="function"===typeof l||"function"===typeof g.getSnapshotBeforeUpdate)||"function"!==typeof g.UNSAFE_componentWillReceiveProps&&"function"!==typeof g.componentWillReceiveProps||(h!==d||m!==n)&&Zg(b,g,d,n),Ga=!1,m=b.memoizedState,g.state=m,Qb(b,d,g,e),p=b.memoizedState,h!==d||m!==p||G.current||Ga?("function"===typeof l&&(Lc(b,c,l,d),p=b.memoizedState),(l=Ga||Xg(b,c,h,d,m,p,n))?(k||"function"!==typeof g.UNSAFE_componentWillUpdate&&
"function"!==typeof g.componentWillUpdate||("function"===typeof g.componentWillUpdate&&g.componentWillUpdate(d,p,n),"function"===typeof g.UNSAFE_componentWillUpdate&&g.UNSAFE_componentWillUpdate(d,p,n)),"function"===typeof g.componentDidUpdate&&(b.effectTag|=4),"function"===typeof g.getSnapshotBeforeUpdate&&(b.effectTag|=256)):("function"!==typeof g.componentDidUpdate||h===a.memoizedProps&&m===a.memoizedState||(b.effectTag|=4),"function"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&m===
a.memoizedState||(b.effectTag|=256),b.memoizedProps=d,b.memoizedState=p),g.props=d,g.state=p,g.context=n,d=l):("function"!==typeof g.componentDidUpdate||h===a.memoizedProps&&m===a.memoizedState||(b.effectTag|=4),"function"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&m===a.memoizedState||(b.effectTag|=256),d=!1);return Ie(a,b,c,d,f,e)}function Ie(a,b,c,d,e,f){qh(a,b);var g=0!==(b.effectTag&64);if(!d&&!g)return e&&Hg(b,c,!1),sa(a,b,f);d=b.stateNode;gj.current=b;var h=g&&"function"!==typeof c.getDerivedStateFromError?
null:d.render();b.effectTag|=1;null!==a&&g?(b.child=wb(b,a.child,null,f),b.child=wb(b,null,h,f)):T(a,b,h,f);b.memoizedState=d.state;e&&Hg(b,c,!0);return b.child}function sh(a){var b=a.stateNode;b.pendingContext?Fg(a,b.pendingContext,b.pendingContext!==b.context):b.context&&Fg(a,b.context,!1);se(a,b.containerInfo)}function th(a,b,c){var d=b.mode,e=b.pendingProps,f=D.current,g=!1,h;(h=0!==(b.effectTag&64))||(h=0!==(f&2)&&(null===a||null!==a.memoizedState));h?(g=!0,b.effectTag&=-65):null!==a&&null===
a.memoizedState||void 0===e.fallback||!0===e.unstable_avoidThisFallback||(f|=1);y(D,f&1);if(null===a){void 0!==e.fallback&&De(b);if(g){g=e.fallback;e=Ha(null,d,0,null);e.return=b;if(0===(b.mode&2))for(a=null!==b.memoizedState?b.child.child:b.child,e.child=a;null!==a;)a.return=e,a=a.sibling;c=Ha(g,d,c,null);c.return=b;e.sibling=c;b.memoizedState=Je;b.child=e;return c}d=e.children;b.memoizedState=null;return b.child=Fe(b,null,d,c)}if(null!==a.memoizedState){a=a.child;d=a.sibling;if(g){e=e.fallback;
c=Sa(a,a.pendingProps);c.return=b;if(0===(b.mode&2)&&(g=null!==b.memoizedState?b.child.child:b.child,g!==a.child))for(c.child=g;null!==g;)g.return=c,g=g.sibling;d=Sa(d,e);d.return=b;c.sibling=d;c.childExpirationTime=0;b.memoizedState=Je;b.child=c;return d}c=wb(b,a.child,e.children,c);b.memoizedState=null;return b.child=c}a=a.child;if(g){g=e.fallback;e=Ha(null,d,0,null);e.return=b;e.child=a;null!==a&&(a.return=e);if(0===(b.mode&2))for(a=null!==b.memoizedState?b.child.child:b.child,e.child=a;null!==
a;)a.return=e,a=a.sibling;c=Ha(g,d,c,null);c.return=b;e.sibling=c;c.effectTag|=2;e.childExpirationTime=0;b.memoizedState=Je;b.child=e;return c}b.memoizedState=null;return b.child=wb(b,a,e.children,c)}function uh(a,b){a.expirationTime<b&&(a.expirationTime=b);var c=a.alternate;null!==c&&c.expirationTime<b&&(c.expirationTime=b);Sg(a.return,b)}function Ke(a,b,c,d,e,f){var g=a.memoizedState;null===g?a.memoizedState={isBackwards:b,rendering:null,renderingStartTime:0,last:d,tail:c,tailExpiration:0,tailMode:e,
lastEffect:f}:(g.isBackwards=b,g.rendering=null,g.renderingStartTime=0,g.last=d,g.tail=c,g.tailExpiration=0,g.tailMode=e,g.lastEffect=f)}function vh(a,b,c){var d=b.pendingProps,e=d.revealOrder,f=d.tail;T(a,b,d.children,c);d=D.current;if(0!==(d&2))d=d&1|2,b.effectTag|=64;else{if(null!==a&&0!==(a.effectTag&64))a:for(a=b.child;null!==a;){if(13===a.tag)null!==a.memoizedState&&uh(a,c);else if(19===a.tag)uh(a,c);else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===b)break a;for(;null===a.sibling;){if(null===
a.return||a.return===b)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}d&=1}y(D,d);if(0===(b.mode&2))b.memoizedState=null;else switch(e){case "forwards":c=b.child;for(e=null;null!==c;)a=c.alternate,null!==a&&null===Rc(a)&&(e=c),c=c.sibling;c=e;null===c?(e=b.child,b.child=null):(e=c.sibling,c.sibling=null);Ke(b,!1,e,c,f,b.lastEffect);break;case "backwards":c=null;e=b.child;for(b.child=null;null!==e;){a=e.alternate;if(null!==a&&null===Rc(a)){b.child=e;break}a=e.sibling;e.sibling=c;c=e;e=a}Ke(b,
!0,c,null,f,b.lastEffect);break;case "together":Ke(b,!1,null,null,void 0,b.lastEffect);break;default:b.memoizedState=null}return b.child}function sa(a,b,c){null!==a&&(b.dependencies=a.dependencies);var d=b.expirationTime;0!==d&&Kc(d);if(b.childExpirationTime<c)return null;if(null!==a&&b.child!==a.child)throw Error(k(153));if(null!==b.child){a=b.child;c=Sa(a,a.pendingProps);b.child=c;for(c.return=b;null!==a.sibling;)a=a.sibling,c=c.sibling=Sa(a,a.pendingProps),c.return=b;c.sibling=null}return b.child}
function $c(a,b){switch(a.tailMode){case "hidden":b=a.tail;for(var c=null;null!==b;)null!==b.alternate&&(c=b),b=b.sibling;null===c?a.tail=null:c.sibling=null;break;case "collapsed":c=a.tail;for(var d=null;null!==c;)null!==c.alternate&&(d=c),c=c.sibling;null===d?b||null===a.tail?a.tail=null:a.tail.sibling=null:d.sibling=null}}function hj(a,b,c){var d=b.pendingProps;switch(b.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return N(b.type)&&(q(G),q(B)),
null;case 3:return tb(),q(G),q(B),c=b.stateNode,c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),null!==a&&null!==a.child||!Zc(b)||(b.effectTag|=4),wh(b),null;case 5:te(b);c=Ta(Tb.current);var e=b.type;if(null!==a&&null!=b.stateNode)ij(a,b,e,d,c),a.ref!==b.ref&&(b.effectTag|=128);else{if(!d){if(null===b.stateNode)throw Error(k(166));return null}a=Ta(ja.current);if(Zc(b)){d=b.stateNode;e=b.type;var f=b.memoizedProps;d[Aa]=b;d[vc]=f;switch(e){case "iframe":case "object":case "embed":w("load",
d);break;case "video":case "audio":for(a=0;a<Db.length;a++)w(Db[a],d);break;case "source":w("error",d);break;case "img":case "image":case "link":w("error",d);w("load",d);break;case "form":w("reset",d);w("submit",d);break;case "details":w("toggle",d);break;case "input":Hf(d,f);w("invalid",d);oa(c,"onChange");break;case "select":d._wrapperState={wasMultiple:!!f.multiple};w("invalid",d);oa(c,"onChange");break;case "textarea":Kf(d,f),w("invalid",d),oa(c,"onChange")}Ud(e,f);a=null;for(var g in f)if(f.hasOwnProperty(g)){var h=
f[g];"children"===g?"string"===typeof h?d.textContent!==h&&(a=["children",h]):"number"===typeof h&&d.textContent!==""+h&&(a=["children",""+h]):db.hasOwnProperty(g)&&null!=h&&oa(c,g)}switch(e){case "input":mc(d);Jf(d,f,!0);break;case "textarea":mc(d);Mf(d);break;case "select":case "option":break;default:"function"===typeof f.onClick&&(d.onclick=uc)}c=a;b.updateQueue=c;null!==c&&(b.effectTag|=4)}else{g=9===c.nodeType?c:c.ownerDocument;"http://www.w3.org/1999/xhtml"===a&&(a=Nf(e));"http://www.w3.org/1999/xhtml"===
a?"script"===e?(a=g.createElement("div"),a.innerHTML="<script>\x3c/script>",a=a.removeChild(a.firstChild)):"string"===typeof d.is?a=g.createElement(e,{is:d.is}):(a=g.createElement(e),"select"===e&&(g=a,d.multiple?g.multiple=!0:d.size&&(g.size=d.size))):a=g.createElementNS(a,e);a[Aa]=b;a[vc]=d;jj(a,b,!1,!1);b.stateNode=a;g=Vd(e,d);switch(e){case "iframe":case "object":case "embed":w("load",a);h=d;break;case "video":case "audio":for(h=0;h<Db.length;h++)w(Db[h],a);h=d;break;case "source":w("error",a);
h=d;break;case "img":case "image":case "link":w("error",a);w("load",a);h=d;break;case "form":w("reset",a);w("submit",a);h=d;break;case "details":w("toggle",a);h=d;break;case "input":Hf(a,d);h=Cd(a,d);w("invalid",a);oa(c,"onChange");break;case "option":h=Fd(a,d);break;case "select":a._wrapperState={wasMultiple:!!d.multiple};h=M({},d,{value:void 0});w("invalid",a);oa(c,"onChange");break;case "textarea":Kf(a,d);h=Gd(a,d);w("invalid",a);oa(c,"onChange");break;default:h=d}Ud(e,h);var m=h;for(f in m)if(m.hasOwnProperty(f)){var n=
m[f];"style"===f?gg(a,n):"dangerouslySetInnerHTML"===f?(n=n?n.__html:void 0,null!=n&&xh(a,n)):"children"===f?"string"===typeof n?("textarea"!==e||""!==n)&&Wb(a,n):"number"===typeof n&&Wb(a,""+n):"suppressContentEditableWarning"!==f&&"suppressHydrationWarning"!==f&&"autoFocus"!==f&&(db.hasOwnProperty(f)?null!=n&&oa(c,f):null!=n&&xd(a,f,n,g))}switch(e){case "input":mc(a);Jf(a,d,!1);break;case "textarea":mc(a);Mf(a);break;case "option":null!=d.value&&a.setAttribute("value",""+va(d.value));break;case "select":a.multiple=
!!d.multiple;c=d.value;null!=c?hb(a,!!d.multiple,c,!1):null!=d.defaultValue&&hb(a,!!d.multiple,d.defaultValue,!0);break;default:"function"===typeof h.onClick&&(a.onclick=uc)}lg(e,d)&&(b.effectTag|=4)}null!==b.ref&&(b.effectTag|=128)}return null;case 6:if(a&&null!=b.stateNode)kj(a,b,a.memoizedProps,d);else{if("string"!==typeof d&&null===b.stateNode)throw Error(k(166));c=Ta(Tb.current);Ta(ja.current);Zc(b)?(c=b.stateNode,d=b.memoizedProps,c[Aa]=b,c.nodeValue!==d&&(b.effectTag|=4)):(c=(9===c.nodeType?
c:c.ownerDocument).createTextNode(d),c[Aa]=b,b.stateNode=c)}return null;case 13:q(D);d=b.memoizedState;if(0!==(b.effectTag&64))return b.expirationTime=c,b;c=null!==d;d=!1;null===a?void 0!==b.memoizedProps.fallback&&Zc(b):(e=a.memoizedState,d=null!==e,c||null===e||(e=a.child.sibling,null!==e&&(f=b.firstEffect,null!==f?(b.firstEffect=e,e.nextEffect=f):(b.firstEffect=b.lastEffect=e,e.nextEffect=null),e.effectTag=8)));if(c&&!d&&0!==(b.mode&2))if(null===a&&!0!==b.memoizedProps.unstable_avoidThisFallback||
0!==(D.current&1))F===Xa&&(F=ad);else{if(F===Xa||F===ad)F=bd;0!==Xb&&null!==U&&(Ya(U,P),yh(U,Xb))}if(c||d)b.effectTag|=4;return null;case 4:return tb(),wh(b),null;case 10:return me(b),null;case 17:return N(b.type)&&(q(G),q(B)),null;case 19:q(D);d=b.memoizedState;if(null===d)return null;e=0!==(b.effectTag&64);f=d.rendering;if(null===f)if(e)$c(d,!1);else{if(F!==Xa||null!==a&&0!==(a.effectTag&64))for(f=b.child;null!==f;){a=Rc(f);if(null!==a){b.effectTag|=64;$c(d,!1);e=a.updateQueue;null!==e&&(b.updateQueue=
e,b.effectTag|=4);null===d.lastEffect&&(b.firstEffect=null);b.lastEffect=d.lastEffect;for(d=b.child;null!==d;)e=d,f=c,e.effectTag&=2,e.nextEffect=null,e.firstEffect=null,e.lastEffect=null,a=e.alternate,null===a?(e.childExpirationTime=0,e.expirationTime=f,e.child=null,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null):(e.childExpirationTime=a.childExpirationTime,e.expirationTime=a.expirationTime,e.child=a.child,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,
e.updateQueue=a.updateQueue,f=a.dependencies,e.dependencies=null===f?null:{expirationTime:f.expirationTime,firstContext:f.firstContext,responders:f.responders}),d=d.sibling;y(D,D.current&1|2);return b.child}f=f.sibling}}else{if(!e)if(a=Rc(f),null!==a){if(b.effectTag|=64,e=!0,c=a.updateQueue,null!==c&&(b.updateQueue=c,b.effectTag|=4),$c(d,!0),null===d.tail&&"hidden"===d.tailMode&&!f.alternate)return b=b.lastEffect=d.lastEffect,null!==b&&(b.nextEffect=null),null}else 2*Y()-d.renderingStartTime>d.tailExpiration&&
1<c&&(b.effectTag|=64,e=!0,$c(d,!1),b.expirationTime=b.childExpirationTime=c-1);d.isBackwards?(f.sibling=b.child,b.child=f):(c=d.last,null!==c?c.sibling=f:b.child=f,d.last=f)}return null!==d.tail?(0===d.tailExpiration&&(d.tailExpiration=Y()+500),c=d.tail,d.rendering=c,d.tail=c.sibling,d.lastEffect=b.lastEffect,d.renderingStartTime=Y(),c.sibling=null,b=D.current,y(D,e?b&1|2:b&1),c):null}throw Error(k(156,b.tag));}function lj(a,b){switch(a.tag){case 1:return N(a.type)&&(q(G),q(B)),b=a.effectTag,b&4096?
(a.effectTag=b&-4097|64,a):null;case 3:tb();q(G);q(B);b=a.effectTag;if(0!==(b&64))throw Error(k(285));a.effectTag=b&-4097|64;return a;case 5:return te(a),null;case 13:return q(D),b=a.effectTag,b&4096?(a.effectTag=b&-4097|64,a):null;case 19:return q(D),null;case 4:return tb(),null;case 10:return me(a),null;default:return null}}function Le(a,b){return{value:a,source:b,stack:Bd(b)}}function Me(a,b){var c=b.source,d=b.stack;null===d&&null!==c&&(d=Bd(c));null!==c&&na(c.type);b=b.value;null!==a&&1===a.tag&&
na(a.type);try{console.error(b)}catch(e){setTimeout(function(){throw e;})}}function mj(a,b){try{b.props=a.memoizedProps,b.state=a.memoizedState,b.componentWillUnmount()}catch(c){Za(a,c)}}function zh(a){var b=a.ref;if(null!==b)if("function"===typeof b)try{b(null)}catch(c){Za(a,c)}else b.current=null}function nj(a,b){switch(b.tag){case 0:case 11:case 15:case 22:return;case 1:if(b.effectTag&256&&null!==a){var c=a.memoizedProps,d=a.memoizedState;a=b.stateNode;b=a.getSnapshotBeforeUpdate(b.elementType===
b.type?c:aa(b.type,c),d);a.__reactInternalSnapshotBeforeUpdate=b}return;case 3:case 5:case 6:case 4:case 17:return}throw Error(k(163));}function Ah(a,b){b=b.updateQueue;b=null!==b?b.lastEffect:null;if(null!==b){var c=b=b.next;do{if((c.tag&a)===a){var d=c.destroy;c.destroy=void 0;void 0!==d&&d()}c=c.next}while(c!==b)}}function Bh(a,b){b=b.updateQueue;b=null!==b?b.lastEffect:null;if(null!==b){var c=b=b.next;do{if((c.tag&a)===a){var d=c.create;c.destroy=d()}c=c.next}while(c!==b)}}function oj(a,b,c,d){switch(c.tag){case 0:case 11:case 15:case 22:Bh(3,
c);return;case 1:a=c.stateNode;c.effectTag&4&&(null===b?a.componentDidMount():(d=c.elementType===c.type?b.memoizedProps:aa(c.type,b.memoizedProps),a.componentDidUpdate(d,b.memoizedState,a.__reactInternalSnapshotBeforeUpdate)));b=c.updateQueue;null!==b&&Wg(c,b,a);return;case 3:b=c.updateQueue;if(null!==b){a=null;if(null!==c.child)switch(c.child.tag){case 5:a=c.child.stateNode;break;case 1:a=c.child.stateNode}Wg(c,b,a)}return;case 5:a=c.stateNode;null===b&&c.effectTag&4&&lg(c.type,c.memoizedProps)&&
a.focus();return;case 6:return;case 4:return;case 12:return;case 13:null===c.memoizedState&&(c=c.alternate,null!==c&&(c=c.memoizedState,null!==c&&(c=c.dehydrated,null!==c&&bg(c))));return;case 19:case 17:case 20:case 21:return}throw Error(k(163));}function Ch(a,b,c){"function"===typeof Ne&&Ne(b);switch(b.tag){case 0:case 11:case 14:case 15:case 22:a=b.updateQueue;if(null!==a&&(a=a.lastEffect,null!==a)){var d=a.next;Da(97<c?97:c,function(){var a=d;do{var c=a.destroy;if(void 0!==c){var g=b;try{c()}catch(h){Za(g,
h)}}a=a.next}while(a!==d)})}break;case 1:zh(b);c=b.stateNode;"function"===typeof c.componentWillUnmount&&mj(b,c);break;case 5:zh(b);break;case 4:Dh(a,b,c)}}function Eh(a){var b=a.alternate;a.return=null;a.child=null;a.memoizedState=null;a.updateQueue=null;a.dependencies=null;a.alternate=null;a.firstEffect=null;a.lastEffect=null;a.pendingProps=null;a.memoizedProps=null;a.stateNode=null;null!==b&&Eh(b)}function Fh(a){return 5===a.tag||3===a.tag||4===a.tag}function Gh(a){a:{for(var b=a.return;null!==
b;){if(Fh(b)){var c=b;break a}b=b.return}throw Error(k(160));}b=c.stateNode;switch(c.tag){case 5:var d=!1;break;case 3:b=b.containerInfo;d=!0;break;case 4:b=b.containerInfo;d=!0;break;default:throw Error(k(161));}c.effectTag&16&&(Wb(b,""),c.effectTag&=-17);a:b:for(c=a;;){for(;null===c.sibling;){if(null===c.return||Fh(c.return)){c=null;break a}c=c.return}c.sibling.return=c.return;for(c=c.sibling;5!==c.tag&&6!==c.tag&&18!==c.tag;){if(c.effectTag&2)continue b;if(null===c.child||4===c.tag)continue b;
else c.child.return=c,c=c.child}if(!(c.effectTag&2)){c=c.stateNode;break a}}d?Oe(a,c,b):Pe(a,c,b)}function Oe(a,b,c){var d=a.tag,e=5===d||6===d;if(e)a=e?a.stateNode:a.stateNode.instance,b?8===c.nodeType?c.parentNode.insertBefore(a,b):c.insertBefore(a,b):(8===c.nodeType?(b=c.parentNode,b.insertBefore(a,c)):(b=c,b.appendChild(a)),c=c._reactRootContainer,null!==c&&void 0!==c||null!==b.onclick||(b.onclick=uc));else if(4!==d&&(a=a.child,null!==a))for(Oe(a,b,c),a=a.sibling;null!==a;)Oe(a,b,c),a=a.sibling}
function Pe(a,b,c){var d=a.tag,e=5===d||6===d;if(e)a=e?a.stateNode:a.stateNode.instance,b?c.insertBefore(a,b):c.appendChild(a);else if(4!==d&&(a=a.child,null!==a))for(Pe(a,b,c),a=a.sibling;null!==a;)Pe(a,b,c),a=a.sibling}function Dh(a,b,c){for(var d=b,e=!1,f,g;;){if(!e){e=d.return;a:for(;;){if(null===e)throw Error(k(160));f=e.stateNode;switch(e.tag){case 5:g=!1;break a;case 3:f=f.containerInfo;g=!0;break a;case 4:f=f.containerInfo;g=!0;break a}e=e.return}e=!0}if(5===d.tag||6===d.tag){a:for(var h=
a,m=d,n=c,l=m;;)if(Ch(h,l,n),null!==l.child&&4!==l.tag)l.child.return=l,l=l.child;else{if(l===m)break a;for(;null===l.sibling;){if(null===l.return||l.return===m)break a;l=l.return}l.sibling.return=l.return;l=l.sibling}g?(h=f,m=d.stateNode,8===h.nodeType?h.parentNode.removeChild(m):h.removeChild(m)):f.removeChild(d.stateNode)}else if(4===d.tag){if(null!==d.child){f=d.stateNode.containerInfo;g=!0;d.child.return=d;d=d.child;continue}}else if(Ch(a,d,c),null!==d.child){d.child.return=d;d=d.child;continue}if(d===
b)break;for(;null===d.sibling;){if(null===d.return||d.return===b)return;d=d.return;4===d.tag&&(e=!1)}d.sibling.return=d.return;d=d.sibling}}function Qe(a,b){switch(b.tag){case 0:case 11:case 14:case 15:case 22:Ah(3,b);return;case 1:return;case 5:var c=b.stateNode;if(null!=c){var d=b.memoizedProps,e=null!==a?a.memoizedProps:d;a=b.type;var f=b.updateQueue;b.updateQueue=null;if(null!==f){c[vc]=d;"input"===a&&"radio"===d.type&&null!=d.name&&If(c,d);Vd(a,e);b=Vd(a,d);for(e=0;e<f.length;e+=2){var g=f[e],
h=f[e+1];"style"===g?gg(c,h):"dangerouslySetInnerHTML"===g?xh(c,h):"children"===g?Wb(c,h):xd(c,g,h,b)}switch(a){case "input":Dd(c,d);break;case "textarea":Lf(c,d);break;case "select":b=c._wrapperState.wasMultiple,c._wrapperState.wasMultiple=!!d.multiple,a=d.value,null!=a?hb(c,!!d.multiple,a,!1):b!==!!d.multiple&&(null!=d.defaultValue?hb(c,!!d.multiple,d.defaultValue,!0):hb(c,!!d.multiple,d.multiple?[]:"",!1))}}}return;case 6:if(null===b.stateNode)throw Error(k(162));b.stateNode.nodeValue=b.memoizedProps;
return;case 3:b=b.stateNode;b.hydrate&&(b.hydrate=!1,bg(b.containerInfo));return;case 12:return;case 13:c=b;null===b.memoizedState?d=!1:(d=!0,c=b.child,Re=Y());if(null!==c)a:for(a=c;;){if(5===a.tag)f=a.stateNode,d?(f=f.style,"function"===typeof f.setProperty?f.setProperty("display","none","important"):f.display="none"):(f=a.stateNode,e=a.memoizedProps.style,e=void 0!==e&&null!==e&&e.hasOwnProperty("display")?e.display:null,f.style.display=fg("display",e));else if(6===a.tag)a.stateNode.nodeValue=d?
"":a.memoizedProps;else if(13===a.tag&&null!==a.memoizedState&&null===a.memoizedState.dehydrated){f=a.child.sibling;f.return=a;a=f;continue}else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===c)break;for(;null===a.sibling;){if(null===a.return||a.return===c)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}Hh(b);return;case 19:Hh(b);return;case 17:return}throw Error(k(163));}function Hh(a){var b=a.updateQueue;if(null!==b){a.updateQueue=null;var c=a.stateNode;null===c&&(c=a.stateNode=
new pj);b.forEach(function(b){var d=qj.bind(null,a,b);c.has(b)||(c.add(b),b.then(d,d))})}}function Ih(a,b,c){c=Ea(c,null);c.tag=3;c.payload={element:null};var d=b.value;c.callback=function(){cd||(cd=!0,Se=d);Me(a,b)};return c}function Jh(a,b,c){c=Ea(c,null);c.tag=3;var d=a.type.getDerivedStateFromError;if("function"===typeof d){var e=b.value;c.payload=function(){Me(a,b);return d(e)}}var f=a.stateNode;null!==f&&"function"===typeof f.componentDidCatch&&(c.callback=function(){"function"!==typeof d&&
(null===La?La=new Set([this]):La.add(this),Me(a,b));var c=b.stack;this.componentDidCatch(b.value,{componentStack:null!==c?c:""})});return c}function ka(){return(p&(ca|ma))!==H?1073741821-(Y()/10|0):0!==dd?dd:dd=1073741821-(Y()/10|0)}function Va(a,b,c){b=b.mode;if(0===(b&2))return 1073741823;var d=Cc();if(0===(b&4))return 99===d?1073741823:1073741822;if((p&ca)!==H)return P;if(null!==c)a=Fc(a,c.timeoutMs|0||5E3,250);else switch(d){case 99:a=1073741823;break;case 98:a=Fc(a,150,100);break;case 97:case 96:a=
Fc(a,5E3,250);break;case 95:a=2;break;default:throw Error(k(326));}null!==U&&a===P&&--a;return a}function ed(a,b){a.expirationTime<b&&(a.expirationTime=b);var c=a.alternate;null!==c&&c.expirationTime<b&&(c.expirationTime=b);var d=a.return,e=null;if(null===d&&3===a.tag)e=a.stateNode;else for(;null!==d;){c=d.alternate;d.childExpirationTime<b&&(d.childExpirationTime=b);null!==c&&c.childExpirationTime<b&&(c.childExpirationTime=b);if(null===d.return&&3===d.tag){e=d.stateNode;break}d=d.return}null!==e&&
(U===e&&(Kc(b),F===bd&&Ya(e,P)),yh(e,b));return e}function fd(a){var b=a.lastExpiredTime;if(0!==b)return b;b=a.firstPendingTime;if(!Kh(a,b))return b;var c=a.lastPingedTime;a=a.nextKnownPendingLevel;a=c>a?c:a;return 2>=a&&b!==a?0:a}function V(a){if(0!==a.lastExpiredTime)a.callbackExpirationTime=1073741823,a.callbackPriority=99,a.callbackNode=Og(Te.bind(null,a));else{var b=fd(a),c=a.callbackNode;if(0===b)null!==c&&(a.callbackNode=null,a.callbackExpirationTime=0,a.callbackPriority=90);else{var d=ka();
1073741823===b?d=99:1===b||2===b?d=95:(d=10*(1073741821-b)-10*(1073741821-d),d=0>=d?99:250>=d?98:5250>=d?97:95);if(null!==c){var e=a.callbackPriority;if(a.callbackExpirationTime===b&&e>=d)return;c!==Qg&&Rg(c)}a.callbackExpirationTime=b;a.callbackPriority=d;b=1073741823===b?Og(Te.bind(null,a)):Ng(d,Lh.bind(null,a),{timeout:10*(1073741821-b)-Y()});a.callbackNode=b}}}function Lh(a,b){dd=0;if(b)return b=ka(),Ue(a,b),V(a),null;var c=fd(a);if(0!==c){b=a.callbackNode;if((p&(ca|ma))!==H)throw Error(k(327));
xb();a===U&&c===P||$a(a,c);if(null!==t){var d=p;p|=ca;var e=Mh();do try{rj();break}catch(h){Nh(a,h)}while(1);le();p=d;gd.current=e;if(F===hd)throw b=id,$a(a,c),Ya(a,c),V(a),b;if(null===t)switch(e=a.finishedWork=a.current.alternate,a.finishedExpirationTime=c,d=F,U=null,d){case Xa:case hd:throw Error(k(345));case Oh:Ue(a,2<c?2:c);break;case ad:Ya(a,c);d=a.lastSuspendedTime;c===d&&(a.nextKnownPendingLevel=Ve(e));if(1073741823===ta&&(e=Re+Ph-Y(),10<e)){if(jd){var f=a.lastPingedTime;if(0===f||f>=c){a.lastPingedTime=
c;$a(a,c);break}}f=fd(a);if(0!==f&&f!==c)break;if(0!==d&&d!==c){a.lastPingedTime=d;break}a.timeoutHandle=We(ab.bind(null,a),e);break}ab(a);break;case bd:Ya(a,c);d=a.lastSuspendedTime;c===d&&(a.nextKnownPendingLevel=Ve(e));if(jd&&(e=a.lastPingedTime,0===e||e>=c)){a.lastPingedTime=c;$a(a,c);break}e=fd(a);if(0!==e&&e!==c)break;if(0!==d&&d!==c){a.lastPingedTime=d;break}1073741823!==Yb?d=10*(1073741821-Yb)-Y():1073741823===ta?d=0:(d=10*(1073741821-ta)-5E3,e=Y(),c=10*(1073741821-c)-e,d=e-d,0>d&&(d=0),d=
(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3E3>d?3E3:4320>d?4320:1960*sj(d/1960))-d,c<d&&(d=c));if(10<d){a.timeoutHandle=We(ab.bind(null,a),d);break}ab(a);break;case Xe:if(1073741823!==ta&&null!==kd){f=ta;var g=kd;d=g.busyMinDurationMs|0;0>=d?d=0:(e=g.busyDelayMs|0,f=Y()-(10*(1073741821-f)-(g.timeoutMs|0||5E3)),d=f<=e?0:e+d-f);if(10<d){Ya(a,c);a.timeoutHandle=We(ab.bind(null,a),d);break}}ab(a);break;default:throw Error(k(329));}V(a);if(a.callbackNode===b)return Lh.bind(null,a)}}return null}function Te(a){var b=
a.lastExpiredTime;b=0!==b?b:1073741823;if((p&(ca|ma))!==H)throw Error(k(327));xb();a===U&&b===P||$a(a,b);if(null!==t){var c=p;p|=ca;var d=Mh();do try{tj();break}catch(e){Nh(a,e)}while(1);le();p=c;gd.current=d;if(F===hd)throw c=id,$a(a,b),Ya(a,b),V(a),c;if(null!==t)throw Error(k(261));a.finishedWork=a.current.alternate;a.finishedExpirationTime=b;U=null;ab(a);V(a)}return null}function uj(){if(null!==bb){var a=bb;bb=null;a.forEach(function(a,c){Ue(c,a);V(c)});ha()}}function Qh(a,b){var c=p;p|=1;try{return a(b)}finally{p=
c,p===H&&ha()}}function Rh(a,b){var c=p;p&=-2;p|=Ye;try{return a(b)}finally{p=c,p===H&&ha()}}function $a(a,b){a.finishedWork=null;a.finishedExpirationTime=0;var c=a.timeoutHandle;-1!==c&&(a.timeoutHandle=-1,vj(c));if(null!==t)for(c=t.return;null!==c;){var d=c;switch(d.tag){case 1:d=d.type.childContextTypes;null!==d&&void 0!==d&&(q(G),q(B));break;case 3:tb();q(G);q(B);break;case 5:te(d);break;case 4:tb();break;case 13:q(D);break;case 19:q(D);break;case 10:me(d)}c=c.return}U=a;t=Sa(a.current,null);
P=b;F=Xa;id=null;Yb=ta=1073741823;kd=null;Xb=0;jd=!1}function Nh(a,b){do{try{le();Sc.current=Tc;if(Uc)for(var c=z.memoizedState;null!==c;){var d=c.queue;null!==d&&(d.pending=null);c=c.next}Ia=0;J=K=z=null;Uc=!1;if(null===t||null===t.return)return F=hd,id=b,t=null;a:{var e=a,f=t.return,g=t,h=b;b=P;g.effectTag|=2048;g.firstEffect=g.lastEffect=null;if(null!==h&&"object"===typeof h&&"function"===typeof h.then){var m=h;if(0===(g.mode&2)){var n=g.alternate;n?(g.updateQueue=n.updateQueue,g.memoizedState=
n.memoizedState,g.expirationTime=n.expirationTime):(g.updateQueue=null,g.memoizedState=null)}var l=0!==(D.current&1),k=f;do{var p;if(p=13===k.tag){var q=k.memoizedState;if(null!==q)p=null!==q.dehydrated?!0:!1;else{var w=k.memoizedProps;p=void 0===w.fallback?!1:!0!==w.unstable_avoidThisFallback?!0:l?!1:!0}}if(p){var y=k.updateQueue;if(null===y){var r=new Set;r.add(m);k.updateQueue=r}else y.add(m);if(0===(k.mode&2)){k.effectTag|=64;g.effectTag&=-2981;if(1===g.tag)if(null===g.alternate)g.tag=17;else{var O=
Ea(1073741823,null);O.tag=Jc;Fa(g,O)}g.expirationTime=1073741823;break a}h=void 0;g=b;var v=e.pingCache;null===v?(v=e.pingCache=new wj,h=new Set,v.set(m,h)):(h=v.get(m),void 0===h&&(h=new Set,v.set(m,h)));if(!h.has(g)){h.add(g);var x=xj.bind(null,e,m,g);m.then(x,x)}k.effectTag|=4096;k.expirationTime=b;break a}k=k.return}while(null!==k);h=Error((na(g.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+
Bd(g))}F!==Xe&&(F=Oh);h=Le(h,g);k=f;do{switch(k.tag){case 3:m=h;k.effectTag|=4096;k.expirationTime=b;var A=Ih(k,m,b);Ug(k,A);break a;case 1:m=h;var u=k.type,B=k.stateNode;if(0===(k.effectTag&64)&&("function"===typeof u.getDerivedStateFromError||null!==B&&"function"===typeof B.componentDidCatch&&(null===La||!La.has(B)))){k.effectTag|=4096;k.expirationTime=b;var H=Jh(k,m,b);Ug(k,H);break a}}k=k.return}while(null!==k)}t=Sh(t)}catch(cj){b=cj;continue}break}while(1)}function Mh(a){a=gd.current;gd.current=
Tc;return null===a?Tc:a}function Vg(a,b){a<ta&&2<a&&(ta=a);null!==b&&a<Yb&&2<a&&(Yb=a,kd=b)}function Kc(a){a>Xb&&(Xb=a)}function tj(){for(;null!==t;)t=Th(t)}function rj(){for(;null!==t&&!yj();)t=Th(t)}function Th(a){var b=zj(a.alternate,a,P);a.memoizedProps=a.pendingProps;null===b&&(b=Sh(a));Uh.current=null;return b}function Sh(a){t=a;do{var b=t.alternate;a=t.return;if(0===(t.effectTag&2048)){b=hj(b,t,P);if(1===P||1!==t.childExpirationTime){for(var c=0,d=t.child;null!==d;){var e=d.expirationTime,
f=d.childExpirationTime;e>c&&(c=e);f>c&&(c=f);d=d.sibling}t.childExpirationTime=c}if(null!==b)return b;null!==a&&0===(a.effectTag&2048)&&(null===a.firstEffect&&(a.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==a.lastEffect&&(a.lastEffect.nextEffect=t.firstEffect),a.lastEffect=t.lastEffect),1<t.effectTag&&(null!==a.lastEffect?a.lastEffect.nextEffect=t:a.firstEffect=t,a.lastEffect=t))}else{b=lj(t);if(null!==b)return b.effectTag&=2047,b;null!==a&&(a.firstEffect=a.lastEffect=null,a.effectTag|=
2048)}b=t.sibling;if(null!==b)return b;t=a}while(null!==t);F===Xa&&(F=Xe);return null}function Ve(a){var b=a.expirationTime;a=a.childExpirationTime;return b>a?b:a}function ab(a){var b=Cc();Da(99,Aj.bind(null,a,b));return null}function Aj(a,b){do xb();while(null!==Zb);if((p&(ca|ma))!==H)throw Error(k(327));var c=a.finishedWork,d=a.finishedExpirationTime;if(null===c)return null;a.finishedWork=null;a.finishedExpirationTime=0;if(c===a.current)throw Error(k(177));a.callbackNode=null;a.callbackExpirationTime=
0;a.callbackPriority=90;a.nextKnownPendingLevel=0;var e=Ve(c);a.firstPendingTime=e;d<=a.lastSuspendedTime?a.firstSuspendedTime=a.lastSuspendedTime=a.nextKnownPendingLevel=0:d<=a.firstSuspendedTime&&(a.firstSuspendedTime=d-1);d<=a.lastPingedTime&&(a.lastPingedTime=0);d<=a.lastExpiredTime&&(a.lastExpiredTime=0);a===U&&(t=U=null,P=0);1<c.effectTag?null!==c.lastEffect?(c.lastEffect.nextEffect=c,e=c.firstEffect):e=c:e=c.firstEffect;if(null!==e){var f=p;p|=ma;Uh.current=null;Ze=tc;var g=kg();if(Xd(g)){if("selectionStart"in
g)var h={start:g.selectionStart,end:g.selectionEnd};else a:{h=(h=g.ownerDocument)&&h.defaultView||window;var m=h.getSelection&&h.getSelection();if(m&&0!==m.rangeCount){h=m.anchorNode;var n=m.anchorOffset,q=m.focusNode;m=m.focusOffset;try{h.nodeType,q.nodeType}catch(sb){h=null;break a}var ba=0,w=-1,y=-1,B=0,D=0,r=g,z=null;b:for(;;){for(var v;;){r!==h||0!==n&&3!==r.nodeType||(w=ba+n);r!==q||0!==m&&3!==r.nodeType||(y=ba+m);3===r.nodeType&&(ba+=r.nodeValue.length);if(null===(v=r.firstChild))break;z=r;
r=v}for(;;){if(r===g)break b;z===h&&++B===n&&(w=ba);z===q&&++D===m&&(y=ba);if(null!==(v=r.nextSibling))break;r=z;z=r.parentNode}r=v}h=-1===w||-1===y?null:{start:w,end:y}}else h=null}h=h||{start:0,end:0}}else h=null;$e={activeElementDetached:null,focusedElem:g,selectionRange:h};tc=!1;l=e;do try{Bj()}catch(sb){if(null===l)throw Error(k(330));Za(l,sb);l=l.nextEffect}while(null!==l);l=e;do try{for(g=a,h=b;null!==l;){var x=l.effectTag;x&16&&Wb(l.stateNode,"");if(x&128){var A=l.alternate;if(null!==A){var u=
A.ref;null!==u&&("function"===typeof u?u(null):u.current=null)}}switch(x&1038){case 2:Gh(l);l.effectTag&=-3;break;case 6:Gh(l);l.effectTag&=-3;Qe(l.alternate,l);break;case 1024:l.effectTag&=-1025;break;case 1028:l.effectTag&=-1025;Qe(l.alternate,l);break;case 4:Qe(l.alternate,l);break;case 8:n=l,Dh(g,n,h),Eh(n)}l=l.nextEffect}}catch(sb){if(null===l)throw Error(k(330));Za(l,sb);l=l.nextEffect}while(null!==l);u=$e;A=kg();x=u.focusedElem;h=u.selectionRange;if(A!==x&&x&&x.ownerDocument&&jg(x.ownerDocument.documentElement,
x)){null!==h&&Xd(x)&&(A=h.start,u=h.end,void 0===u&&(u=A),"selectionStart"in x?(x.selectionStart=A,x.selectionEnd=Math.min(u,x.value.length)):(u=(A=x.ownerDocument||document)&&A.defaultView||window,u.getSelection&&(u=u.getSelection(),n=x.textContent.length,g=Math.min(h.start,n),h=void 0===h.end?g:Math.min(h.end,n),!u.extend&&g>h&&(n=h,h=g,g=n),n=ig(x,g),q=ig(x,h),n&&q&&(1!==u.rangeCount||u.anchorNode!==n.node||u.anchorOffset!==n.offset||u.focusNode!==q.node||u.focusOffset!==q.offset)&&(A=A.createRange(),
A.setStart(n.node,n.offset),u.removeAllRanges(),g>h?(u.addRange(A),u.extend(q.node,q.offset)):(A.setEnd(q.node,q.offset),u.addRange(A))))));A=[];for(u=x;u=u.parentNode;)1===u.nodeType&&A.push({element:u,left:u.scrollLeft,top:u.scrollTop});"function"===typeof x.focus&&x.focus();for(x=0;x<A.length;x++)u=A[x],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}tc=!!Ze;$e=Ze=null;a.current=c;l=e;do try{for(x=a;null!==l;){var F=l.effectTag;F&36&&oj(x,l.alternate,l);if(F&128){A=void 0;var E=l.ref;if(null!==
E){var G=l.stateNode;switch(l.tag){case 5:A=G;break;default:A=G}"function"===typeof E?E(A):E.current=A}}l=l.nextEffect}}catch(sb){if(null===l)throw Error(k(330));Za(l,sb);l=l.nextEffect}while(null!==l);l=null;Cj();p=f}else a.current=c;if(ld)ld=!1,Zb=a,$b=b;else for(l=e;null!==l;)b=l.nextEffect,l.nextEffect=null,l=b;b=a.firstPendingTime;0===b&&(La=null);1073741823===b?a===af?ac++:(ac=0,af=a):ac=0;"function"===typeof bf&&bf(c.stateNode,d);V(a);if(cd)throw cd=!1,a=Se,Se=null,a;if((p&Ye)!==H)return null;
ha();return null}function Bj(){for(;null!==l;){var a=l.effectTag;0!==(a&256)&&nj(l.alternate,l);0===(a&512)||ld||(ld=!0,Ng(97,function(){xb();return null}));l=l.nextEffect}}function xb(){if(90!==$b){var a=97<$b?97:$b;$b=90;return Da(a,Dj)}}function Dj(){if(null===Zb)return!1;var a=Zb;Zb=null;if((p&(ca|ma))!==H)throw Error(k(331));var b=p;p|=ma;for(a=a.current.firstEffect;null!==a;){try{var c=a;if(0!==(c.effectTag&512))switch(c.tag){case 0:case 11:case 15:case 22:Ah(5,c),Bh(5,c)}}catch(d){if(null===
a)throw Error(k(330));Za(a,d)}c=a.nextEffect;a.nextEffect=null;a=c}p=b;ha();return!0}function Vh(a,b,c){b=Le(c,b);b=Ih(a,b,1073741823);Fa(a,b);a=ed(a,1073741823);null!==a&&V(a)}function Za(a,b){if(3===a.tag)Vh(a,a,b);else for(var c=a.return;null!==c;){if(3===c.tag){Vh(c,a,b);break}else if(1===c.tag){var d=c.stateNode;if("function"===typeof c.type.getDerivedStateFromError||"function"===typeof d.componentDidCatch&&(null===La||!La.has(d))){a=Le(b,a);a=Jh(c,a,1073741823);Fa(c,a);c=ed(c,1073741823);null!==
c&&V(c);break}}c=c.return}}function xj(a,b,c){var d=a.pingCache;null!==d&&d.delete(b);U===a&&P===c?F===bd||F===ad&&1073741823===ta&&Y()-Re<Ph?$a(a,P):jd=!0:Kh(a,c)&&(b=a.lastPingedTime,0!==b&&b<c||(a.lastPingedTime=c,V(a)))}function qj(a,b){var c=a.stateNode;null!==c&&c.delete(b);b=0;0===b&&(b=ka(),b=Va(b,a,null));a=ed(a,b);null!==a&&V(a)}function Ej(a){if("undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var b=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(b.isDisabled||!b.supportsFiber)return!0;try{var c=
b.inject(a);bf=function(a,e){try{b.onCommitFiberRoot(c,a,void 0,64===(a.current.effectTag&64))}catch(f){}};Ne=function(a){try{b.onCommitFiberUnmount(c,a)}catch(e){}}}catch(d){}return!0}function Fj(a,b,c,d){this.tag=a;this.key=c;this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null;this.index=0;this.ref=null;this.pendingProps=b;this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null;this.mode=d;this.effectTag=0;this.lastEffect=this.firstEffect=this.nextEffect=
null;this.childExpirationTime=this.expirationTime=0;this.alternate=null}function Ge(a){a=a.prototype;return!(!a||!a.isReactComponent)}function Gj(a){if("function"===typeof a)return Ge(a)?1:0;if(void 0!==a&&null!==a){a=a.$$typeof;if(a===zd)return 11;if(a===Ad)return 14}return 2}function Sa(a,b){var c=a.alternate;null===c?(c=la(a.tag,b,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=b,c.effectTag=0,c.nextEffect=null,c.firstEffect=
null,c.lastEffect=null);c.childExpirationTime=a.childExpirationTime;c.expirationTime=a.expirationTime;c.child=a.child;c.memoizedProps=a.memoizedProps;c.memoizedState=a.memoizedState;c.updateQueue=a.updateQueue;b=a.dependencies;c.dependencies=null===b?null:{expirationTime:b.expirationTime,firstContext:b.firstContext,responders:b.responders};c.sibling=a.sibling;c.index=a.index;c.ref=a.ref;return c}function Oc(a,b,c,d,e,f){var g=2;d=a;if("function"===typeof a)Ge(a)&&(g=1);else if("string"===typeof a)g=
5;else a:switch(a){case Ma:return Ha(c.children,e,f,b);case Hj:g=8;e|=7;break;case Af:g=8;e|=1;break;case kc:return a=la(12,c,b,e|8),a.elementType=kc,a.type=kc,a.expirationTime=f,a;case lc:return a=la(13,c,b,e),a.type=lc,a.elementType=lc,a.expirationTime=f,a;case yd:return a=la(19,c,b,e),a.elementType=yd,a.expirationTime=f,a;default:if("object"===typeof a&&null!==a)switch(a.$$typeof){case Cf:g=10;break a;case Bf:g=9;break a;case zd:g=11;break a;case Ad:g=14;break a;case Ef:g=16;d=null;break a;case Df:g=
22;break a}throw Error(k(130,null==a?a:typeof a,""));}b=la(g,c,b,e);b.elementType=a;b.type=d;b.expirationTime=f;return b}function Ha(a,b,c,d){a=la(7,a,d,b);a.expirationTime=c;return a}function qe(a,b,c){a=la(6,a,null,b);a.expirationTime=c;return a}function re(a,b,c){b=la(4,null!==a.children?a.children:[],a.key,b);b.expirationTime=c;b.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation};return b}function Ij(a,b,c){this.tag=b;this.current=null;this.containerInfo=
a;this.pingCache=this.pendingChildren=null;this.finishedExpirationTime=0;this.finishedWork=null;this.timeoutHandle=-1;this.pendingContext=this.context=null;this.hydrate=c;this.callbackNode=null;this.callbackPriority=90;this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function Kh(a,b){var c=a.firstSuspendedTime;a=a.lastSuspendedTime;return 0!==c&&c>=b&&a<=b}function Ya(a,b){var c=a.firstSuspendedTime,d=a.lastSuspendedTime;
c<b&&(a.firstSuspendedTime=b);if(d>b||0===c)a.lastSuspendedTime=b;b<=a.lastPingedTime&&(a.lastPingedTime=0);b<=a.lastExpiredTime&&(a.lastExpiredTime=0)}function yh(a,b){b>a.firstPendingTime&&(a.firstPendingTime=b);var c=a.firstSuspendedTime;0!==c&&(b>=c?a.firstSuspendedTime=a.lastSuspendedTime=a.nextKnownPendingLevel=0:b>=a.lastSuspendedTime&&(a.lastSuspendedTime=b+1),b>a.nextKnownPendingLevel&&(a.nextKnownPendingLevel=b))}function Ue(a,b){var c=a.lastExpiredTime;if(0===c||c>b)a.lastExpiredTime=b}
function md(a,b,c,d){var e=b.current,f=ka(),g=Vb.suspense;f=Va(f,e,g);a:if(c){c=c._reactInternalFiber;b:{if(Na(c)!==c||1!==c.tag)throw Error(k(170));var h=c;do{switch(h.tag){case 3:h=h.stateNode.context;break b;case 1:if(N(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break b}}h=h.return}while(null!==h);throw Error(k(171));}if(1===c.tag){var m=c.type;if(N(m)){c=Gg(c,m,h);break a}}c=h}else c=Ca;null===b.context?b.context=c:b.pendingContext=c;b=Ea(f,g);b.payload={element:a};d=void 0===
d?null:d;null!==d&&(b.callback=d);Fa(e,b);Ja(e,f);return f}function cf(a){a=a.current;if(!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function Wh(a,b){a=a.memoizedState;null!==a&&null!==a.dehydrated&&a.retryTime<b&&(a.retryTime=b)}function df(a,b){Wh(a,b);(a=a.alternate)&&Wh(a,b)}function ef(a,b,c){c=null!=c&&!0===c.hydrate;var d=new Ij(a,b,c),e=la(3,null,null,2===b?7:1===b?3:0);d.current=e;e.stateNode=d;ne(e);a[Lb]=d.current;c&&0!==b&&
xi(a,9===a.nodeType?a:a.ownerDocument);this._internalRoot=d}function bc(a){return!(!a||1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType&&(8!==a.nodeType||" react-mount-point-unstable "!==a.nodeValue))}function Jj(a,b){b||(b=a?9===a.nodeType?a.documentElement:a.firstChild:null,b=!(!b||1!==b.nodeType||!b.hasAttribute("data-reactroot")));if(!b)for(var c;c=a.lastChild;)a.removeChild(c);return new ef(a,0,b?{hydrate:!0}:void 0)}function nd(a,b,c,d,e){var f=c._reactRootContainer;if(f){var g=f._internalRoot;
if("function"===typeof e){var h=e;e=function(){var a=cf(g);h.call(a)}}md(b,g,a,e)}else{f=c._reactRootContainer=Jj(c,d);g=f._internalRoot;if("function"===typeof e){var m=e;e=function(){var a=cf(g);m.call(a)}}Rh(function(){md(b,g,a,e)})}return cf(g)}function Kj(a,b,c){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:gb,key:null==d?null:""+d,children:a,containerInfo:b,implementation:c}}function Xh(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;
if(!bc(b))throw Error(k(200));return Kj(a,b,null,c)}if(!ea)throw Error(k(227));var ki=function(a,b,c,d,e,f,g,h,m){var n=Array.prototype.slice.call(arguments,3);try{b.apply(c,n)}catch(C){this.onError(C)}},yb=!1,gc=null,hc=!1,pd=null,li={onError:function(a){yb=!0;gc=a}},td=null,rf=null,mf=null,ic=null,cb={},jc=[],qd={},db={},rd={},wa=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),M=ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.assign,
sd=null,eb=null,fb=null,ee=function(a,b){return a(b)},eg=function(a,b,c,d,e){return a(b,c,d,e)},vd=function(){},vf=ee,Oa=!1,wd=!1,Z=ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.Scheduler,Lj=Z.unstable_cancelCallback,ff=Z.unstable_now,$f=Z.unstable_scheduleCallback,Mj=Z.unstable_shouldYield,Yh=Z.unstable_requestPaint,Pd=Z.unstable_runWithPriority,Nj=Z.unstable_getCurrentPriorityLevel,Oj=Z.unstable_ImmediatePriority,Zh=Z.unstable_UserBlockingPriority,ag=Z.unstable_NormalPriority,Pj=Z.unstable_LowPriority,
Qj=Z.unstable_IdlePriority,oi=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wf=Object.prototype.hasOwnProperty,yf={},xf={},E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){E[a]=
new L(a,0,!1,a,null,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var b=a[0];E[b]=new L(b,1,!1,a[1],null,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(a){E[a]=new L(a,2,!1,a.toLowerCase(),null,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){E[a]=new L(a,2,!1,a,null,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){E[a]=
new L(a,3,!1,a.toLowerCase(),null,!1)});["checked","multiple","muted","selected"].forEach(function(a){E[a]=new L(a,3,!0,a,null,!1)});["capture","download"].forEach(function(a){E[a]=new L(a,4,!1,a,null,!1)});["cols","rows","size","span"].forEach(function(a){E[a]=new L(a,6,!1,a,null,!1)});["rowSpan","start"].forEach(function(a){E[a]=new L(a,5,!1,a.toLowerCase(),null,!1)});var gf=/[\-:]([a-z])/g,hf=function(a){return a[1].toUpperCase()};"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var b=
a.replace(gf,hf);E[b]=new L(b,1,!1,a,null,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var b=a.replace(gf,hf);E[b]=new L(b,1,!1,a,"http://www.w3.org/1999/xlink",!1)});["xml:base","xml:lang","xml:space"].forEach(function(a){var b=a.replace(gf,hf);E[b]=new L(b,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1)});["tabIndex","crossOrigin"].forEach(function(a){E[a]=new L(a,1,!1,a.toLowerCase(),null,!1)});E.xlinkHref=new L("xlinkHref",1,
!1,"xlink:href","http://www.w3.org/1999/xlink",!0);["src","href","action","formAction"].forEach(function(a){E[a]=new L(a,1,!1,a.toLowerCase(),null,!0)});var da=ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;da.hasOwnProperty("ReactCurrentDispatcher")||(da.ReactCurrentDispatcher={current:null});da.hasOwnProperty("ReactCurrentBatchConfig")||(da.ReactCurrentBatchConfig={suspense:null});var si=/^(.*)[\\\/]/,Q="function"===typeof Symbol&&Symbol.for,Pc=Q?Symbol.for("react.element"):60103,gb=Q?Symbol.for("react.portal"):
60106,Ma=Q?Symbol.for("react.fragment"):60107,Af=Q?Symbol.for("react.strict_mode"):60108,kc=Q?Symbol.for("react.profiler"):60114,Cf=Q?Symbol.for("react.provider"):60109,Bf=Q?Symbol.for("react.context"):60110,Hj=Q?Symbol.for("react.concurrent_mode"):60111,zd=Q?Symbol.for("react.forward_ref"):60112,lc=Q?Symbol.for("react.suspense"):60113,yd=Q?Symbol.for("react.suspense_list"):60120,Ad=Q?Symbol.for("react.memo"):60115,Ef=Q?Symbol.for("react.lazy"):60116,Df=Q?Symbol.for("react.block"):60121,zf="function"===
typeof Symbol&&Symbol.iterator,od,xh=function(a){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(b,c,d,e){MSApp.execUnsafeLocalFunction(function(){return a(b,c,d,e)})}:a}(function(a,b){if("http://www.w3.org/2000/svg"!==a.namespaceURI||"innerHTML"in a)a.innerHTML=b;else{od=od||document.createElement("div");od.innerHTML="<svg>"+b.valueOf().toString()+"</svg>";for(b=od.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;b.firstChild;)a.appendChild(b.firstChild)}}),Wb=function(a,
b){if(b){var c=a.firstChild;if(c&&c===a.lastChild&&3===c.nodeType){c.nodeValue=b;return}}a.textContent=b},ib={animationend:nc("Animation","AnimationEnd"),animationiteration:nc("Animation","AnimationIteration"),animationstart:nc("Animation","AnimationStart"),transitionend:nc("Transition","TransitionEnd")},Id={},Of={};wa&&(Of=document.createElement("div").style,"AnimationEvent"in window||(delete ib.animationend.animation,delete ib.animationiteration.animation,delete ib.animationstart.animation),"TransitionEvent"in
window||delete ib.transitionend.transition);var $h=oc("animationend"),ai=oc("animationiteration"),bi=oc("animationstart"),ci=oc("transitionend"),Db="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pf=new ("function"===typeof WeakMap?WeakMap:Map),Ab=null,wi=function(a){if(a){var b=a._dispatchListeners,c=a._dispatchInstances;
if(Array.isArray(b))for(var d=0;d<b.length&&!a.isPropagationStopped();d++)lf(a,b[d],c[d]);else b&&lf(a,b,c);a._dispatchListeners=null;a._dispatchInstances=null;a.isPersistent()||a.constructor.release(a)}},qc=[],Rd=!1,fa=[],xa=null,ya=null,za=null,Eb=new Map,Fb=new Map,Jb=[],Nd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),
yi="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" "),dg={},cg=new Map,Td=new Map,Rj=["abort","abort",$h,"animationEnd",ai,"animationIteration",bi,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata",
"loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",ci,"transitionEnd","waiting","waiting"];Sd("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),
0);Sd("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1);Sd(Rj,2);(function(a,b){for(var c=0;c<a.length;c++)Td.set(a[c],b)})("change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),0);var Hi=Zh,Gi=Pd,tc=!0,Kb={animationIterationCount:!0,
borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,
strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sj=["Webkit","ms","Moz","O"];Object.keys(Kb).forEach(function(a){Sj.forEach(function(b){b=b+a.charAt(0).toUpperCase()+a.substring(1);Kb[b]=Kb[a]})});var Ii=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),ng="$",og="/$",$d="$?",Zd="$!",Ze=null,$e=null,We="function"===typeof setTimeout?setTimeout:void 0,vj="function"===
typeof clearTimeout?clearTimeout:void 0,jf=Math.random().toString(36).slice(2),Aa="__reactInternalInstance$"+jf,vc="__reactEventHandlers$"+jf,Lb="__reactContainere$"+jf,Ba=null,ce=null,wc=null;M(R.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():"unknown"!==typeof a.returnValue&&(a.returnValue=!1),this.isDefaultPrevented=xc)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():"unknown"!==
typeof a.cancelBubble&&(a.cancelBubble=!0),this.isPropagationStopped=xc)},persist:function(){this.isPersistent=xc},isPersistent:yc,destructor:function(){var a=this.constructor.Interface,b;for(b in a)this[b]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null;this.isPropagationStopped=this.isDefaultPrevented=yc;this._dispatchInstances=this._dispatchListeners=null}});R.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(a){return a.timeStamp||
Date.now()},defaultPrevented:null,isTrusted:null};R.extend=function(a){function b(){return c.apply(this,arguments)}var c=this,d=function(){};d.prototype=c.prototype;d=new d;M(d,b.prototype);b.prototype=d;b.prototype.constructor=b;b.Interface=M({},c.Interface,a);b.extend=c.extend;sg(b);return b};sg(R);var Tj=R.extend({data:null}),Uj=R.extend({data:null}),Ni=[9,13,27,32],de=wa&&"CompositionEvent"in window,cc=null;wa&&"documentMode"in document&&(cc=document.documentMode);var Vj=wa&&"TextEvent"in window&&
!cc,xg=wa&&(!de||cc&&8<cc&&11>=cc),wg=String.fromCharCode(32),ua={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},
dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},vg=!1,mb=!1,Wj={eventTypes:ua,extractEvents:function(a,b,c,d,e){var f;if(de)b:{switch(a){case "compositionstart":var g=ua.compositionStart;break b;case "compositionend":g=ua.compositionEnd;break b;case "compositionupdate":g=
ua.compositionUpdate;break b}g=void 0}else mb?tg(a,c)&&(g=ua.compositionEnd):"keydown"===a&&229===c.keyCode&&(g=ua.compositionStart);g?(xg&&"ko"!==c.locale&&(mb||g!==ua.compositionStart?g===ua.compositionEnd&&mb&&(f=rg()):(Ba=d,ce="value"in Ba?Ba.value:Ba.textContent,mb=!0)),e=Tj.getPooled(g,b,c,d),f?e.data=f:(f=ug(c),null!==f&&(e.data=f)),lb(e),f=e):f=null;(a=Vj?Oi(a,c):Pi(a,c))?(b=Uj.getPooled(ua.beforeInput,b,c,d),b.data=a,lb(b)):b=null;return null===f?b:null===b?f:[f,b]}},Qi={color:!0,date:!0,
datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0},Ag={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}},Mb=null,Nb=null,kf=!1;wa&&(kf=Tf("input")&&(!document.documentMode||9<document.documentMode));var Xj={eventTypes:Ag,_isInputEventSupported:kf,extractEvents:function(a,b,c,d,e){e=b?Pa(b):window;var f=
e.nodeName&&e.nodeName.toLowerCase();if("select"===f||"input"===f&&"file"===e.type)var g=Si;else if(yg(e))if(kf)g=Wi;else{g=Ui;var h=Ti}else(f=e.nodeName)&&"input"===f.toLowerCase()&&("checkbox"===e.type||"radio"===e.type)&&(g=Vi);if(g&&(g=g(a,b)))return zg(g,c,d);h&&h(a,e,b);"blur"===a&&(a=e._wrapperState)&&a.controlled&&"number"===e.type&&Ed(e,"number",e.value)}},dc=R.extend({view:null,detail:null}),Yi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"},di=0,ei=0,fi=!1,gi=!1,ec=dc.extend({screenX:null,
screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:fe,button:null,buttons:null,relatedTarget:function(a){return a.relatedTarget||(a.fromElement===a.srcElement?a.toElement:a.fromElement)},movementX:function(a){if("movementX"in a)return a.movementX;var b=di;di=a.screenX;return fi?"mousemove"===a.type?a.screenX-b:0:(fi=!0,0)},movementY:function(a){if("movementY"in a)return a.movementY;var b=ei;ei=a.screenY;return gi?"mousemove"===
a.type?a.screenY-b:0:(gi=!0,0)}}),hi=ec.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),fc={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout",
"pointerover"]}},Yj={eventTypes:fc,extractEvents:function(a,b,c,d,e){var f="mouseover"===a||"pointerover"===a,g="mouseout"===a||"pointerout"===a;if(f&&0===(e&32)&&(c.relatedTarget||c.fromElement)||!g&&!f)return null;f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window;if(g){if(g=b,b=(b=c.relatedTarget||c.toElement)?Bb(b):null,null!==b){var h=Na(b);if(b!==h||5!==b.tag&&6!==b.tag)b=null}}else g=null;if(g===b)return null;if("mouseout"===a||"mouseover"===a){var m=ec;var n=fc.mouseLeave;
var l=fc.mouseEnter;var k="mouse"}else if("pointerout"===a||"pointerover"===a)m=hi,n=fc.pointerLeave,l=fc.pointerEnter,k="pointer";a=null==g?f:Pa(g);f=null==b?f:Pa(b);n=m.getPooled(n,g,c,d);n.type=k+"leave";n.target=a;n.relatedTarget=f;c=m.getPooled(l,b,c,d);c.type=k+"enter";c.target=f;c.relatedTarget=a;d=g;k=b;if(d&&k)a:{m=d;l=k;g=0;for(a=m;a;a=pa(a))g++;a=0;for(b=l;b;b=pa(b))a++;for(;0<g-a;)m=pa(m),g--;for(;0<a-g;)l=pa(l),a--;for(;g--;){if(m===l||m===l.alternate)break a;m=pa(m);l=pa(l)}m=null}else m=
null;l=m;for(m=[];d&&d!==l;){g=d.alternate;if(null!==g&&g===l)break;m.push(d);d=pa(d)}for(d=[];k&&k!==l;){g=k.alternate;if(null!==g&&g===l)break;d.push(k);k=pa(k)}for(k=0;k<m.length;k++)be(m[k],"bubbled",n);for(k=d.length;0<k--;)be(d[k],"captured",c);return 0===(e&64)?[n]:[n,c]}},Qa="function"===typeof Object.is?Object.is:Zi,$i=Object.prototype.hasOwnProperty,Zj=wa&&"documentMode"in document&&11>=document.documentMode,Eg={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},
dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},nb=null,he=null,Pb=null,ge=!1,ak={eventTypes:Eg,extractEvents:function(a,b,c,d,e,f){e=f||(d.window===d?d.document:9===d.nodeType?d:d.ownerDocument);if(!(f=!e)){a:{e=Jd(e);f=rd.onSelect;for(var g=0;g<f.length;g++)if(!e.has(f[g])){e=!1;break a}e=!0}f=!e}if(f)return null;e=b?Pa(b):window;switch(a){case "focus":if(yg(e)||"true"===e.contentEditable)nb=e,he=b,Pb=null;break;case "blur":Pb=he=nb=null;
break;case "mousedown":ge=!0;break;case "contextmenu":case "mouseup":case "dragend":return ge=!1,Dg(c,d);case "selectionchange":if(Zj)break;case "keydown":case "keyup":return Dg(c,d)}return null}},bk=R.extend({animationName:null,elapsedTime:null,pseudoElement:null}),ck=R.extend({clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),dk=dc.extend({relatedTarget:null}),ek={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",
Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",
224:"Meta"},gk=dc.extend({key:function(a){if(a.key){var b=ek[a.key]||a.key;if("Unidentified"!==b)return b}return"keypress"===a.type?(a=Ac(a),13===a?"Enter":String.fromCharCode(a)):"keydown"===a.type||"keyup"===a.type?fk[a.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:fe,charCode:function(a){return"keypress"===a.type?Ac(a):0},keyCode:function(a){return"keydown"===a.type||"keyup"===a.type?a.keyCode:0},which:function(a){return"keypress"===
a.type?Ac(a):"keydown"===a.type||"keyup"===a.type?a.keyCode:0}}),hk=ec.extend({dataTransfer:null}),ik=dc.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:fe}),jk=R.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),kk=ec.extend({deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?
-a.wheelDelta:0},deltaZ:null,deltaMode:null}),lk={eventTypes:dg,extractEvents:function(a,b,c,d,e){e=cg.get(a);if(!e)return null;switch(a){case "keypress":if(0===Ac(c))return null;case "keydown":case "keyup":a=gk;break;case "blur":case "focus":a=dk;break;case "click":if(2===c.button)return null;case "auxclick":case "dblclick":case "mousedown":case "mousemove":case "mouseup":case "mouseout":case "mouseover":case "contextmenu":a=ec;break;case "drag":case "dragend":case "dragenter":case "dragexit":case "dragleave":case "dragover":case "dragstart":case "drop":a=
hk;break;case "touchcancel":case "touchend":case "touchmove":case "touchstart":a=ik;break;case $h:case ai:case bi:a=bk;break;case ci:a=jk;break;case "scroll":a=dc;break;case "wheel":a=kk;break;case "copy":case "cut":case "paste":a=ck;break;case "gotpointercapture":case "lostpointercapture":case "pointercancel":case "pointerdown":case "pointermove":case "pointerout":case "pointerover":case "pointerup":a=hi;break;default:a=R}b=a.getPooled(e,b,c,d);lb(b);return b}};(function(a){if(ic)throw Error(k(101));
ic=Array.prototype.slice.call(a);nf()})("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" "));(function(a,b,c){td=a;rf=b;mf=c})(ae,Hb,Pa);pf({SimpleEventPlugin:lk,EnterLeaveEventPlugin:Yj,ChangeEventPlugin:Xj,SelectEventPlugin:ak,BeforeInputEventPlugin:Wj});var ie=[],ob=-1,Ca={},B={current:Ca},G={current:!1},Ra=Ca,bj=Pd,je=$f,Rg=Lj,aj=Nj,Dc=Oj,Ig=Zh,Jg=ag,Kg=Pj,Lg=Qj,Qg={},yj=Mj,Cj=void 0!==Yh?Yh:function(){},qa=null,
Ec=null,ke=!1,ii=ff(),Y=1E4>ii?ff:function(){return ff()-ii},Ic={current:null},Hc=null,qb=null,Gc=null,Tg=0,Jc=2,Ga=!1,Vb=da.ReactCurrentBatchConfig,$g=(new ea.Component).refs,Mc={isMounted:function(a){return(a=a._reactInternalFiber)?Na(a)===a:!1},enqueueSetState:function(a,b,c){a=a._reactInternalFiber;var d=ka(),e=Vb.suspense;d=Va(d,a,e);e=Ea(d,e);e.payload=b;void 0!==c&&null!==c&&(e.callback=c);Fa(a,e);Ja(a,d)},enqueueReplaceState:function(a,b,c){a=a._reactInternalFiber;var d=ka(),e=Vb.suspense;
d=Va(d,a,e);e=Ea(d,e);e.tag=1;e.payload=b;void 0!==c&&null!==c&&(e.callback=c);Fa(a,e);Ja(a,d)},enqueueForceUpdate:function(a,b){a=a._reactInternalFiber;var c=ka(),d=Vb.suspense;c=Va(c,a,d);d=Ea(c,d);d.tag=Jc;void 0!==b&&null!==b&&(d.callback=b);Fa(a,d);Ja(a,c)}},Qc=Array.isArray,wb=ah(!0),Fe=ah(!1),Sb={},ja={current:Sb},Ub={current:Sb},Tb={current:Sb},D={current:0},Sc=da.ReactCurrentDispatcher,X=da.ReactCurrentBatchConfig,Ia=0,z=null,K=null,J=null,Uc=!1,Tc={readContext:W,useCallback:S,useContext:S,
useEffect:S,useImperativeHandle:S,useLayoutEffect:S,useMemo:S,useReducer:S,useRef:S,useState:S,useDebugValue:S,useResponder:S,useDeferredValue:S,useTransition:S},dj={readContext:W,useCallback:ih,useContext:W,useEffect:eh,useImperativeHandle:function(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return ze(4,2,gh.bind(null,b,a),c)},useLayoutEffect:function(a,b){return ze(4,2,a,b)},useMemo:function(a,b){var c=ub();b=void 0===b?null:b;a=a();c.memoizedState=[a,b];return a},useReducer:function(a,b,c){var d=
ub();b=void 0!==c?c(b):b;d.memoizedState=d.baseState=b;a=d.queue={pending:null,dispatch:null,lastRenderedReducer:a,lastRenderedState:b};a=a.dispatch=ch.bind(null,z,a);return[d.memoizedState,a]},useRef:function(a){var b=ub();a={current:a};return b.memoizedState=a},useState:xe,useDebugValue:Be,useResponder:ue,useDeferredValue:function(a,b){var c=xe(a),d=c[0],e=c[1];eh(function(){var c=X.suspense;X.suspense=void 0===b?null:b;try{e(a)}finally{X.suspense=c}},[a,b]);return d},useTransition:function(a){var b=
xe(!1),c=b[0];b=b[1];return[ih(Ce.bind(null,b,a),[b,a]),c]}},ej={readContext:W,useCallback:Yc,useContext:W,useEffect:Xc,useImperativeHandle:hh,useLayoutEffect:fh,useMemo:jh,useReducer:Vc,useRef:dh,useState:function(a){return Vc(Ua)},useDebugValue:Be,useResponder:ue,useDeferredValue:function(a,b){var c=Vc(Ua),d=c[0],e=c[1];Xc(function(){var c=X.suspense;X.suspense=void 0===b?null:b;try{e(a)}finally{X.suspense=c}},[a,b]);return d},useTransition:function(a){var b=Vc(Ua),c=b[0];b=b[1];return[Yc(Ce.bind(null,
b,a),[b,a]),c]}},fj={readContext:W,useCallback:Yc,useContext:W,useEffect:Xc,useImperativeHandle:hh,useLayoutEffect:fh,useMemo:jh,useReducer:Wc,useRef:dh,useState:function(a){return Wc(Ua)},useDebugValue:Be,useResponder:ue,useDeferredValue:function(a,b){var c=Wc(Ua),d=c[0],e=c[1];Xc(function(){var c=X.suspense;X.suspense=void 0===b?null:b;try{e(a)}finally{X.suspense=c}},[a,b]);return d},useTransition:function(a){var b=Wc(Ua),c=b[0];b=b[1];return[Yc(Ce.bind(null,b,a),[b,a]),c]}},ra=null,Ka=null,Wa=
!1,gj=da.ReactCurrentOwner,ia=!1,Je={dehydrated:null,retryTime:0};var jj=function(a,b,c,d){for(c=b.child;null!==c;){if(5===c.tag||6===c.tag)a.appendChild(c.stateNode);else if(4!==c.tag&&null!==c.child){c.child.return=c;c=c.child;continue}if(c===b)break;for(;null===c.sibling;){if(null===c.return||c.return===b)return;c=c.return}c.sibling.return=c.return;c=c.sibling}};var wh=function(a){};var ij=function(a,b,c,d,e){var f=a.memoizedProps;if(f!==d){var g=b.stateNode;Ta(ja.current);a=null;switch(c){case "input":f=
Cd(g,f);d=Cd(g,d);a=[];break;case "option":f=Fd(g,f);d=Fd(g,d);a=[];break;case "select":f=M({},f,{value:void 0});d=M({},d,{value:void 0});a=[];break;case "textarea":f=Gd(g,f);d=Gd(g,d);a=[];break;default:"function"!==typeof f.onClick&&"function"===typeof d.onClick&&(g.onclick=uc)}Ud(c,d);var h,m;c=null;for(h in f)if(!d.hasOwnProperty(h)&&f.hasOwnProperty(h)&&null!=f[h])if("style"===h)for(m in g=f[h],g)g.hasOwnProperty(m)&&(c||(c={}),c[m]="");else"dangerouslySetInnerHTML"!==h&&"children"!==h&&"suppressContentEditableWarning"!==
h&&"suppressHydrationWarning"!==h&&"autoFocus"!==h&&(db.hasOwnProperty(h)?a||(a=[]):(a=a||[]).push(h,null));for(h in d){var k=d[h];g=null!=f?f[h]:void 0;if(d.hasOwnProperty(h)&&k!==g&&(null!=k||null!=g))if("style"===h)if(g){for(m in g)!g.hasOwnProperty(m)||k&&k.hasOwnProperty(m)||(c||(c={}),c[m]="");for(m in k)k.hasOwnProperty(m)&&g[m]!==k[m]&&(c||(c={}),c[m]=k[m])}else c||(a||(a=[]),a.push(h,c)),c=k;else"dangerouslySetInnerHTML"===h?(k=k?k.__html:void 0,g=g?g.__html:void 0,null!=k&&g!==k&&(a=a||
[]).push(h,k)):"children"===h?g===k||"string"!==typeof k&&"number"!==typeof k||(a=a||[]).push(h,""+k):"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&(db.hasOwnProperty(h)?(null!=k&&oa(e,h),a||g===k||(a=[])):(a=a||[]).push(h,k))}c&&(a=a||[]).push("style",c);e=a;if(b.updateQueue=e)b.effectTag|=4}};var kj=function(a,b,c,d){c!==d&&(b.effectTag|=4)};var pj="function"===typeof WeakSet?WeakSet:Set,wj="function"===typeof WeakMap?WeakMap:Map,sj=Math.ceil,gd=da.ReactCurrentDispatcher,
Uh=da.ReactCurrentOwner,H=0,Ye=8,ca=16,ma=32,Xa=0,hd=1,Oh=2,ad=3,bd=4,Xe=5,p=H,U=null,t=null,P=0,F=Xa,id=null,ta=1073741823,Yb=1073741823,kd=null,Xb=0,jd=!1,Re=0,Ph=500,l=null,cd=!1,Se=null,La=null,ld=!1,Zb=null,$b=90,bb=null,ac=0,af=null,dd=0,Ja=function(a,b){if(50<ac)throw ac=0,af=null,Error(k(185));a=ed(a,b);if(null!==a){var c=Cc();1073741823===b?(p&Ye)!==H&&(p&(ca|ma))===H?Te(a):(V(a),p===H&&ha()):V(a);(p&4)===H||98!==c&&99!==c||(null===bb?bb=new Map([[a,b]]):(c=bb.get(a),(void 0===c||c>b)&&bb.set(a,
b)))}};var zj=function(a,b,c){var d=b.expirationTime;if(null!==a){var e=b.pendingProps;if(a.memoizedProps!==e||G.current)ia=!0;else{if(d<c){ia=!1;switch(b.tag){case 3:sh(b);Ee();break;case 5:bh(b);if(b.mode&4&&1!==c&&e.hidden)return b.expirationTime=b.childExpirationTime=1,null;break;case 1:N(b.type)&&Bc(b);break;case 4:se(b,b.stateNode.containerInfo);break;case 10:d=b.memoizedProps.value;e=b.type._context;y(Ic,e._currentValue);e._currentValue=d;break;case 13:if(null!==b.memoizedState){d=b.child.childExpirationTime;
if(0!==d&&d>=c)return th(a,b,c);y(D,D.current&1);b=sa(a,b,c);return null!==b?b.sibling:null}y(D,D.current&1);break;case 19:d=b.childExpirationTime>=c;if(0!==(a.effectTag&64)){if(d)return vh(a,b,c);b.effectTag|=64}e=b.memoizedState;null!==e&&(e.rendering=null,e.tail=null);y(D,D.current);if(!d)return null}return sa(a,b,c)}ia=!1}}else ia=!1;b.expirationTime=0;switch(b.tag){case 2:d=b.type;null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2);a=b.pendingProps;e=pb(b,B.current);rb(b,c);e=we(null,
b,d,a,e,c);b.effectTag|=1;if("object"===typeof e&&null!==e&&"function"===typeof e.render&&void 0===e.$$typeof){b.tag=1;b.memoizedState=null;b.updateQueue=null;if(N(d)){var f=!0;Bc(b)}else f=!1;b.memoizedState=null!==e.state&&void 0!==e.state?e.state:null;ne(b);var g=d.getDerivedStateFromProps;"function"===typeof g&&Lc(b,d,g,a);e.updater=Mc;b.stateNode=e;e._reactInternalFiber=b;pe(b,d,a,c);b=Ie(null,b,d,!0,f,c)}else b.tag=0,T(null,b,e,c),b=b.child;return b;case 16:a:{e=b.elementType;null!==a&&(a.alternate=
null,b.alternate=null,b.effectTag|=2);a=b.pendingProps;ri(e);if(1!==e._status)throw e._result;e=e._result;b.type=e;f=b.tag=Gj(e);a=aa(e,a);switch(f){case 0:b=He(null,b,e,a,c);break a;case 1:b=rh(null,b,e,a,c);break a;case 11:b=nh(null,b,e,a,c);break a;case 14:b=oh(null,b,e,aa(e.type,a),d,c);break a}throw Error(k(306,e,""));}return b;case 0:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),He(a,b,d,e,c);case 1:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),rh(a,b,d,e,c);
case 3:sh(b);d=b.updateQueue;if(null===a||null===d)throw Error(k(282));d=b.pendingProps;e=b.memoizedState;e=null!==e?e.element:null;oe(a,b);Qb(b,d,null,c);d=b.memoizedState.element;if(d===e)Ee(),b=sa(a,b,c);else{if(e=b.stateNode.hydrate)Ka=kb(b.stateNode.containerInfo.firstChild),ra=b,e=Wa=!0;if(e)for(c=Fe(b,null,d,c),b.child=c;c;)c.effectTag=c.effectTag&-3|1024,c=c.sibling;else T(a,b,d,c),Ee();b=b.child}return b;case 5:return bh(b),null===a&&De(b),d=b.type,e=b.pendingProps,f=null!==a?a.memoizedProps:
null,g=e.children,Yd(d,e)?g=null:null!==f&&Yd(d,f)&&(b.effectTag|=16),qh(a,b),b.mode&4&&1!==c&&e.hidden?(b.expirationTime=b.childExpirationTime=1,b=null):(T(a,b,g,c),b=b.child),b;case 6:return null===a&&De(b),null;case 13:return th(a,b,c);case 4:return se(b,b.stateNode.containerInfo),d=b.pendingProps,null===a?b.child=wb(b,null,d,c):T(a,b,d,c),b.child;case 11:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),nh(a,b,d,e,c);case 7:return T(a,b,b.pendingProps,c),b.child;case 8:return T(a,
b,b.pendingProps.children,c),b.child;case 12:return T(a,b,b.pendingProps.children,c),b.child;case 10:a:{d=b.type._context;e=b.pendingProps;g=b.memoizedProps;f=e.value;var h=b.type._context;y(Ic,h._currentValue);h._currentValue=f;if(null!==g)if(h=g.value,f=Qa(h,f)?0:("function"===typeof d._calculateChangedBits?d._calculateChangedBits(h,f):1073741823)|0,0===f){if(g.children===e.children&&!G.current){b=sa(a,b,c);break a}}else for(h=b.child,null!==h&&(h.return=b);null!==h;){var m=h.dependencies;if(null!==
m){g=h.child;for(var l=m.firstContext;null!==l;){if(l.context===d&&0!==(l.observedBits&f)){1===h.tag&&(l=Ea(c,null),l.tag=Jc,Fa(h,l));h.expirationTime<c&&(h.expirationTime=c);l=h.alternate;null!==l&&l.expirationTime<c&&(l.expirationTime=c);Sg(h.return,c);m.expirationTime<c&&(m.expirationTime=c);break}l=l.next}}else g=10===h.tag?h.type===b.type?null:h.child:h.child;if(null!==g)g.return=h;else for(g=h;null!==g;){if(g===b){g=null;break}h=g.sibling;if(null!==h){h.return=g.return;g=h;break}g=g.return}h=
g}T(a,b,e.children,c);b=b.child}return b;case 9:return e=b.type,f=b.pendingProps,d=f.children,rb(b,c),e=W(e,f.unstable_observedBits),d=d(e),b.effectTag|=1,T(a,b,d,c),b.child;case 14:return e=b.type,f=aa(e,b.pendingProps),f=aa(e.type,f),oh(a,b,e,f,d,c);case 15:return ph(a,b,b.type,b.pendingProps,d,c);case 17:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2),b.tag=1,N(d)?(a=!0,Bc(b)):a=!1,rb(b,c),Yg(b,d,e),pe(b,d,e,c),Ie(null,
b,d,!0,a,c);case 19:return vh(a,b,c)}throw Error(k(156,b.tag));};var bf=null,Ne=null,la=function(a,b,c,d){return new Fj(a,b,c,d)};ef.prototype.render=function(a){md(a,this._internalRoot,null,null)};ef.prototype.unmount=function(){var a=this._internalRoot,b=a.containerInfo;md(null,a,null,function(){b[Lb]=null})};var Di=function(a){if(13===a.tag){var b=Fc(ka(),150,100);Ja(a,b);df(a,b)}};var Yf=function(a){13===a.tag&&(Ja(a,3),df(a,3))};var Bi=function(a){if(13===a.tag){var b=ka();b=Va(b,a,null);Ja(a,
b);df(a,b)}};sd=function(a,b,c){switch(b){case "input":Dd(a,c);b=c.name;if("radio"===c.type&&null!=b){for(c=a;c.parentNode;)c=c.parentNode;c=c.querySelectorAll("input[name="+JSON.stringify(""+b)+'][type="radio"]');for(b=0;b<c.length;b++){var d=c[b];if(d!==a&&d.form===a.form){var e=ae(d);if(!e)throw Error(k(90));Gf(d);Dd(d,e)}}}break;case "textarea":Lf(a,c);break;case "select":b=c.value,null!=b&&hb(a,!!c.multiple,b,!1)}};(function(a,b,c,d){ee=a;eg=b;vd=c;vf=d})(Qh,function(a,b,c,d,e){var f=p;p|=4;
try{return Da(98,a.bind(null,b,c,d,e))}finally{p=f,p===H&&ha()}},function(){(p&(1|ca|ma))===H&&(uj(),xb())},function(a,b){var c=p;p|=2;try{return a(b)}finally{p=c,p===H&&ha()}});var mk={Events:[Hb,Pa,ae,pf,qd,lb,function(a){Kd(a,Ki)},sf,tf,sc,pc,xb,{current:!1}]};(function(a){var b=a.findFiberByHostInstance;return Ej(M({},a,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:da.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){a=Sf(a);
return null===a?null:a.stateNode},findFiberByHostInstance:function(a){return b?b(a):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))})({findFiberByHostInstance:Bb,bundleType:0,version:"16.13.1",rendererPackageName:"react-dom"});I.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mk;I.createPortal=Xh;I.findDOMNode=function(a){if(null==a)return null;if(1===a.nodeType)return a;var b=a._reactInternalFiber;if(void 0===
b){if("function"===typeof a.render)throw Error(k(188));throw Error(k(268,Object.keys(a)));}a=Sf(b);a=null===a?null:a.stateNode;return a};I.flushSync=function(a,b){if((p&(ca|ma))!==H)throw Error(k(187));var c=p;p|=1;try{return Da(99,a.bind(null,b))}finally{p=c,ha()}};I.hydrate=function(a,b,c){if(!bc(b))throw Error(k(200));return nd(null,a,b,!0,c)};I.render=function(a,b,c){if(!bc(b))throw Error(k(200));return nd(null,a,b,!1,c)};I.unmountComponentAtNode=function(a){if(!bc(a))throw Error(k(40));return a._reactRootContainer?
(Rh(function(){nd(null,null,a,!1,function(){a._reactRootContainer=null;a[Lb]=null})}),!0):!1};I.unstable_batchedUpdates=Qh;I.unstable_createPortal=function(a,b){return Xh(a,b,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)};I.unstable_renderSubtreeIntoContainer=function(a,b,c,d){if(!bc(c))throw Error(k(200));if(null==a||void 0===a._reactInternalFiber)throw Error(k(38));return nd(a,b,c,!1,d)};I.version="16.13.1"});
</script>
    <script>const e = React.createElement;

function pathToString(path) {
  if (path[0] === '/') {
    return '/' + path.slice(1).join('/');
  } else {
    return path.join('/');
  }
}

function findCommonPath(files) {
  if (!files || !files.length) {
    return [];
  }

  function isPrefix(arr, prefix) {
    if (arr.length < prefix.length) {
      return false;
    }
    for (let i = prefix.length - 1; i >= 0; --i) {
      if (arr[i] !== prefix[i]) {
        return false;
      }
    }
    return true;
  }

  let commonPath = files[0].path.slice(0, -1);
  while (commonPath.length) {
    if (files.every(file => isPrefix(file.path, commonPath))) {
      break;
    }
    commonPath.pop();
  }
  return commonPath;
}

function findFolders(files) {
  if (!files || !files.length) {
    return [];
  }

  let folders = files.filter(file => file.path.length > 1).map(file => file.path[0]);
  folders = [...new Set(folders)]; // unique
  folders.sort();

  folders = folders.map(folder => {
    let filesInFolder = files
      .filter(file => file.path[0] === folder)
      .map(file => ({
        ...file,
        path: file.path.slice(1),
        parent: [...file.parent, file.path[0]],
      }));

    const children = findFolders(filesInFolder); // recursion

    return {
      is_folder: true,
      path: [folder],
      parent: files[0].parent,
      children,
      covered: children.reduce((sum, file) => sum + file.covered, 0),
      coverable: children.reduce((sum, file) => sum + file.coverable, 0),
      prevRun: {
        covered: children.reduce((sum, file) => sum + file.prevRun.covered, 0),
        coverable: children.reduce((sum, file) => sum + file.prevRun.coverable, 0),
      }
    };
  });

  return [
    ...folders,
    ...files.filter(file => file.path.length === 1),
  ];
}

class App extends React.Component {
  constructor(...args) {
    super(...args);

    this.state = {
      current: [],
    };
  }

  componentDidMount() {
    this.updateStateFromLocation();
    window.addEventListener("hashchange", () => this.updateStateFromLocation(), false);
  }

  updateStateFromLocation() {
    if (window.location.hash.length > 1) {
      const current = window.location.hash.substr(1).split('/');
      this.setState({current});
    } else {
      this.setState({current: []});
    }
  }

  getCurrentPath() {
    let file = this.props.root;
    let path = [file];
    for (let p of this.state.current) {
      file = file.children.find(file => file.path[0] === p);
      if (!file) {
        return path;
      }
      path.push(file);
    }
    return path;
  }

  render() {
    const path = this.getCurrentPath();
    const file = path[path.length - 1];

    let w = null;
    if (file.is_folder) {
      w = e(FilesList, {
        folder: file,
        onSelectFile: this.selectFile.bind(this),
        onBack: path.length > 1 ? this.back.bind(this) : null,
      });
    } else {
      w = e(DisplayFile, {
        file,
        onBack: this.back.bind(this),
      });
    }

    return e('div', {className: 'app'}, w);
  }

  selectFile(file) {
    this.setState(({current}) => {
      return {current: [...current, file.path[0]]};
    }, () => this.updateHash());
  }

  back(file) {
    this.setState(({current}) => {
      return {current: current.slice(0, current.length - 1)};
    }, () => this.updateHash());
  }

  updateHash() {
    if (!this.state.current || !this.state.current.length) {
      window.location = '#';
    } else {
      window.location = '#' + this.state.current.join('/');
    }
  }
}

function FilesList({folder, onSelectFile, onBack}) {
  let files = folder.children;
  return e('div', {className: 'display-folder'},
    e(FileHeader, {file: folder, onBack}),
    e('table', {className: 'files-list'},
      e('thead', {className: 'files-list__head'},
        e('tr', null,
          e('th', null, "Path"),
          e('th', null, "Coverage")
        )
      ),
      e('tbody', {className: 'files-list__body'},
        files.map(file => e(File, {file, onClick: onSelectFile}))
      )
    )
  );
}

function File({file, onClick}) {
  const coverage = file.coverable ? file.covered / file.coverable * 100 : -1;
  const coverageDelta = file.prevRun &&
    (file.covered / file.coverable * 100 - file.prevRun.covered / file.prevRun.coverable * 100);

  return e('tr', {
      className: 'files-list__file'
        + (coverage >= 0 && coverage < 50 ? ' files-list__file_low': '')
        + (coverage >= 50 && coverage < 80 ? ' files-list__file_medium': '')
        + (coverage >= 80 ? ' files-list__file_high': '')
        + (file.is_folder ? ' files-list__file_folder': ''),
      onClick: () => onClick(file),
    },
    e('td', null, e('a', null, pathToString(file.path))),
    e('td', null,
      file.covered + ' / ' + file.coverable +
      (coverage >= 0 ? ' (' + coverage.toFixed(2) + '%)' : ''),
      e('span', {title: 'Change from the previous run'},
        (coverageDelta ? ` (${coverageDelta > 0 ? '+' : ''}${coverageDelta.toFixed(2)}%)` : ''))
    )
  );
}

function DisplayFile({file, onBack}) {
  return e('div', {className: 'display-file'},
    e(FileHeader, {file, onBack}),
    e(FileContent, {file})
  );
}

function FileHeader({file, onBack}) {
  const coverage = file.covered / file.coverable * 100;
  const coverageDelta = file.prevRun && (coverage - file.prevRun.covered / file.prevRun.coverable * 100);

  return e('div', {className: 'file-header'},
    onBack ? e('a', {className: 'file-header__back', onClick: onBack}, 'Back') : null,
    e('div', {className: 'file-header__name'}, pathToString([...file.parent, ...file.path])),
    e('div', {className: 'file-header__stat'},
      'Covered: ' + file.covered + ' of ' + file.coverable +
      (file.coverable ? ' (' + coverage.toFixed(2) + '%)' : ''),
      e('span', {title: 'Change from the previous run'},
        (coverageDelta ? ` (${coverageDelta > 0 ? '+' : ''}${coverageDelta.toFixed(2)}%)` : ''))
    )
  );
}

function FileContent({file}) {
  return e('pre', {className: 'file-content'},
    file.content.split(/\r?\n/).map((line, index) => {
      const trace = file.traces.find(trace => trace.line === index + 1);
      const covered = trace && trace.stats.Line;
      const uncovered = trace && !trace.stats.Line;
      return e('code', {
          className: 'code-line'
            + (covered ? ' code-line_covered' : '')
            + (uncovered ? ' code-line_uncovered' : ''),
          title: trace ? JSON.stringify(trace.stats, null, 2) : null,
        }, line);
    })
  );
}

(function(){
  const commonPath = findCommonPath(data.files);
  const prevFilesMap = new Map();

  previousData && previousData.files.forEach((file) => {
    const path = file.path.slice(commonPath.length).join('/');
    prevFilesMap.set(path, file);
  });

  const files = data.files.map((file) => {
    const path = file.path.slice(commonPath.length);
    const { covered = 0, coverable = 0 } = prevFilesMap.get(path.join('/')) || {};
    return {
      ...file,
      path,
      parent: commonPath,
      prevRun: { covered, coverable },
    };
  });

  const children = findFolders(files);

  const root = {
    is_folder: true,
    children,
    path: commonPath,
    parent: [],
    covered: children.reduce((sum, file) => sum + file.covered, 0),
    coverable: children.reduce((sum, file) => sum + file.coverable, 0),
    prevRun: {
      covered: children.reduce((sum, file) => sum + file.prevRun.covered, 0),
      coverable: children.reduce((sum, file) => sum + file.prevRun.coverable, 0),
    }
  };

  ReactDOM.render(e(App, {root, prevFilesMap}), document.getElementById('root'));
}());
</script>
</body>
</html>